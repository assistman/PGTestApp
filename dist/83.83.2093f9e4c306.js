webpackJsonp([83],{1966:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(s=function(t,e,n){var s=i(0),a=i(409),l=i(132),c=i(791),h=i(2020),u=["M",0,0],d=function(){function t(e,i,n){o(this,t),this._parent=i,this._xAxis=e.get(c.options.names.axis.mainX),this._yAxis=e.get(c.options.names.axis.mainY),this._chartDrawing=e.chartDrawing,this._renderer=e.renderer,this._pointer=e.pointer,this._options=s.extend({},l(this.fxclientOptions),n)}return r(t,[{key:"defaults",get:function(){return{}}}],[{key:"EMPTY_PATH",get:function(){return u}}]),r(t,[{key:"_init",value:function(){throw Error("unimplemented abstract method")}},{key:"_update",value:function(t,e){throw Error("unimplemented abstract method")}},{key:"_move",value:function(t,e,i,n){throw Error("unimplemented abstract method")}},{key:"_render",value:function(){throw Error("unimplemented abstract method")}},{key:"_destroy",value:function(){throw Error("unimplemented abstract method")}},{key:"_setColor",value:function(t){throw Error("unimplemented abstract method")}},{key:"redraw",value:function(){this.initialized||this.init(),this.update()}},{key:"init",value:function(t){this._init(),t||this.addEvents(),this.initialized=!0}},{key:"update",value:function(t,e,i){var n=new h(e,i);this._update(t,n),this.updatePoints(t,n),this.render(this.options.keyPoints.length)}},{key:"render",value:function(t){this._render(t)}},{key:"setColor",value:function(t){try{this._setColor(t),this.options.properties.line.lineColor=t,this.save()}catch(t){}}},{key:"getColor",value:function(){return this.options.properties.line.lineColor}},{key:"isFinished",value:function(){return!s.isFunction(this._isFinished)||this._isFinished.apply(this,arguments)}},{key:"finalize",value:function(t){this.chartDrawing.finalizeDrawing(t)}},{key:"save",value:function(){this.chartDrawing.saveDrawing()}},{key:"remove",value:function(){this.chartDrawing.removeActiveDrawing()}},{key:"destroy",value:function(){s.each(this.$points,function(t){return t.destroy()});for(var t in this.mouseHandlers)this.mouseHandlers[t]();this._destroy()}},{key:"createG",value:function(){return this.renderer.g("drawing "+this.options.type.replace(/_/g,"-")).attr({zIndex:7}).add(this.parent)}},{key:"createLine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({"stroke-width":this.options.properties.line.lineWidth,stroke:this.getColor(),"pointer-events":"none"}).add(e)}},{key:"createLineHover",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({class:"hover","stroke-width":1,stroke:"transparent","stroke-linecap":"round"}).add(e)}},{key:"createFilledArea",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container;return this.renderer.path(t).attr({class:"filled",fill:this.getColor(),"fill-opacity":"0.4"}).add(e)}},{key:"createLabel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:null,x:0,y:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=t.text,n=t.x,o=t.y,s=t.shape,r=t.anchorX,a=t.anchorY,l=t.useHTML,c=t.baseline,h=t.className;return this.renderer.label(i,n,o,s,r,a,l,c,h).css({color:"#000000",fontSize:"10px"}).attr({fill:"rgba(255, 255, 255, 0.5)",padding:2,r:3}).add(e)}},{key:"createText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:null,x:0,y:0,fontSize:"11px"},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=t.text,n=t.x,o=t.y,s=t.fontSize;return this.renderer.label(i,n,o).css({color:"#000000",fontSize:s}).attr({stroke:this.getColor(),"stroke-width":1,fill:this.getFillColor(),"fill-opacity":"0.8",padding:7,r:0}).add(e)}},{key:"createPoints",value:function(){return s.map(this.options.keyPoints,this.keyPointToSvgPoint,this)}},{key:"keyPointToSvgPoint",value:function(t,e){return new h(t).initSVG(e,this)}},{key:"updatePoints",value:function(t,e){var i=this;s.isUndefined(t)||s.isUndefined(e)?s.each(this.$points,function(t){return t.updateSVG(!i.editing&&!t.editing)}):(this.$points[t]?(this.$points[t].fromPoint(e),this.$points[t].updateSVG()):this.$points[t]=e.initSVG(t,this),this.options.keyPoints[t]=this.$points[t].convert(!0).getValues())}},{key:"addEvents",value:function(){var t=this;this.mouseHandlers={},this.mouseHandlers.mousedown=a.addEvent(this.$hoverElement.element,"mousedown",function(e){if(e=t.normalize(e),t.chartDrawing.isInsideAxis(e)){e.stopImmediatePropagation(),t.startEditing();var i=!1,n=t.normalize(e);t.mouseHandlers.mousemove=a.addEvent(t.ownerSVG,"mousemove",function(e){e=t.normalize(e),t.chartDrawing.isInsideAxis(e)&&(i=!0,n=t.onMove(!1,e,n))}),t.mouseHandlers.mouseup=a.addEvent(t.ownerSVG,"mouseup",function(e){e=t.normalize(e),t.chartDrawing.isInsideAxis(e)&&(n=t.onMove(!0,e,n),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),t.stopEditing(i))})}}),s.each(this.$points,function(e){return e.addEvents(t)})}},{key:"onMove",value:function(t,e,i){return e=this.normalize(e),this.move(t,e.chartX-i.chartX,e.chartY-i.chartY),e}},{key:"move",value:function(t,e,i,n){var o=this;n?(n.setPixels(n.x+e,n.y+i),this._move(t,e,i,n)):(s.each(this.$points,function(t){return t.setPixels(t.x+e,t.y+i)}),this._move(t,e,i,n)),t&&s.each(this.$points,function(t,e){return o.options.keyPoints[e]=t.convert(!0).getValues()}),this.updatePoints(),this.render(this.options.keyPoints.length)}},{key:"deactivate",value:function(e){t.removeSVGClass(this.$container,"active"),e||this.chartDrawing.setActiveDrawing(null)}},{key:"activate",value:function(e){t.addSVGClass(this.$container,"active"),e||this.chartDrawing.setActiveDrawing(this)}},{key:"startEditing",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this).editing=!0,this.chartDrawing.enableEditing(),t.addSVGClass(this.$container,"in-moving"),this.activate()}},{key:"stopEditing",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;i.editing=!1,(i===this?i.notSaved:i.drawing.notSaved)||this.chartDrawing.disableEditing(),t.removeSVGClass(this.$container,"in-moving"),e&&this.chartDrawing.saveDrawing(!0)}},{key:"normalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;return t.chartX&&t.chartY?t:this.pointer.normalize(t)}},{key:"parent",get:function(){return this._parent}},{key:"options",get:function(){return this._options}},{key:"xAxis",get:function(){return this._xAxis}},{key:"yAxis",get:function(){return this._yAxis}},{key:"pointer",get:function(){return this._pointer}},{key:"renderer",get:function(){return this._renderer}},{key:"chartDrawing",get:function(){return this._chartDrawing}},{key:"ownerSVG",get:function(){return this.$container.element.ownerSVGElement}},{key:"fxclientOptions",get:function(){throw Error("unimplemented abstract method")}},{key:"initialized",get:function(){return this._initialized},set:function(t){this._initialized=t}}],[{key:"addSVGClass",value:function(t,e){var i=t.element.getAttribute("class").split(" ");i.indexOf(e)<=-1&&i.push(e),t.element.setAttribute("class",i.join(" "))}},{key:"removeSVGClass",value:function(t,e){var i=t.element.getAttribute("class").split(" "),n=i.indexOf(e);n>-1&&i.splice(n,1),t.element.setAttribute("class",i.join(" "))}},{key:"lightenDarkenColor",value:function(t,e){var i=!1;"#"===t[0]&&(t=t.slice(1),i=!0);var n=parseInt(t,16),o=(n>>16)+e;o>255?o=255:o<0&&(o=0);var s=(n>>8&255)+e;s>255?s=255:s<0&&(s=0);var r=(255&n)+e;return r>255?r=255:r<0&&(r=0),(i?"#":"")+("000000"+(r|s<<8|o<<16).toString(16)).slice(-6)}}]),t}();n.exports=d}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0))},1969:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(s=function(t,e,n){var s=i(0),a=i(6),l=i(279),c=i(22),h=i(7),u=i(806),d=i(807),p=function(){function t(){o(this,t)}return r(t,null,[{key:"initEditing",value:function(e,i,n,o){var s=o.onChangeProfitForTakeProfit,r=o.onChangeLossForStopLoss,a=o.onChangeRate,l=o.onChangeConversionRate;l&&e.listenTo(i,"change:conversionRate",l),a&&e.listenTo(i,"change:rate",a),s&&e.listenTo(i,"change:profitForTakeProfit",s),r&&e.listenTo(i,"change:lossForStopLoss",r),n&&t.sendSubscribeToConversion(i.getInstrument().getCurrency(),h.getUserCurrency())}},{key:"createEditPositionModel",value:function(t,e){var i=t.get("quantity")<0?"Sell":"Buy";return new u({instrumentModel:e,type:i,direction:i,position:t})}},{key:"stopEditing",value:function(e,i,n){e.stopListening(i),n&&t.sendUnsubscribeFromConversion(i.getInstrument().getCurrency(),h.getUserCurrency())}},{key:"sendSubscribeToConversion",value:function(e,i){return l.add(e,i).then(t.requestConversionSubscriptionSuccess).catch(t.requestConversionSubscriptionError)}},{key:"sendUnsubscribeFromConversion",value:function(e,i){return l.remove(e,i).then(t.requestConversionUnsubscriptionSuccess).catch(t.requestConversionUnsubscriptionError)}},{key:"requestConversionSubscriptionSuccess",value:function(t){return Promise.resolve(t)}},{key:"requestConversionSubscriptionError",value:function(t){return Promise.reject(t)}},{key:"requestConversionUnsubscriptionSuccess",value:function(t){return Promise.resolve(t)}},{key:"requestConversionUnsubscriptionError",value:function(t){return Promise.reject(t)}},{key:"removePositionStopLoss",value:function(e){return t.requestEditPosition(e,["takeProfit"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}},{key:"removePositionTakeProfit",value:function(e){return t.requestEditPosition(e,["stopLoss"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}},{key:"removeOrderStopLoss",value:function(e){return t.requestPlaceOrder(e,["takeProfit"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}},{key:"removeOrderTakeProfit",value:function(e){return t.requestPlaceOrder(e,["stopLoss"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}},{key:"requestEditPosition",value:function(t,e){var i=[];if(e.indexOf("takeProfit")>=0&&t.getPositionModel().get("takeProfit")){var n={fixedOffset:t.minOrderDistance(),fixedPrice:t.getTakeProfit(),isPriceFixed:!0,orderType:"LIMIT",requestId:null};i.push(n)}if(e.indexOf("stopLoss")>=0&&t.getPositionModel().get("stopLoss")){var o={fixedOffset:t.minOrderDistance(),fixedPrice:t.getStopLoss(),isPriceFixed:!0,orderType:"STOP",requestId:null};i.push(o)}return a.editPosition(c.getAtmosphereId(),i,t.getPositionCode())}},{key:"onSubmitSuccess",value:function(){return Promise.resolve()}},{key:"onSubmitError",value:function(){return Promise.reject(res)}},{key:"getOrderAttributes",value:function(t,e){var i=t.get("quantity"),n=i>0?"buy":"sell",o=t.get("type"),s=null,r=null,a=t.get("takeProfit"),l=t.get("stopLoss");switch(o){case"STOP":o="Entry Stop",r="buy"===n?"above":"below",s=t.get("stopPrice");break;case"LIMIT":o="Entry Limit",r="buy"===n?"below":"above",s=t.get("limitPrice")}return{instrument:e,order:t,action:n,quantity:Math.abs(i),type:o,orderPosition:r,price:s,takeProfit:a&&a.fixedPrice,stopLoss:l&&l.fixedPrice}}},{key:"createEditOrderModel",value:function(e,i){var n=t.getOrderAttributes(e,i);return new d({instrumentModel:n.instrument,type:n.action,direction:n.action.toUpperCase(),order:n.order,takeProfit:n.takeProfit,stopLoss:n.stopLoss})}},{key:"requestPlaceOrder",value:function(t,e){var i={effect:"OPENING",instrumentId:t.getInstrumentModel().getId(),orderSide:t.getDirection(),orderType:t.order.getType(),quantity:t.getAmount(),refOrderChainId:t.order.getOrderChainId(),requestId:s.uniqueId("gwt-uid-"),timeInForce:"GTC"};return t.order.isLimitPrice()?(i.limitPrice=t.getCurrentPrice(),i.stopPrice=null):(i.limitPrice=null,i.stopPrice=t.getCurrentPrice()),e.indexOf("stopLoss")>=0&&t.order.get("stopLoss")&&(i.stopLoss={fixedOffset:t.minOrderDistance(!1),fixedPrice:t.getStopLoss(),isPriceFixed:!0,orderType:"STOP"}),e.indexOf("takeProfit")>=0&&t.order.get("takeProfit")&&(i.takeProfit={fixedOffset:t.minOrderDistance(!1),fixedPrice:t.getTakeProfit(),isPriceFixed:!0,orderType:"LIMIT"}),t.order.unset("modifiedTime",{silent:!0}),a.placeOrder(c.getAtmosphereId(),i)}},{key:"updatePositionTakeProfit",value:function(e){return t.updatePosition(e)}},{key:"updatePositionStopLoss",value:function(e){return t.updatePosition(e)}},{key:"updatePosition",value:function(e){return t.requestEditPosition(e,["takeProfit","stopLoss"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}},{key:"updateOrderTakeProfit",value:function(e){return t.updateOrder(e)}},{key:"updateOrderStopLoss",value:function(e){return t.updateOrder(e)}},{key:"updateOrder",value:function(e){return t.requestPlaceOrder(e,["takeProfit","stopLoss"]).then(t.onSubmitSuccess).catch(t.onSubmitError)}}]),t}();n.exports=p}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0))},1970:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(s=function(t,e,n){var s=i(17),a=s.Events,l=i(38),c=i(0),h=i(409),u=i(7),d=i(791),p=i(2078),f=i(2079),g=i(2080),v=i(2081),y=["M",0,0],m=["$rateLine","$hoverElement","$rateLabel","$infoLabel","$plLabel","$editButton","$closeButton","$tpslButton","$container"],b=i(2022),w={RATE_LABEL:{attr:{"stroke-width":0,padding:d.options.chart.label.padding,r:d.options.chart.label.radius},css:{color:"#FFFFFF",fontSize:"11px",fontWeight:"500",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},INFO_LABEL:{attr:{fill:"#FFFFFF","stroke-width":1,paddingLeft:3,padding:3,r:2},css:{fontSize:"11px",fontWeight:"bold",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},PL_LABEL:{attr:{fill:"#FFFFFF","stroke-width":1,padding:3,r:2},css:{color:"#FFFFFF",fontSize:"11px",fontWeight:"bold",fontFamily:'Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;'}},BUTTON:{NORMAL_STATE:{style:{color:"#1960d7"},paddingLeft:1,padding:3,r:2,"stroke-width":1,stroke:"#7c7c7c",fill:"#ffffff"},HOVER_STATE:{fill:"#f0f1f2"}},CLOSE_BUTTON:{},TPSL_BUTTON:{}},x=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this._chart=e,this._options=c.extend({},this.defaults,i),this.options.handleEvents&&c.extend(this,a),this.$container=this.createContainer(),this.options.draggable&&this.makeDraggable(),this.$rateLine=this.createRateLine(),this.options.showRateLabel&&(this.$rateLabel=this.createLabel(null,c.extend({},w.RATE_LABEL.attr,{fill:this.options.color}),w.RATE_LABEL.css)),this.elementsRow=[],this.options.showInfoLabel&&(this.options.infoLabelValue||this.options.infoLabelKey||this.options.infoLabelShowRate)&&(this.$infoLabel=this.createLabel(this.formatInfo(),c.extend({},w.INFO_LABEL.attr,{fill:this.chart.options.chart.backgroundColor,stroke:this.options.color}),c.extend({},w.INFO_LABEL.css,{color:this.options.color})),"right"===this.options.infoLabelAlign?this.$infoLabel.attr({align:this.options.infoLabelAlign}):this.elementsRow.push({offsetX:14,element:this.$infoLabel})),this.options.showProfitLossLabel&&(this.$plLabel=this.createLabel(null,c.extend({},w.PL_LABEL.attr,{stroke:this.options.color,fill:this.options.color}),c.extend({},w.PL_LABEL.css)),this.elementsRow.push({offsetX:"right"===this.options.infoLabelAlign?14:-2,element:this.$plLabel}),this.$plLabel.hide()),this.options.showEditButton&&this.onEditButtonCLick&&(this.$editButton=this.createButton(p,this.onEditButtonCLick.bind(this),c.extend({},w.BUTTON.NORMAL_STATE,{title:__("actions.edit"),fill:this.chart.options.chart.backgroundColor}),w.BUTTON.HOVER_STATE,{fill:this.options.color}),this.elementsRow.push({offsetX:10,element:this.$editButton})),this.options.showCloseButton&&this.onCloseButtonClick&&(this.$closeButton=this.createButton(f,this.onCloseButtonClick.bind(this),c.extend({},w.BUTTON.NORMAL_STATE,{title:__("actions.cancel"),fill:this.chart.options.chart.backgroundColor}),w.BUTTON.HOVER_STATE,{fill:this.options.color}),this.elementsRow.push({offsetX:4,element:this.$closeButton})),this.options.showTpslButton&&this.onTpslButtonClick&&(this.$tpslButton=this.createButton(g,this.onTpslButtonClick.bind(this),c.extend({},w.BUTTON.NORMAL_STATE,{fill:this.chart.options.chart.backgroundColor}),w.BUTTON.HOVER_STATE,{fill:this.options.color,icon:v}),this.elementsRow.push({offsetX:4,element:this.$tpslButton})),this.chartRedrawEventHandler=h.addEvent(e,"redraw",this.onChartRedraw.bind(this)),this.chartDestroyEventHandler=h.addEvent(e,"destroy",this.onChartDestroy.bind(this))}return r(t,[{key:"defaults",get:function(){throw Error(this.constructor.name+" : unimplemented abstract method")}},{key:"chart",get:function(){return this._chart}},{key:"options",get:function(){return this._options}}],[{key:"DASH_STYLES",get:function(){return b}}]),r(t,[{key:"formatInfo",value:function(){var t="";return this.options.infoLabelValue?t=this.options.infoLabelValue:this.options.infoLabelKey&&(t=__(this.options.infoLabelKey)),this.options.infoLabelShowRate&&this.rate&&(t.length>0&&(t+=" : "),t+=this.formatRate()),t}},{key:"formatRate",value:function(){return this.rate.toFixed(this.options.precision||this.options.instrument&&this.options.instrument.getPrecision()||5)}},{key:"formatPL",value:function(t){return l(t).formatForeignCurrency(u.getUserCurrencySymbol(),"$0.00")}},{key:"updateRate",value:function(t){if(t!==this.rate){var e=t-this.rate;this.rate=t,this.onRateUpdated(e)}}},{key:"onRateUpdated",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart;return this.onChartRedraw(e),t}},{key:"onChartRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart,this.chart.get(d.options.names.axis.mainY).getExtremes());if(this.rate<=t.max&&this.rate>=t.min){this.$container.show();var e=this.$rateLine.updateValue(this.rate);this.$hoverElement&&this.$hoverElement.update(this.$rateLine.d),this.$rateLabel&&(this.$rateLabel.attr({text:this.formatRate()}),this.$rateLabel.attr({y:e.y-this.$rateLabel.height/2,x:e.x+e.width})),this.$infoLabel&&(this.$infoLabel.attr({text:this.formatInfo()}),"right"===this.options.infoLabelAlign&&this.$infoLabel.attr({x:e.width-(10+d.options.chart.label.offsetX),y:e.y-this.$infoLabel.height/2}));var i=0;c.each(this.elementsRow,function(t){t.element.attr({x:i+t.offsetX,y:e.y-t.element.height/2}),i+=t.element.width+t.offsetX}),this.updateDragAndDropRange()}else this.$container.hide()}},{key:"toPixels",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart).get(d.options.names.axis.mainY).toPixels(parseFloat(t))}},{key:"toValue",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart).get(d.options.names.axis.mainY).toValue(t)}},{key:"getPlotLinePath",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart).get(d.options.names.axis.mainY).getPlotLinePath(t,1)}},{key:"updatePl",value:function(t){if(this.$plLabel){t||(t=0);var e=this.formatPL(t);this.pl!==e&&(this.$plLabel.attr({text:e}),this.pl||this.$plLabel.attr({visibility:"inherit"}),this.pl=e,this.onChartRedraw())}}},{key:"applySettings",value:function(t){this.$infoLabel&&this.$infoLabel.attr({fill:t.colors.common.background}),this.$editButton&&this.$editButton.updateNormalState({fill:t.colors.common.background}),this.$closeButton&&this.$closeButton.updateNormalState({fill:t.colors.common.background}),this.$tpslButton&&this.$tpslButton.updateNormalState({fill:t.colors.common.background})}},{key:"createContainer",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.renderer).g("rate-line "+(this.options.className||"")).attr({zIndex:7}).add()}},{key:"createRateLine",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$container,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chart,n=e.renderer.path(y).attr({"stroke-width":1,stroke:this.options.color,dashstyle:this.options.dashstyle,"pointer-events":"none"}).add(e);return n.updateY=function(e){return n.attr({d:["M",0,e,"L",i.plotLeft+i.plotWidth+(t.options.showRateLabel?d.options.chart.label.offsetX:0),e]})},n.updateValue=function(e){var o=t.getPlotLinePath(e,i);return o?(t.options.showRateLabel&&(o[4]+=d.options.chart.label.offsetX),n.attr({d:o}),{x:o[1],y:o[2],width:o[4]-o[1],height:o[5]-o[2]}):null},n}},{key:"createLabel",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.$container;return n.renderer.label(t,-1e3,-1e3,null,null,null,!1,!1).attr(e).css(i).add(n)}},{key:"createButton",value:function(t,e,i,n,o,s){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.$container;return r.renderer.buttonIcon(null,-1e3,-1e3,t,15,15,e,i,n,o,s).add(r)}},{key:"destroy",value:function(t){var e=this;this.destroyed||(c.each(m,function(t){e[t]&&(e[t].destroy(),e[t]=null)}),this.elementsRow=null,this.chartRedrawEventHandler(),t||this.chartDestroyEventHandler(),this.chartRedrawEventHandler=this.chartDestroyEventHandler=null,this.stopListening&&this.stopListening(),this.destroyed=!0)}},{key:"makeDraggable",value:function(){var t=this;this.$hoverElement=this.createLineHover(),this.mouseHandlers={},this.mouseHandlers.mousedown=h.addEvent(this.$hoverElement.element,"mousedown",function(e){if(t._beforeDragRate=t.rate,e=t.normalize(e),t.yAxis=t.chart.get(d.options.names.axis.mainY),t.isInsideAxis(e)){e.stopImmediatePropagation(),t.startEditing();var i=!1,n=t.normalize(e);t.mouseHandlers.mousemove=h.addEvent(t.$container.element.ownerSVGElement,"mousemove",function(e){e=t.normalize(e),t.isInsideAxis(e)&&(i=!0,n=t.onMove(!1,e,n))}),t.mouseHandlers.mouseup=h.addEvent(t.$container.element.ownerSVGElement,"mouseup",function(e){e=t.normalize(e),t.isInsideAxis(e)&&(i&&(n=t.onMove(!0,e,n)),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),t.stopEditing(i),t.yAxis=null)})}})}},{key:"normalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;return t.chartX&&t.chartY?t:this.chart.pointer.normalize(t)}},{key:"createLineHover",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$container,i=e.renderer.path(t).attr({class:"hover","stroke-width":1,stroke:"transparent","stroke-linecap":"butt"}).add(e);return i.update=function(t){return i.attr({d:t})},i}},{key:"isInsideAxis",value:function(t){return t.chartX>=this.yAxis.left&&t.chartY>=this.yAxis.top&&t.chartX<=this.yAxis.left+this.yAxis.width&&t.chartY<=this.yAxis.top+this.yAxis.height}},{key:"startEditing",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this).editing=!0,this.initDragAndDropRange()}},{key:"stopEditing",value:function(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this).editing=!1,this.removeDragAndDropRange()}},{key:"enableDragging",value:function(){this.$hoverElement&&this.$hoverElement.show()}},{key:"disableDragging",value:function(){this.$hoverElement&&this.$hoverElement.hide()}},{key:"initDragAndDropRange",value:function(){this.dragAndDropRange=t.calcDragAndDropRangeCoords(this.getDragAndDropRange(),this.yAxis),this.$dragAndDropRangeRect=this.chart.renderer.rect(this.dragAndDropRange.x,this.dragAndDropRange.y,this.dragAndDropRange.width,this.dragAndDropRange.height).attr({fill:this.options.color,"fill-opacity":.1}).add()}},{key:"updateDragAndDropRange",value:function(){this.$dragAndDropRangeRect&&(this.dragAndDropRange=t.calcDragAndDropRangeCoords(this.getDragAndDropRange(),this.yAxis),this.$dragAndDropRangeRect.attr({x:this.dragAndDropRange.x,y:this.dragAndDropRange.y,width:this.dragAndDropRange.width,height:this.dragAndDropRange.height}))}},{key:"removeDragAndDropRange",value:function(){this.dragAndDropRange=null,this.$dragAndDropRangeRect&&(this.$dragAndDropRangeRect.destroy(),this.$dragAndDropRangeRect=null)}},{key:"onMove",value:function(t,e,i){return e=this.normalize(e),this.move(t,e.chartX-i.chartX,e.chartY-i.chartY)?e:i}},{key:"move",value:function(t,e,i){var n=this;if(t)return this.onDrop(this.rate-this._beforeDragRate).catch(function(){n.updateRate(n._beforeDragRate)}),!0;var o=!0,s=this.toValue(this.toPixels(this.rate)+i);return this.dragAndDropRange.min&&s<this.dragAndDropRange.min?(s=this.dragAndDropRange.min,o=!1):this.dragAndDropRange.max&&s>this.dragAndDropRange.max&&(s=this.dragAndDropRange.max,o=!1),this.updateRate(s),o}},{key:"exportTo",value:function(t){var e=this,i={};i.$container=this.createContainer(t.renderer),i.$rateLine=this.createRateLine(i.$container,t);var n=[];this.$rateLabel&&(i.$rateLabel=this.createLabel(this.$rateLabel.text.textStr,c.extend({},w.RATE_LABEL.attr,{fill:this.options.color}),w.RATE_LABEL.css,i.$container)),this.$infoLabel&&(i.$infoLabel=this.createLabel(this.$infoLabel.text.textStr,c.extend({},w.INFO_LABEL.attr,{fill:this.chart.options.chart.backgroundColor,stroke:this.options.color}),c.extend({},w.INFO_LABEL.css,{color:this.options.color}),i.$container),"right"===this.options.infoLabelAlign?i.$infoLabel.attr({align:this.options.infoLabelAlign}):n.push({offsetX:14,element:i.$infoLabel})),this.$plLabel&&(i.$plLabel=this.createLabel(this.$plLabel.text.textStr,c.extend({},w.PL_LABEL.attr,{stroke:this.options.color,fill:this.options.color}),c.extend({},w.PL_LABEL.css),i.$container),n.push({offsetX:-2,element:i.$plLabel})),this.$tpslButton&&2===this.$tpslButton.state&&(i.$tpslButton=this.createButton(g,null,c.extend({},w.BUTTON.NORMAL_STATE),w.BUTTON.HOVER_STATE,{fill:this.options.color,icon:v},null,i.$container),i.$tpslButton.press(),n.push({offsetX:10,element:i.$tpslButton}));var o=h.addEvent(t,"redraw",function(){var t=i.$rateLine.updateValue(e.rate);if(!t)return void i.$container.hide();i.$container.show(),i.$rateLabel&&i.$rateLabel.attr({y:t.y-i.$rateLabel.height/2,x:t.x+t.width}),i.$infoLabel&&"right"===e.options.infoLabelAlign&&i.$infoLabel.attr({x:t.width-(10+d.options.chart.label.offsetX),y:t.y-i.$infoLabel.height/2});var o=0;c.each(n,function(e){e.element.attr({x:o+e.offsetX,y:t.y-e.element.height/2}),o+=e.element.width+e.offsetX})});h.addEvent(t,"destroy",function(){c.each(m,function(t){i[t]&&(i[t].destroy(),i[t]=null)}),o()})}},{key:"onChartDestroy",value:function(){this.destroy(!0)}}],[{key:"calcDragAndDropRangeCoords",value:function(t,e){return t.x=e.left,t.width=e.width,t.y=e.top+(t.max?Math.max(e.toPixels(t.max,!0),0):0),t.height=e.top-t.y+(t.min?Math.min(e.toPixels(t.min,!0),e.height):e.height),t}}]),t}();n.exports=x}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0))},2020:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(s=function(t,e,s){var a=i(409),l=function(){function t(){switch(o(this,t),arguments.length){case 1:this.fromKeyPoint(arguments[0]);break;case 2:this.setPixels(arguments[0],arguments[1])}}return r(t,null,[{key:"defaults",get:function(){return{pointSize:8,pointType:"rect",draggable:!0}}}]),r(t,[{key:"fromKeyPoint",value:function(t){this.setValues(t.timestamp,t.value)}},{key:"fromPoint",value:function(t){this.setPixels(t.x,t.y)}},{key:"setValues",value:function(t,e){this.timestamp=t,this.value=e}},{key:"setPixels",value:function(t,e){this.x=t,this.y=e}},{key:"getValues",value:function(){return{timestamp:this._timestamp,value:this._value}}},{key:"getPixels",value:function(){return{x:this.x,y:this.y}}},{key:"convert",value:function(t){return t?(this.timestamp=this.drawing.xAxis.toValue(this.x),this.value=this.drawing.yAxis.toValue(this.y)):(this.x=this.drawing.xAxis.toPixels(this.timestamp),this.y=this.drawing.yAxis.toPixels(this.value)),this}},{key:"initSVG",value:function(e,i){var o=n.extend({},t.defaults,i.options);return this.index=e,this.drawing=i,this.type=o.pointType,this.size=o.pointSize,this.draggable=o.draggable,void 0!==this.x&&void 0!==this.y||this.convert(),this.$svg="circle"===this.pointType?t.createPointCircle(this.x,this.y,i.$container,i.renderer,o):t.createPointRect(this.x,this.y,i.$container,i.renderer,o),this}},{key:"addEvents",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.drawing;this.$svg&&this.draggable&&(this.mouseHandlers={},this.mouseHandlers.mousedown=a.addEvent(this.$svg.element,"mousedown",function(i){if(i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)){i.stopImmediatePropagation(),e.startEditing(t);var n=!1,o=e.normalize(i);t.mouseHandlers.mousemove=a.addEvent(e.ownerSVG,"mousemove",function(i){i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)&&(n=!0,o=t.onMove(!1,e,i,o))}),t.mouseHandlers.mouseup=a.addEvent(e.ownerSVG,"mouseup",function(i){i=t.drawing.normalize(i),t.drawing.chartDrawing.isInsideAxis(i)&&(t.onMove(!0,e,i,o),t.mouseHandlers.mousemove(),t.mouseHandlers.mouseup(),e.stopEditing(n,t))})}}))}},{key:"updateSVG",value:function(t){t&&this.convert(),this.$svg.attr("circle"===this.type?{cx:this.x,cy:this.y}:{x:this.x-this.size/2,y:this.y-this.size/2})}},{key:"onMove",value:function(t,e,i,n){return i=e.normalize(i),e.move(t,i.chartX-n.chartX,i.chartY-n.chartY,this),i}},{key:"destroy",value:function(){for(var t in this.mouseHandlers)this.mouseHandlers[t]()}},{key:"setColor",value:function(t){this.drawing.options.properties.defaultKeyPoint.lineColor=t,this.drawing.options.properties.defaultKeyPoint.fillStyle=t,this.$svg.attr({stroke:t,fill:t})}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"timestamp",get:function(){return this._timestamp},set:function(t){this._timestamp=t}},{key:"value",get:function(){return this._value},set:function(t){this._value=t}},{key:"index",get:function(){return this._index},set:function(t){this._index=t}}],[{key:"createPointCircle",value:function(t,e,i,n,o){return n.circle(t,e,o.pointSize/2).attr({class:"point","stroke-width":o.properties.defaultKeyPoint.lineWidth,stroke:o.properties.defaultKeyPoint.lineColor,fill:o.properties.defaultKeyPoint.fillStyle}).css({}).add(i)}},{key:"createPointRect",value:function(t,e,i,n,o){return n.rect(t-o.pointSize/2,e-o.pointSize/2,o.pointSize,o.pointSize).attr({class:"point","stroke-width":o.properties.defaultKeyPoint.lineWidth,stroke:o.properties.defaultKeyPoint.lineColor,fill:o.properties.defaultKeyPoint.fillStyle}).css({}).add(i)}}]),t}();s.exports=l}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0))},2021:function(t,e,i){(function(n,o){var s;void 0!==(s=function(t,e,n){var o=i(0),s=i(5),r=i(24),a=i(79),l=o.template(i(2073)),c=i(70);n.exports=r.extend({initialize:function(t){this.drawing=t,r.prototype.initialize.apply(this,arguments),this.render()},events:function(){return o.extend({},o.result(r.prototype,"events"),{"click .fn-save":"onSave","click .fn-cancel":"onCancel"})},getOptions:function(t){return o.extend({},o.result(r.prototype,"getOptions"),{parent:document.body,isHeaderShowed:!0,caption:__("chart_drawings.settings.popup.header"),headerStyle:"wizard"},t)},render:function(){var t=this;return r.prototype.render.call(this),this.$el.addClass("drawing-settings-popup"),this.setContent(l()),this.$form=this.$el.find(".drawing-settings-form"),o.each(this.drawing.configurableOptions,function(e){var i=null;switch(e.type){case"select":i=a.selectBox(o.extend(e,{translationPrefix:"",disable:!1}));break;case"textarea":i=a.textArea(o.extend(e,{disable:!1,settings:{rows:10,cols:20}}))}i&&(s(i).addClass("field"),t.$form.append(i))}),this.$settingsFrom=new c({el:this.$form}),o.each(this.drawing.configurableOptions,function(e){t.$settingsFrom.getField(e.name).value(e.value),"textarea"===e.type&&t.$settingsFrom.getField(e.name).setRules({max_length:[100,__("chart_drawings.settings.text_note.error",100)]})}),this},onSave:function(){this.$settingsFrom.validate()||(this.drawing.save(this.$settingsFrom.getData()),this.close())},onCancel:function(t){this.close()}})}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0),i(5))},2022:function(t,e){t.exports={DASH:"Dash",DASH_DOT:"DashDot",DOT:"Dot",LONG_DASH:"LongDash",LONG_DASH_DOT:"LongDashDot",LONG_DASH_DOT_DOT:"LongDashDotDot",SHORT_DASH:"ShortDash",SHORT_DASH_DOT:"ShortDashDot",SHORT_DASH_DOT_DOT:"ShortDashDotDot",SHORT_DOT:"ShortDot",SOLID:"Solid"}},2023:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var l=i(1970),c={color:"#47a546",dashstyle:l.DASH_STYLES.SHORT_DASH,draggable:!0,handleEvents:!0,infoLabelKey:"chart.line.profit",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0},h=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.onInstrumentStatusChange(),s.listenTo(s.options.instrument,"change:closable change:editable",s.onInstrumentStatusChange.bind(s)),s}return s(e,t),a(e,[{key:"defaults",get:function(){return c}}]),a(e,[{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isEditable()?this.$closeButton.enable():this.$closeButton.disable()}}]),e}(l);r.exports=h}.call(e,i,e,t))&&(t.exports=r)},2024:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var l=i(1970),c={color:"#ff433d",dashstyle:l.DASH_STYLES.SHORT_DASH,draggable:!0,handleEvents:!0,infoLabelKey:"chart.line.loss",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0},h=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.onInstrumentStatusChange(),s.listenTo(s.options.instrument,"change:closable change:editable",s.onInstrumentStatusChange.bind(s)),s}return s(e,t),a(e,[{key:"defaults",get:function(){return c}}]),a(e,[{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isEditable()?this.$closeButton.enable():this.$closeButton.disable()}}]),e}(l);r.exports=h}.call(e,i,e,t))&&(t.exports=r)},2045:function(t,e,i){(function(n){var o;void 0!==(o=function(t,e,n){function o(t,e,i){t.addEventListener(e,i,!0)}function s(t,e,i){t.removeEventListener(e,i,!0)}var r=i(12),a=(i(0),i(5)),l=(i(2),"rtl"===a("html").attr("dir"));n.exports=r.extend({isHidden:!0,initialize:function(t){r.prototype.initialize.apply(this,arguments),this.options=t,this.render(),this.addDragEvents()},render:function(){this.$el.html(this.template(this.options))},toggle:function(t){this.isHidden!==t&&(this.isHidden=t,this.$el.css("display",t?"none":"block"),this.resetPosition())},resetPosition:function(){this.$el.css({top:"",bottom:"",left:"",right:""})},closePopup:function(){this.toggle(!0)},isDragReady:!1,dragoffset:{x:0,y:0},onMouseDown:function(t){this.isDragReady=!0,this.dragoffset.x=t.pageX-this.el.offsetLeft,this.dragoffset.y=t.pageY-this.el.offsetTop},onMouseUp:function(t){this.isDragReady=!1},onMouseMove:function(t){if(this.isDragReady)if(this.el.offsetHeight+Math.abs(t.pageY-this.dragoffset.y)<screen.height&&(this.el.style.top=t.pageY-this.dragoffset.y+"px"),l){var e=screen.width-t.pageX-this.dragoffset.x;if(e+this.el.offsetWidth>screen.width)return;this.el.style.right=e+"px"}else{var i=t.pageX-this.dragoffset.x;if(i+this.el.offsetWidth>screen.width)return;this.el.style.left=i+"px"}},addDragEvents:function(){o(this.el,"mousedown",this.onMouseDown.bind(this)),o(document,"mouseup",this.onMouseUp.bind(this)),o(document,"mousemove",this.onMouseMove.bind(this))},removeDragEvents:function(){s(this.el,"mousedown",this.onMouseDown.bind(this)),s(document,"mouseup",this.onMouseUp.bind(this)),s(document,"mousemove",this.onMouseMove.bind(this))},destroy:function(){this.removeDragEvents(),r.prototype.destroy.call(this)}})}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(5))},2046:function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),s=i.n(o),r=i(2),a=i.n(r),l=i(11),c=i.n(l),h=i(52),u=i.n(h),d=i(10),p=i(0),f=i.n(p),g=function(t){return a.a.trigger("ui:new-position",{direction:d.BUY,symbolOrId:t})},v=function(t){var e=!f.a.isNaN(parseInt(t.ask)),i=c()(n({"price-button":!0,"price-button_labeled":!0,"price-button_ani":!0},t.className,!0)),o=c()({"price-button__wrapper":!0,btn:!0,disabled:!t.buyTradable,bar_loading:!e});return e&&(t.ask=u.a.divideValueByPipSize(t.ask,t.pipsPrecision)),s.a.createElement("div",{className:i},s.a.createElement("buttton",{disabled:!t.buyTradable,className:o,onClick:function(){return t.buyTradable&&g(t.symbol)},"aria-label":t.notTradableMessage},s.a.createElement("div",{className:"price-button__subtitle"},__("actions.buy")),s.a.createElement("div",{className:"price-button__title"},!0===t.ask?t.ask:u.a.formatValueToStringOrComponent(t.ask,!1))))};e.default=v},2047:function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),s=i.n(o),r=i(11),a=i.n(r),l=i(2),c=i.n(l),h=i(52),u=i.n(h),d=i(10),p=i(0),f=i.n(p),g=function(t){return c.a.trigger("ui:new-position",{direction:d.SELL,symbolOrId:t})},v=function(t){var e=!f.a.isNaN(parseInt(t.bid)),i=a()(n({"price-button":!0,"price-button_labeled":!0,"price-button_ani":!0},t.className,!0)),o=a()({"price-button__wrapper":!0,btn:!0,disabled:!t.sellTradable,bar_loading:!e});return e&&(t.bid=u.a.divideValueByPipSize(t.bid,t.pipsPrecision)),s.a.createElement("div",{className:i},s.a.createElement("buttton",{disabled:!t.sellTradable,className:o,onClick:function(){return t.sellTradable&&g(t.symbol)},"aria-label":t.notTradableMessage},s.a.createElement("div",{className:"price-button__subtitle"},__("actions.sell")),s.a.createElement("div",{className:"price-button__title"},!0===t.bid?t.bid:u.a.formatValueToStringOrComponent(t.bid,!1))))};e.default=v},2052:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(o=function(t,e,o){var r=(i(0),i(2067)),a=i(2068),l=i(2069),c=i(2070),h=i(2071),u=i(2072),d=i(2074),p={vertical_line:{class:l,label:"chart_drawings.vertical"},horizontal_line:{class:a,label:"chart_drawings.horizontal"},line:{class:r,label:"chart_drawings.trending"},trend_channel:{class:c,label:"chart_drawings.channel"},fibonacci_retracements:{class:h,label:"chart_drawings.fibonacci_retracement"},text:{class:u,label:"chart_drawings.text"},measurer:{class:d,label:"chart_drawings.measurer"}},f=function(){function t(e,i){n(this,t),this._parent=i,this._chart=e}return s(t,[{key:"createDrawing",value:function(e){var i=t.types[e.type];if(i)return new i.class(this.chart,this.parent,e)}},{key:"parent",get:function(){return this._parent}},{key:"chart",get:function(){return this._chart}}],[{key:"types",get:function(){return p}},{key:"defaultType",get:function(){return"line"}}]),t}();o.exports=f}.call(e,i,e,t))&&(t.exports=o)},2064:function(t,e,i){(function(n,o){var s,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};void 0!==(s=function(t,e,n){var o=i(12),s=(i(3),i(5)),a=i(0),l=i(15),c=i(2),h=i(7),u=i(2065),d=i(30),p=i(108),f=i(9),g=i(14),v=i(791),y=i(2093),m=i(2094),b=i(2095),w=i(207),x=i(2046).default,_=i(2047).default,k=i(1),S=i(16),L=i(120),P=void 0,C={buy:"ask",middle:null,sell:"bid",none:"bid"};n.exports=o.extend({className:"chart-panel",size:{},settings:{},instrument:null,chart:null,parent:null,model:null,period:null,periodRanges:null,enableTrading:!l.mobile(),escapeKeyboardListener:null,events:function(){return a.extend({},a.result(o.prototype,"events"),{"click .fn-show-search":"showSearch","click .fn-hide-search":"hideSearch","wheel .chart-container":"onMouseWheel"})},chartNoDataTemplate:a.template(i(2096)),initialize:function(){P=i(413),o.prototype.initialize.apply(this,arguments),this.type=this.options.type||v.defaultType,this.period=this.options.period||v.defaultPeriod,this.range=this.options.range||v.defaultRange,this.cursor=this.options.cursor||v.defaultCursor,this.rateLine=this.options.rateLine||v.defaultRateLine,this.type===v.comparisonType&&(f.isChartInstrumentsComparisonEnabled()?this.comparisonMode=!0:(this.type=v.defaultType,this.saveType(this.type))),this.listenTo(c,"ui:aside-box-opened",this.handleReflow),this.listenTo(c,"ui:chart:reflow",this.handleReflow),this.listenTo(c,"ui:chart:resubscribe",this.resubscribeChart),this.listenTo(c,"ui:chart:drawing-stop",this.stopDrawing),this.listenTo(c,"ui:change-theme",this.changeTheme)},changeTheme:function(t){this.chart.changeTheme(P.getChartSettings(this.getMultiChartIndex()),t)},onMouseWheel:function(t){t.deltaY<0?this.zoomIn():this.zoomOut(),t.preventDefault()},zoomIn:function(){this.chart.zoomIn()},zoomOut:function(){this.chart.zoomOut()},showLoading:function(){this.$el.addClass("chart-loading"),this.loadingView&&this.loadingView.destroy(),this.loadingView=new d({parent:this.getLoadingContainer(),position:"absolute",translucent:"2"})},hideLoading:function(t){this.chart.reflow(),this.$el.removeClass("chart-loading"),this.loadingView&&this.loadingView.destroy(),t||(this.chart.destroy(),this.$chartContainer.html(this.chartNoDataTemplate()))},onDataLoad:function(t,e){var i=this;this.hideLoading(!0),this.comparisonMode&&(this.comparisonInstrument=new y({symbol:this.instrument.getSymbol(),name:this.instrument.getDisplayName()}),this.$chartInstrumentsComparisonPanel.setMainInstrument(this.comparisonInstrument)),this.chart.handleHistoricalData(t,this.comparisonMode?this.comparisonInstrument:void 0),this.chart.onDataLoad(),this.comparisonMode?this.comparisonInstruments&&!this.comparisonInstruments.isEmpty()&&a.each(this.comparisonInstruments.models,function(t){e?t.getSubscription().changeRangeStart(i.chartSubscription.getRangeStart()):(t.getSubscription().stop(),setTimeout(function(){P.updateSubscription(t.getSubscription(),i.range),t.getSubscription().start()},0))}):this.tradingCentral&&this.tradingCentral.subscribe({instrument:this.instrument,period:this.period})},setInstrument:function(t){var e=this;return t===this.instrument?(setTimeout(function(){return e.handleReflow()},0),!1):(this.instrument&&this.instrument.off("change:precision"),this.instrument=t,this.instrument&&this.instrument.on("change:precision",this.precisionUpdated,this),!0)},render:function(){var t=this;this.parent&&s(this.parent).append(this.el),this.$el.html(this.template()),this.$chartSplitterBox=s(".chart-splitter-box"),this.$title=this.$el.find(".chart-title"),v.defaultRateLines.indexOf(this.rateLine)<0&&(this.rateLine=v.defaultRateLines[0]),this.$subtitle=this.$el.find(".chart-subtitle"),this.$chartBox=this.$el.parent(),this.$chartContainer=this.$el.find(".chart-container"),this.$fullscreenNotification=this.$el.find(".chart-fullscreen-notification"),this._fontSize=parseFloat(this.$el.find(".chart-basket").css("font-size")),this.chart=new u({el:this.$chartContainer}),this.listenTo(this.chart,"cursor:unselect",function(){return t.chartToolbar&&t.chartToolbar.setActiveCursor()}),this.listenTo(this.chart,"chart:drawings-save",this.saveDrawings)},onInstrumentSelected:function(t,e,i){if(a.isUndefined(e)&&!(e=g.getInstrumentBySymbol(t)))return!1;var n=null!==this.instrument;return this.setInstrument(e)?(this.setTradesVisibility(i),this.resubscribeChart(n),!0):(this.setTradesVisibility(i,!0),!1)},setTradesVisibility:function(t,e){this.tradesVisibility=t,e&&this.chart.updateTradesVisibility(t)},showChartSettings:function(){P.showChartSettings(this.getMultiChartIndex())},showIndicatorsSettings:function(){P.showIndicatorsSettings(this.getMultiChartIndex())},saveDrawings:function(t){P.saveDrawings(this.instrument.getSymbol(),t,this.getMultiChartIndex())},onOrdersUpdate:function(){if(this.instrument){var t=p.getOrderById(this.instrument.get("orderChainId"));t&&t.hasChanged()&&this.instrument.set(a.pick(t.changedAttributes(),"stopLoss","takeProfit","stopLimitPrice"))}},handleReflow:function(t){this.chart.reflow()},makeScreenshot:function(){this.chart.makeScreenshot()},toggleFullscreen:function(){var t=this;this.size.minimized&&this.toggleMinimize(),this.size.fullscreen?(this.$el.removeClass("fullscreened"),this.$el.appendTo(this.size.parent),this.size.escapeKeyboardListener&&this.size.escapeKeyboardListener.remove(),c.trigger("ui:chart:fullscreen-out")):(this.$el.addClass("fullscreened"),this.size.parent=this.$el.parent(),this.$el.appendTo(s("body")),l.desktop()&&(this.$fullscreenNotification.css("display","block"),this.$fullscreenNotification.fadeOut({duration:2e3,complete:function(){return t.$fullscreenNotification.css("display","none")},step:function(e){return t.$fullscreenNotification.css("opacity",.6*e)}}),this.size.escapeKeyboardListener=this.addKeyboardListener(27,this.toggleFullscreen.bind(this))),c.trigger("ui:chart:fullscreen-in")),this.chart.reflow(),this.size.fullscreen=!this.size.fullscreen,this.chartToolbar&&this.chartToolbar.setActiveSize(this.size.fullscreen)},addKeyboardListener:function(t,e,i){var n=function(i){i=i||window.event,i.keyCode===t&&e()};return document.addEventListener("keydown",n,i||!1),{remove:function(){document.removeEventListener("keydown",n)}}},restoreSize:function(){this.size.fullscreen&&this.toggleFullscreen(),this.size.minimized&&this.toggleMinimize()},toggleMinimize:function(){this.size.fullscreen&&this.toggleFullscreen(),this.size.minimized?(this.$chartBox.removeClass("minimized"),this.$chartSplitterBox.css("display","block"),c.trigger("ui:chart:minimize-out")):(this.$chartSplitterBox.css("display","none"),this.$chartBox.addClass("minimized"),c.trigger("ui:chart:minimize-in")),this.chart.reflow(),this.size.minimized=!this.size.minimized},initBaskets:function(){var t=this.instrument.getBasket();if(t){for(var e=__("baskets.consists",t.instrumentSymbol),i=0,n=t.instruments.length;i<n;i++)e+=" "+t.instruments[i].instrumentWeight+"% "+t.instruments[i].displayName,e+=i<n-1?", ":".";this.$el.find(".chart-basket-title").html(__("baskets.title")+":"),this.$el.find(".chart-basket-info").html(e),this._fitChartBasketHeight()}else this.$el.find(".chart-basket-title").html(""),this.$el.find(".chart-basket-info").html("")},initHeader:function(){this.$title.html(this.instrument.getDisplayName()),this.$subtitle.html(this.instrument.getDescription())},stopTradingCentral:function(){this.tradingCentral&&this.tradingCentral.unsubscribe()},onDataUpdate:function(t,e){return this.chart.handleStreamData(t,e)},getMultiChartIndex:function(){return this.options.multiChartIndex},resubscribeChart:function(t){var e=this;this.instrument&&this.chart&&(this.showLoading(),this.stopTradingCentral(),this.stopDrawing(),this.initHeader(),this.initBaskets(),this.initBuySellButtons(),this.chartSubscription&&this.chartSubscription.stop(),this.chartSubscription=P.createSubscription(r({chartId:this.options.chartId,symbol:this.instrument.getSymbol()},this.comparisonMode?{range:this.range}:{period:this.period},{price:C[this.rateLine],indicators:this.comparisonMode?null:P.getActiveIndicators(this.getMultiChartIndex())})),this.chart.resubscribe({instrument:this.instrument,chartSubscription:this.chartSubscription,type:this.type,period:this.period,rateLine:this.rateLine,cursor:this.cursor,enableTrading:this.enableTrading,tradesVisibility:this.tradesVisibility,comparisonMode:!!this.comparisonMode,settings:P.getChartSettings(this.getMultiChartIndex()),indicators:this.comparisonMode?[]:P.getActiveIndicators(this.getMultiChartIndex()),drawings:l.desktop()?P.getDrawings(this.instrument.getSymbol(),this.getMultiChartIndex()):{}}),this.chartSubscription.on({start:function(){return e.showLoading()},timeout:function(){return e.hideLoading(!1)},load:function(i){return e.onDataLoad(i,t)},update:function(t){return e.onDataUpdate(t,e.chartSubscription.getFirstCandle())}}),this.chartSubscription.start())},getInstrumentSymbol:function(){return this.instrument&&this.instrument.getSymbol()},subscribe:function(t,e){this.onInstrumentSelected(t,void 0,e),this.hideSearch()},_fitChartBasketHeight:function(){var t=parseFloat(this.$el.find(".chart-basket").css("height"));if(t>parseFloat(this.$el.find(".chart-info").css("height"))&&this._fontSize>9)return this.$el.find(".chart-basket-title").html(""),this._fontSize--,this.$el.find(".chart-basket").css("font-size",this._fontSize+"px"),void this._fitChartBasketHeight();t>40&&this.$el.find(".chart-basket").css("display","none")},precisionUpdated:function(t,e){this.chart&&this.chart.updatePrecision(e)},destroyBuySellButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$buyButton,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$sellButton;S.unmountComponentAtNode(e),S.unmountComponentAtNode(t)},initBuySellButtons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$buyButton,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$sellButton;if(t&&e)if(this.destroyBuySellButtons(t,e),h.getUserCommonData().isAdvancedTradingView()){if(!f.isNewInstrumentDetailsBehaviourEnabled()||l.mobile()){var i=this.instrument.getSymbol();S.render(k.createElement(w.Bid,{symbol:i,render:_}),e),S.render(k.createElement(w.Ask,{symbol:i,render:x}),t)}}else S.render(k.createElement(L,{type:"Sell",column:{name:"Sell",key:"bid",direction:"bidDirection"},model:this.instrument,display:"block",isSelected:!0}),e),S.render(k.createElement(L,{type:"Buy",column:{name:"Buy",key:"ask",direction:"askDirection"},model:this.instrument,display:"block",isSelected:!1}),t)},startDrawing:function(t){this.drawingType=a.isString(t)?t:this.getTarget(t).dataset.type,this.chart.startDrawing(this.drawingType)},stopDrawing:function(){this.chart.stopDrawing()},clearDrawings:function(){this.stopDrawing(),this.chart.clearDrawings()},getTarget:function(t){return t.currentTarget},onChangePeriod:function(t){this.period=t,this.resubscribeChart()},onChangeRange:function(t){this.range=t,this.period=P.getPeriodByRange(t),this.resubscribeChart()},onChangeType:function(t){this.type=t,this.chart.changeType(t)},onZoomIn:function(){this.chart.zoomIn()},onZoomOut:function(){this.chart.zoomOut()},onShowChartSettings:function(){P.showChartSettings(this.getMultiChartIndex(),this.chart.applySettings.bind(this.chart))},onShowIndicatorsSettings:function(){P.showIndicatorsSettings(this.getMultiChartIndex(),this.resubscribeChart.bind(this))},onChangeCursor:function(t){this.chart.changeCursor(t)},onChangeRateLine:function(t){this.rateLine=t,this.resubscribeChart()},onSearchResultClick:function(t){c.trigger("ui:instrument",t,!0)},showSearch:function(t){this.chartSearchView||(this.chartSearchView=new b({el:this.$el.find(".chart-search-block-wrapper"),onRowClick:this.onSearchResultClick.bind(this)})),this.chartSearchView.show(a.isBoolean(t)&&t)},hideSearch:function(){this.chartSearchView&&this.chartSearchView.hide()},initComparisonInstruments:function(){var t=this.instrument;this.comparisonInstruments||(this.comparisonInstruments=new m,this.listenTo(this.comparisonInstruments,"full",this.updateComparisonSearch)),this.comparisonInstrument=new y({symbol:t&&t.getSymbol(),name:t&&t.getDisplayName()}),this.$chartInstrumentsComparisonPanel=S.render(k.createElement(i(2097),{mainInstrument:this.comparisonInstrument,comparisonInstruments:this.comparisonInstruments}),this.$el.find(".chart-instruments-comparison-panel")[0])},enableComparisonMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.range;this.comparisonMode=!0,this.type=v.comparisonType,this.range=t,this.period=P.getPeriodByRange(this.range),this.initComparisonInstruments(),this.resubscribeChart()},disableComparisonMode:function(t,e){this.comparisonMode=!1,this.type=t,this.period=e,S.unmountComponentAtNode(this.$el.find(".chart-instruments-comparison-panel")[0]),this.resubscribeChart(),this.chart.changeCursor()},addComparisonInstrument:function(t){var e=this,i=g.getInstrumentBySymbol(t);if(!this.comparisonInstruments.contains(t)&&i){var n=new y({symbol:i.getSymbol(),name:i.getDisplayName()});n.setSubscription(P.createSubscription({chartId:this.options.chartId,symbol:t,range:this.range,price:C[this.rateLine]})),this.comparisonInstruments.add(n),this.chart.addComparisonInstrument(n,this.comparisonInstruments.length),n.on("remove",function(){e.removeComparisonInstrument(n.getSymbol())}),n.getSubscription().start(this.chartSubscription.getRangeStart())}},removeComparisonInstrument:function(t){},updateComparisonSearch:function(t){this.initToolbar(),this.chartToolbar.updateComparisonSearch(t)},destroy:function(){this.chartSubscription&&this.chartSubscription.stop(),this.destroyBuySellButtons(),o.prototype.destroy.call(this)}})}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0),i(5))},2065:function(t,e,i){(function(n,o){function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r;void 0!==(r=function(t,e,n){var r=i(0),a=i(15),l=i(3),c=i(12),h=i(281),u=i(2066),d=i(791),p=i(808),f=i(2077),g=i(2082),v=i(2083),y=i(2086),m=/(M\s*\S*\s*\S*\s*L\s*)(\S*)(\s*\S*\s*)/,b=void 0,w=function(t,e,i,n,o,s){var r=this,a=this.chart.get(d.options.names.series.main).xData;void 0!==e&&(arguments[1]=Math.min(e,a[Math.max(0,a.length-d.options.general.candles.overscroll.offset)])),s&&s.DOMEvent&&"mouseup"===s.DOMEvent.type&&setTimeout(function(){var t=r.chart.get(d.options.names.axis.mainX);r.chart.navigator.render(t.min,t.max)},0),t.apply(this,Array.prototype.slice.call(arguments,1))},x=function(t,e,i){t.call(this,e,i),b.each(this.chart.series,function(t){t.chart[t.sharedClipKey]&&t.chart[t.sharedClipKey].attr(i||t.chart.clipBox)})},_=function(t,e,i){if(t.call(this,e,i),b.defined(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var n=this.crossLabel;if(n)if(e||this.isXAxis||i.series.yAxis.options.id===this.options.id||this.crossLabel.hide(),this.isXAxis){if(d.options.chart.label.offsetY){for(var o=this.cross.d.split(" "),s=0,r=-1,a=5,l=o.length;a<l;)o[a]>s&&(s=o[a],r=a),a+=6;if(r>=0){var c=+o[r]+d.options.chart.label.offsetY;o[r]=c,o=o.join(" "),this.cross.attr({d:o}),n.attr({y:c})}}}else if(d.options.chart.label.offsetX){var h=this.cross.d.match(m),u=+h[2]+d.options.chart.label.offsetX;this.cross.attr({d:""+h[1]+u+h[3]}),n.attr({x:u})}}},k=function(t){t.Axis.prototype.protoEvents&&t.Axis.prototype.protoEvents.afterDrawCrosshair&&t.each(t.Axis.prototype.protoEvents.afterDrawCrosshair,function(t,e){t.order=e}),t.addEvent(t.Axis,"afterDrawCrosshair",function(e){if(t.defined(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var i=this.chart,n=this.horiz,o=this.opposite,s=this.options.crosshair.label,r=n?"center":o?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",a=this.crossLabel;a||(a=this.crossLabel=i.renderer.label(null,null,null,s.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:s.align||r,padding:t.pick(s.padding,8),r:t.pick(s.borderRadius,3),zIndex:8}).add(),a.attr({fill:s.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:s.borderColor||"","stroke-width":s.borderWidth||0}).css(t.extend({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},s.style)))}},{order:-1})},S=new Promise(function(t){t()}).then(i.bind(null,409));S.then(function(t){b=t,b.forEachPolyfill=function(t,e){for(var i=0,n=this.length;i<n;){if(!1===t.call(e,this[i],i,this))return i;i++}},k(b),b.wrap(b.Axis.prototype,"setExtremes",w),b.wrap(b.Axis.prototype,"drawCrosshair",_),b.wrap(b.Pointer.prototype,"scaleGroups",x),i(813)(b),i(814)(b),i(2089)(b),i(2090)(b),i(2091)(b),i(2092)(b)}),n.exports=c.extend({chart:null,plotLines:null,comparisonMode:!1,_initOverscroll:function(){var t=1e3*h[this.period].seconds,e=this.chartSubscription.getLastCandle();this.overscrollData=r.map(r.range(d.options.general.candles.overscroll.total),function(i){return[e.timestamp+(i+1)*t,e.close]}),this.chart.addSeries({type:"line",color:"transparent",shadow:!1,animation:!1,data:this.overscrollData,showInNavigator:!0,tooltip:{enabled:!1,pointFormatter:function(){return null}}})},onDataLoad:function(){var t=this;this.comparisonMode?(this.plotLines&&this.plotLines.currentRate&&(this.plotLines.currentRate.destroy(),delete this.plotLines.currentRate),this._destroyTradingPlotLines()):(a.desktop()&&(this.chartDrawings=new u({chart:this.chart,options:this.drawings,start:this.chartSubscription.getFirstCandle().timestamp,onSave:function(e){return t.trigger("chart:drawings-save",e)},forExport:!1}),this.chartDrawings.externalHandlers.push(b.addEvent(this.chartDrawings,"enableEditing",this.enableDrawingsEditing.bind(this))),this.chartDrawings.externalHandlers.push(b.addEvent(this.chartDrawings,"disableEditing",this.disableDrawingsEditing.bind(this))),delete this.drawings),this._initCurrentRatePlotLine(),this._initTradingPlotLines(),this._initOverscroll(),this._initExtremes()),this._redrawChart()},bindEvents:function(t,e){var i=function(i){var n=t.searchPoint(i,!0);n&&e.setChange(n.y)};if(b.hasTouch){var n=b.addEvent(this.chart.container,"touchmove",i),o=b.addEvent(this.chart.container,"touchstart",i);return function(){n(),o()}}var s=b.addEvent(this.chart.container,"mousemove",i);return function(){s()}},handleHistoricalData:function(t,e){if(this.comparisonMode){var i=this._getMainSeries();if(i){i.setData(p.extendPoints(this.convertCandles(t),this.chartSubscription),!1);var n=this.bindEvents(i,e);e.on("remove",function(){n()}),e.setColor(i.color),this.changeCursor("comparison_crosshair")}}else this._setHistoricalData(t)},_updateCurrentRateLine:function(){"none"===this.rateLine||this.comparisonMode||this.plotLines&&this.plotLines.currentRate&&this.plotLines.currentRate.updateRate(this.chartSubscription.getLastCandle().close)},handleStreamData:function(t,e){this._updateHistoricalData(t,e),this._updateCurrentRateLine(),this._redrawChart()},changeType:function(t){this._changeType(t)},changeCursor:function(t){this._changeCursor(t)},changeTheme:function(t,e){this.applySettings(t)},applySettings:function(t){this.isExists()&&(this._applyChartSettings(t),this._redrawChart())},reflow:function(){this.isExists()&&this.chart.reflow()},makeScreenshot:function(){this._exportChart()},destroy:function(){this.stopListening(),this.chartDrawings&&this.chartDrawings.destroy(),this.chart&&this.chart.destroy&&(this.chart.destroy(),this.chart=null)},zoomIn:function(){this._zoom(.8)},zoomOut:function(){this._zoom(1.25)},isExists:function(){return r.isObject(this.chart)},isOpenPositionsVisible:function(){return this.tradesVisibility.showTrades&&this.tradesVisibility.showAllOpenPositions},isOrdersVisible:function(){return this.tradesVisibility.showTrades&&this.tradesVisibility.showAllOrders},_initCurrentRatePlotLine:function(){this.plotLines?(this.plotLines.currentRate&&this.plotLines.currentRate.destroy(),delete this.plotLines.currentRate):this.plotLines={},"none"!==this.rateLine&&(this.plotLines.currentRate=new g(this.chart,{showInfoLabel:!0,infoLabelKey:"chart.line."+this.rateLine,instrument:this.instrument}),this._updateCurrentRateLine())},updateTradesVisibilityForType:function(t,e,i,n,o,a){var l=this;this.plotLines[e]||(this.plotLines[e]=[]);var c=this.plotLines[e],h=r.pluck(n.models,"cid"),u=r.map(c,function(e){return e.options[t].cid}),d=o?h:r.intersection(h,a),p=r.difference(d,u),f=r.difference(u,d);if(f.length)for(var g=0,v=c.length;g<v;)f.indexOf(c[g].options[t].cid)>=0?(c[g].destroy(),c.splice(g,1),v--):g++;r.each(p,function(e){var o;c.push(new i(l.chart,(o={},s(o,t,n.get(e)),s(o,"instrument",l.instrument),o)))})},updateTradesVisibility:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tradesVisibility;this.enableTrading&&this.plotLines&&t.showTrades&&(this.updateTradesVisibilityForType("order","orders",y,this.instrument.getOrders(),t.showAllOrders,t.visibleTradesIds),this.updateTradesVisibilityForType("position","positions",v,this.instrument.getPositions(),t.showAllOpenPositions,t.visibleTradesIds)),this.tradesVisibility=t},updateTradingCentral:function(t){var e=this;if(this.isExists()){this.tcExremes={min:.9999*t.support3,max:1.0001*t.resistance3};var i=0;this.plotLines||(this.plotLines={}),this.plotLines.tc||(this.plotLines.tc={}),r.each(d.tradingCentralSettings,function(n,o){t[o]?(e.plotLines.tc[o]&&!e.plotLines.tc[o].destroyed||(e.plotLines.tc[o]=new f(e.chart,{className:"tc-"+o,color:t.lines[i++/3>>0].colors[0],showInfoLabel:!0,infoLabelAlign:n.align,infoLabelValue:n.text,precision:e.instrument.getPrecision()})),e.plotLines.tc[o].updateRate(t[o])):i++}),t.pivot===t.resistance1?(this.plotLines.tc.resistance1.destroy(),delete this.plotLines.tc.resistance1):t.pivot===t.support1&&(this.plotLines.tc.support1.destroy(),delete this.plotLines.tc.support1),this._updateValueExtremes(),this._redrawChart()}},updatePrecision:function(t){var e=this;S.then(function(){e.chart.update({tooltip:{valueDecimals:t}})})},startDrawing:function(t){this.isExists()&&this.chartDrawings&&(this.chartDrawings.startDrawing(t),o(this.chart.container).addClass("drawing-started"))},stopDrawing:function(){this.isExists()&&this.chartDrawings&&(this.chartDrawings.stopDrawing(),this.chartDrawings.setActiveDrawing(),o(this.chart.container).removeClass("drawing-started"))},clearDrawings:function(){this.isExists()&&this.chartDrawings&&(this.chartDrawings.clearDrawings(),o(this.chart.container).removeClass("drawing-started"))},_exportChart:function(){var t=this;this.isExists()&&this.chart.exportChartLocal({filename:this.instrument.getDisplayName()+"_"+l().format("YYYYMMDDHHmmss"),type:/Edge\/|Trident\/|MSIE /.test(window.navigator.userAgent)?"image/svg+xml":"image/png"},this.configurator.createExportingConfig({onLoad:function(e){if(t.chartDrawings){new u({chart:e,options:t.chartDrawings.options,forExport:!0})}t.configurator.addChartInfoExporting(e),t.plotLines&&(t.plotLines.currentRate&&t.plotLines.currentRate.exportTo(e),r.each(t.plotLines.positions,function(t){return t.exportTo(e)}),r.each(t.plotLines.orders,function(t){return t.exportTo(e)}),r.each(t.plotLines.tc,function(t){return t.exportTo(e)}))},onRedraw:function(e){t._redrawHandler(e)}}))},resubscribe:function(t){var e=this,i=t.instrument,n=t.period,o=t.type,s=t.rateLine,r=t.indicators,a=t.settings,l=t.drawings,c=t.tradesVisibility,h=t.enableTrading,u=t.cursor,p=t.comparisonMode,f=t.chartSubscription;S.then(function(){e.destroy(),e.instrument=i,e.tradesVisibility=c,e.drawings=l,e.period=n,e.rateLine=s,e.comparisonMode=p,e.enableTrading=h,e.chartSubscription=f,e.extremes=null,e.tcExremes=null,e.chartDrawings&&(e.chartDrawings.destroy(),e.chartDrawings=void 0),e._destroyTradingPlotLines(),u=e.configurator?e.configurator.previousCursor:u,e.configurator=new d({instrumentInfo:e.instrument,type:o,settings:a,indicators:r,comparisonMode:p,onSetExtremes:e._setExtremesHandler.bind(e),onRedraw:e._redrawHandler.bind(e)}),e.chart=new b.StockChart(e.el,e.configurator.createHighchartsConfig()),e._detectIndicatorsSeries(),e._changeCursor(u),e.colors={"#42aa2d":!0,"#de67a7":!0,"#dd7130":!0,"#7a43b0":!0}})},_redrawHandler:function(t){},_setExtremesHandler:function(t){this.extremes=r.pick(t,"min","max"),this._updateValueExtremes()},_initExtremes:function(){var t=this.getTimestamps(),e=d.options.general.candles,i=e.visible;if(1===t.length||i>=t.length)this._getMainXAxis().setExtremes(r.first(t),r.last(t),!1,null);else{var n=t[t.length-(e.overscroll.total-e.overscroll.visible)-i],o=t[t.length-(e.overscroll.total-e.overscroll.visible)-1];this._getMainXAxis().setExtremes(n,o,!1,null)}},_getMainSeries:function(){return this.chart.get(d.options.names.series.main)},_getVolumeSeries:function(){return this.chart.get(d.options.names.series.volume)},_getMainXAxis:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart;return t?t.get(d.options.names.axis.mainX):null},_getMainYAxis:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart;return t?t.get(d.options.names.axis.mainY):null},convertCandles:function(t){var e=this.configurator.getTypeConverter(),i=void 0,n=r.first(t);return r.map(t,function(t){if(!t.expansion)return i=e(t,i,n)})},_changeType:function(t){if(this.configurator.type!==t&&this.isExists()){var e=this._getMainSeries();e&&(e.remove(!1),this.configurator.type=t,this.chart.addSeries(this.configurator.createMainSeriesConfig(this.convertCandles(this.chartSubscription.getCandles())),!1),this._redrawChart())}},_setHistoricalData:function(t){var e=this,i=this._getMainSeries();if(i){var n=[],o=[],s=this.configurator.getTypeConverter(),a=void 0,l=r.first(t),c=[];r.each(t,function(t){t.studyValues&&r.each(t.studyValues.values,function(i,o){"NaN"!==i&&(n[o]=n[o]||[],n[o].push(e._toIndicatorPoint(t.timestamp,i)))}),t.expansion||(o.push(e._toIndicatorPoint(t.timestamp,t.volume)),a=s(t,a,l),c.push(a))}),i.setData(c,!1),this.configurator.hasVolume&&this._getVolumeSeries().setData(o,!1),r.each(this.inicatorsSeries,function(t,e){return t.setData(n[e],!1)})}},_updateHistoricalData:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getMainSeries(),o=this.configurator.getTypeConverter();n&&r.each(t,function(t){t.studyValues&&r.each(t.studyValues.values,function(e,n){"NaN"!==e&&i.addOrUpdatePoint(i.inicatorsSeries[n],i._toIndicatorPoint(t.timestamp,e))}),t.expansion||(i.configurator.hasVolume&&i.addOrUpdatePoint(i._getVolumeSeries(),i._toIndicatorPoint(t.timestamp,t.volume)),i.addOrUpdatePoint(n,o(t,i._getLastPoint(),e)))})},_toIndicatorPoint:function(t,e){return[t,e]},addOrUpdatePoint:function(t,e){return t.xData[t.xData.length-1]<e[0]?(this._addPoint(t,e),{added:!0}):{added:!1,updatedIndex:this._updatePoint(t,e)}},_addPoint:function(t,e){t.addPoint(e,!1,!this.comparisonMode,!1)},_updatePoint:function(t,e){var i=t.xData.indexOf(e[0]),n=r.findWhere(t.points,{index:i});return n&&n.x===e[0]?n.update(e,!1,!1):(t.removePoint(i,!1,!1),t.addPoint(e,!1,!1,!1)),i},_getLastPoint:function(){var t=this._getMainSeries().yData;return t=t[t.length-2],r.isArray(t)?[0,t[0],t[1],t[2],t[3]]:[0,0,0,0,t]},_updateValueExtremes:function(){if(this.tcExremes){var t=this._getMainYAxis().getExtremes();this._getMainYAxis().setExtremes(Math.min(t.dataMin,this.tcExremes.min),Math.max(t.dataMax,this.tcExremes.max),!1)}},_redrawChart:function(){this.chart.redraw()},getTimestamps:function(){return r.union(r.pluck(this.chartSubscription.getCandles(),"timestamp"),r.pluck(this.overscrollData,"0"))},_zoom:function(t){if(this.isExists()&&(r.isUndefined(this.chartDrawings)||!this.chartDrawings.isDrawingEditingEnabled())&&!this.comparisonMode){var e=this.getTimestamps();this.extremes||(this.extremes=r.pick(this._getMainXAxis().getExtremes(),"min","max"));var i=Math.max(this.extremes.min,r.first(e)),n=Math.min(this.extremes.max,r.last(e));i=r.sortedIndex(e,i),n=r.sortedIndex(e,n);var o=(n-i)*t,s=(n+i)/2;i=Math.max(Math.round(s-o/2),0),n=Math.min(Math.round(s+o/2),e.length-1),e[i]&&e[n]&&this._getMainXAxis().setExtremes(e[i],e[n])}},_initTradingPlotLines:function(){var t=this;this._destroyTradingPlotLines(),this.enableTrading&&(this.listenTo(this.instrument.getPositions(),"add",function(e){t.isOpenPositionsVisible()&&t.plotLines.positions.push(new v(t.chart,{position:e,instrument:t.instrument}))}),this.listenTo(this.instrument.getOrders(),"add",function(e){t.isOrdersVisible()&&t.plotLines.orders.push(new y(t.chart,{order:e,instrument:t.instrument}))}),this.plotLines.positions=[],this.plotLines.orders=[],this.updateTradesVisibility())},_destroyTradingPlotLines:function(){this.plotLines&&(this.plotLines.positions&&(r.each(this.plotLines.positions,function(t){return t.destroy()}),delete this.plotLines.positions),this.plotLines.orders&&(r.each(this.plotLines.orders,function(t){return t.destroy()}),delete this.plotLines.orders))},_applyChartSettings:function(t){var e=t.switchers.showVolume!==this.configurator.settings.switchers.showVolume,i=t.switchers.showTrades!==this.configurator.settings.switchers.showTrades;this.configurator.settings=t;var n=this.configurator.createHighchartsConfig();this._updateChart(this.chart,n),this._updateAxes(this.chart.xAxis),this._updateAxes(this.chart.yAxis),this._updateNavigator(this.chart.navigator,n),this._updateMainSeries(this._getMainSeries(),n),this._updateVolumeSeries(e,n),i?(this.tradesVisibility.showTrades=t.switchers.showTrades,this.tradesVisibility.showTrades?this._initTradingPlotLines():this._destroyTradingPlotLines()):this._updatePlotLines(t),this._updateChartDrawings(t)},_updateChart:function(t,e){t.update({chart:e.chart},!1)},_updateAxes:function(t){var e=this;r.each(t,function(t){(void 0===t.options.id||t.options.id.indexOf("navigator")<0)&&t.update(e.configurator.getAxisSettings(t.isXAxis,t.options.id===d.options.names.axis.volume),!1)})},_updateNavigator:function(t,e){t.update(e.navigator,!1)},_updateMainSeries:function(t,e){t.update(e.plotOptions[this.configurator.type],!1)},_updatePlotLines:function(t){this.plotLines&&(this.plotLines.currentRate&&this.plotLines.currentRate.applySettings(t),r.each(this.plotLines.positions,function(e){return e.applySettings(t)}),r.each(this.plotLines.orders,function(e){return e.applySettings(t)}),r.each(this.plotLines.tc,function(e){return e.applySettings(t)}))},_updateChartDrawings:function(t){this.chartDrawings&&this.chartDrawings.applySettings(t)},_updateVolumeSeries:function(t,e){var i=this;t&&(this.configurator.hasVolume?(this.chart.addAxis(r.last(e.yAxis),!1,!1),this.chart.addSeries(r.last(e.series),!1).setData(r.map(this.historicalData,function(t){return i._toIndicatorPoint(t.timestamp,t.volume)},!1))):(this.chart.get(d.options.names.series.volume).remove(!1),this.chart.get(d.options.names.axis.volume).remove(!1))),this.configurator.hasVolume&&this.chart.get(d.options.names.series.volume).update(e.plotOptions.column,!1)},_detectIndicatorsSeries:function(){this.inicatorsSeries=r.filter(this.chart.series,function(t){return t.options.id!==this.main&&t.options.id!==this.volume&&t.options.id!==this.navigator},d.options.names.series)},_changeCursor:function(t){if(a.desktop()||"comparison_crosshair"===t){var e=this._getMainXAxis(),i=this._getMainYAxis();if(e&&i&&(!t||t!==this.configurator.currentCursor)){t=t||this.configurator.previousCursor||d.options.general.cursor,this._setCursorTypeClassName(this.$el,t);var n=this.configurator.createCursorConfig(t,this.period);e.update(n.xAxis,!1),r.each(this.chart.yAxis,function(t){t.options.id!==d.options.names.axis.navigatorY&&t.options.id!==d.options.names.axis.volume&&t.update(n.yAxis,!1)}),"drawing"===t||"comparison_crosshair"===t?this.trigger("cursor:unselect"):this.configurator.previousCursor=t,this.configurator.currentCursor=t,n.tooltip.enabled?this.configurator.enableTooltip():(this.configurator.disableTooltip(),this.chart.tooltip.hide(0)),this.chart.pointer.followTouchMove=!!n.tooltip.followTouchMove,this.chart.update({tooltip:n.tooltip},!1),this._redrawChart()}}},enableDrawingsEditing:function(){this.changeCursor("drawing")},disableDrawingsEditing:function(){this.changeCursor()},_setCursorTypeClassName:function(t,e){r.each(r.filter(t[0].classList,function(t){return 0===t.indexOf("cursor-")}),function(e){t.removeClass(e)}),t.addClass("cursor-"+e)},initialize:function(){c.prototype.initialize.apply(this,arguments)},addComparisonInstrument:function(t,e){function i(){l(),a=null,this.colors[s]=!0}var n=this,o=t.getSubscription(),s=void 0,a=void 0,l=void 0;for(var c in this.colors)if(this.colors[c]){s=c,this.colors[c]=!1;break}o.on({start:function(){},timeout:function(){},stop:function(){a&&(a.remove(),a=null)},load:function(e){var c=p.extendPoints(n.convertCandles(e),o);a=n.chart.addSeries(r.extend(n.configurator._createSeriesConfig(c,"ic-"+o.getInstrument().getSymbol(),o.getInstrument().getDisplayName()),{color:s})),l=n.bindEvents(a,t);var h=b.addEvent(a,"remove",function(){i.call(n),h()}),u=b.addEvent(a,"destroy",function(){i.call(n),u()});t.on("remove",function(){o.stop()}),t.setColor(a.color),n.colors[s]=!1},update:function(e){a&&r.each(e,function(e){e.expansion||n.addOrUpdatePoint(a,n.configurator.getTypeConverter()(e,n._getLastPoint(),t.getSubscription().getFirstCandle()))})}})}})}.call(e,i,e,t))&&(t.exports=r)}).call(e,i(0),i(5))},2066:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(s=function(t,e,n){var s=i(0),a=i(409),l=i(791),c=i(2052),h=i(2075),u={enabled:!1,handlers:[]},d={DOWN:"mousedown",MOVE:"mousemove",UP:"mouseup"},p={DELETE:46,ESC:27},f=function(){function t(e){var i=e.chart,n=e.options,r=e.start,a=e.onSave,l=e.forExport;o(this,t),this._chart=i,this._options=s.compact(n),this._onSave=a,this._start=r,this._type=c.defaultType,this.chart.chartDrawing=this,this.initSVG(),this.externalHandlers=[],l||this.initDrawingSettings()}return r(t,[{key:"chart",get:function(){return this._chart}},{key:"drawings",get:function(){return this._drawings},set:function(t){this._drawings=t}},{key:"options",get:function(){return this._options},set:function(t){this._options=t}},{key:"mainGroup",get:function(){return this._mainGroup}},{key:"backgroundRect",get:function(){return this._backgroundRect}},{key:"drawingFactory",get:function(){return this._drawingFactory}},{key:"onSave",get:function(){return this._onSave},set:function(t){this._onSave=t}},{key:"start",get:function(){return this._start}},{key:"yAxis",get:function(){return this.chart.get(l.options.names.axis.mainY)}},{key:"xAxis",get:function(){return this.chart.get(l.options.names.axis.mainX)}}]),r(t,[{key:"enableEditing",value:function(){u.enabled=!0,u.moved=!1,a.fireEvent(this,"enableEditing")}},{key:"disableEditing",value:function(){u.enabled=!1,u.moved=!1,a.fireEvent(this,"disableEditing")}},{key:"destroy",value:function(){this.removeActiveDrawingHandler.remove(),this.setActiveDrawing(null),s.each(this.externalHandlers,function(t){return t()}),s.each(this.drawings,function(t){return t.destroy()}),this.drawings=[]}},{key:"startDrawing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.defaultType;this.enableEditing(),this._type=t,this.bindEvents()}},{key:"stopDrawing",value:function(){this.disableEditing(),this._type=null,this.unbindEvents()}},{key:"initSVG",value:function(){this.initBackgroundRect(),this.initClipRect(),this.initMainGroup(),this.initLoadedDrawings(),this.initGlobalEvents()}},{key:"redraw",value:function(){this.updateClipRect(),this.updateDrawings()}},{key:"updateDrawings",value:function(){s.each(this.drawings,function(t){return t.redraw()})}},{key:"initBackgroundRect",value:function(){this._backgroundRect=this.chart.renderer.rect(0,0,0,0).attr({class:"drawings-background",height:"100%","pointer-events":"visible",width:"100%",zIndex:6}).add()}},{key:"initClipRect",value:function(){var t={x:this.yAxis.left,y:this.yAxis.top,width:this.yAxis.width,height:this.yAxis.height};this._clipRect=this.chart.renderer.clipRect(t)}},{key:"updateClipRect",value:function(){this._clipRect.attr({x:this.yAxis.left,y:this.yAxis.top,width:this.yAxis.width,height:this.yAxis.height})}},{key:"initMainGroup",value:function(){this._mainGroup=this.chart.renderer.g("drawings-container").attr({zIndex:7}).add().clip(this._clipRect)}},{key:"filterDrawings",value:function(t,e,i){return e?s.filter(t,function(t){var n=s.filter(t.keyPoints,function(t){return t.timestamp>e}).length;return i?0===n:0!==n}):t}},{key:"initLoadedDrawings",value:function(){var t=this;this._drawingFactory=new c(this.chart,this.mainGroup),this.drawings=s.compact(s.map(this.filterDrawings(this.options,this.start),function(e){return t.drawingFactory.createDrawing(e)}))}},{key:"initGlobalEvents",value:function(){a.wrap(a.Pointer.prototype,"drag",function(t,e){u.enabled||t.call(this,e)}),a.addEvent(this.chart,"redraw",this.redraw.bind(this)),a.addEvent(this.backgroundRect.element,d.DOWN,function(t){t.currentTarget===t.target&&!u.enabled&&u.drawing&&u.drawing.deactivate()})}},{key:"setActiveDrawing",value:function(t){u.drawing!==t&&(u.drawing&&(u.drawing.deactivate(!0),u.drawing=null,this.drawingSettingsBar.hide()),t&&(u.drawing=t,u.drawing.activate(!0),this.drawingSettingsBar.resetPosition(),this.drawingSettingsBar.show()))}},{key:"bindEvents",value:function(){this.addEvent(d.DOWN,this.mouseDownHandler.bind(this))}},{key:"unbindEvents",value:function(){for(var e in d)t.removeEvent(d[e])}},{key:"rebindEvents",value:function(){this.unbindEvents(),this.bindEvents()}},{key:"mouseDownHandler",value:function(t){this.enableEditing(),this.createDrawing(),this.updateDrawing(t),u.drawing.defaults.points>1&&(u.currentPointIndex=1),this.addEvent(d.MOVE,this.mouseMoveHandler.bind(this)),this.addEvent(d.UP,this.mouseUpHandler.bind(this))}},{key:"mouseMoveHandler",value:function(t){u.moved=!0,this.updateDrawing(t)}},{key:"mouseUpHandler",value:function(e){u.moved||(u.currentPointIndex=0),this.updateDrawing(e),u.currentPointIndex++,u.drawing.defaults.points===u.currentPointIndex?(u.drawing.addEvents(),this.rebindEvents(),u.drawing.isFinished(e)?this.finalizeDrawing(!0):this.unbindEvents()):t.removeEvent(d.DOWN)}},{key:"finalizeDrawing",value:function(t){this.disableEditing(),this.rebindEvents(),t&&this.saveDrawing()}},{key:"createDrawing",value:function(){var t={type:this._type,id:this._type+"_"+s.now()},e=this.drawingFactory.createDrawing(t);e.notSaved=!0,e.init(!0),e.activate(),u.currentPointIndex=0}},{key:"updateDrawing",value:function(t){u.drawing.update(u.currentPointIndex,t.chartX,t.chartY)}},{key:"saveDrawing",value:function(t){t&&u.drawing.notSaved||(u.drawing&&u.drawing.notSaved&&(this.drawings.push(u.drawing),delete u.drawing.notSaved,this.drawingSettingsBar.render()),this.options=s.uniq(s.pluck(this.drawings,"options").concat(this.filterDrawings(this.options,this.start,!0)),"id"),s.isFunction(this.onSave)&&this.onSave(this.options))}},{key:"clearDrawings",value:function(){this.setActiveDrawing(null),s.each(this.drawings,function(t){return t.destroy()}),this.drawings=[],this.options=[],s.isFunction(this.onSave)&&this.onSave(this.options)}},{key:"addEvent",value:function(e,i){var n=this;t.removeEvent(e),u.handlers[e]={remove:a.addEvent(this.chart.container,e,function(t){t=n.normalize(t),n.isInsideAxis(t)&&i(t)})}}},{key:"normalize",value:function(t){return t=t||window.event,t.chartX&&t.chartY?t:this.chart.pointer.normalize(t)}},{key:"isInsideAxis",value:function(t){return t.chartX>=this.yAxis.left&&t.chartY>=this.yAxis.top&&t.chartX<=this.yAxis.left+this.yAxis.width&&t.chartY<=this.yAxis.top+this.yAxis.height}},{key:"removeActiveDrawing",value:function(){if(u.drawing){var t=u.drawing;t.deactivate(),t.destroy();var e=this.drawings.indexOf(t);e>=0&&(this.drawings.splice(e,1),this.saveDrawing())}}},{key:"getActiveDrawing",value:function(){return u.drawing}},{key:"addKeyboardListener",value:function(t,e,i){var n=function(i){i=i||window.event,i.keyCode===t&&e()};return document.addEventListener("keydown",n,i||!1),{remove:function(){return document.removeEventListener("keydown",n)}}}},{key:"initDrawingSettings",value:function(){this.removeActiveDrawingHandler=this.addKeyboardListener(p.DELETE,this.removeActiveDrawing.bind(this)),this.drawingSettingsBar=new h({chartDrawing:this,parent:this.chart.container}),this.drawingSettingsBar.hide()}},{key:"isDrawingEditingEnabled",value:function(){return u.enabled}},{key:"applySettings",value:function(t){s.each(this.drawings,function(e){return e.applySettings&&e.applySettings(t)})}}],[{key:"removeEvent",value:function(t){if(u.handlers[t]){if(!s.isFunction(u.handlers[t].remove))throw new Error('Handler for "'+t+'" is not a function');u.handlers[t].remove(),delete u.handlers[t]}}}]),t}();n.exports=f}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0))},2067:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(a=function(t,e,n){var a=i(0),h=i(1966),u={id:null,keyPoints:[],type:"line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},d=function(t){function e(t,i,n){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return r(e,t),l(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){var e=void 0;switch(t){case 1:break;case 2:e=this.initPath(),this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),a.each(this.$points,function(e){return e.setColor(t)})}},{key:"defaults",get:function(){return a.extend(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}},{key:"fxclientOptions",get:function(){return u}}]),e}(h);n.exports=d}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2068:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(a=function(t,e,n){var a=i(0),h=i(1966),u={id:null,keyPoints:[],type:"horizontal_line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"none"},activeKeyPoint:{shape:"none"},addingKeyPoint:{shape:"none"},style:{extendLeft:!0,extendRight:!0}},data:{}},d=function(t){function e(t,i,n){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return r(e,t),l(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$points=this.createPoints(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(){switch(this.options.keyPoints.length){case 1:var t=this.initPath();this.$element.attr({d:t}),this.$hoverElement.attr({d:t})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",0,this.$points[0].y,"L",this.yAxis.width,this.$points[0].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),a.each(this.$points,function(e){return e.setColor(t)})}},{key:"defaults",get:function(){return a.extend(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return u}}]),e}(h);n.exports=d}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2069:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(a=function(t,e,n){var a=i(0),h=i(1966),u={id:null,keyPoints:[],type:"vertical_line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"none"},activeKeyPoint:{shape:"none"},addingKeyPoint:{shape:"none"}},data:{}},d=function(t){function e(t,i,n){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return r(e,t),l(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$points=this.createPoints(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){switch(t){case 1:var e=this.initPath();this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,0,"L",this.$points[0].x,this.yAxis.height]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),a.each(this.$points,function(e){return e.setColor(t)})}},{key:"defaults",get:function(){return a.extend(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return u}}]),e}(h);n.exports=d}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2070:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(a=function(t,e,n){var a=i(0),h=i(1966),u=i(2020),d={id:null,keyPoints:[],type:"trend_channel",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},p=function(t){function e(t,i,n){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return r(e,t),l(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$filledArea=this.createFilledArea(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints(),this.hidden={}}},{key:"_update",value:function(t,i){if(2===t){var n=e.parallelogram(this.$points[0],this.$points[1],i);i.setPixels((n[2].x+n[3].x)/2,(n[2].y+n[3].y)/2)}}},{key:"_move",value:function(t,i,n,o){if(!a.isUndefined(o))if(2!==o.index&&null!==this.hidden.height){var s=(this.$points[0].x+this.$points[1].x)/2,r=(this.$points[0].y+this.$points[1].y)/2;r+=this.hidden.height,this.$points[2].setPixels(s,r),this.$points[2].convert(!0)}else{var l=e.parallelogram(this.$points[0],this.$points[1],this.$points[2]);this.hidden.height=l[3].y-l[0].y,this.$points[2].setPixels((l[2].x+l[3].x)/2,(l[2].y+l[3].y)/2)}}},{key:"_render",value:function(t){var i=void 0;switch(t){case 1:break;case 2:i=["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y],this.$element.attr({d:i}),this.$hoverElement.attr({d:i});break;case 3:var n=e.parallelogram(this.$points[0],this.$points[1],this.$points[2]);this.hidden.height=n[3].y-n[0].y,this.$filledArea.attr({d:["M",n[0].x,n[0].y,"L",n[1].x,n[1].y,"L",n[2].x,n[2].y,"L",n[3].x,n[3].y]}),i=["M",n[0].x,n[0].y,"L",n[1].x,n[1].y,"M",n[2].x,n[2].y,"L",n[3].x,n[3].y],this.$element.attr({d:i}),this.$hoverElement.attr({d:i})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),this.$filledArea.attr({fill:t}),a.each(this.$points,function(e){return e.setColor(t)})}},{key:"defaults",get:function(){return a.extend(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:3})}},{key:"fxclientOptions",get:function(){return d}}],[{key:"parallelogram",value:function(t,e,i){var n=new u(e.x-t.x,e.y-t.y),o=new u(i.x-t.x,i.y-t.y),s=o.x*n.y-o.y*n.x;if(Math.abs(n.x)<.1)return[t,e,t,e];var r=s/n.x;return[t,e,new u(e.x,e.y-r),new u(t.x,t.y-r)]}}]),e}(h);n.exports=p}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2071:function(t,e,i){(function(n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(a=function(t,e,n){var a=i(0),h=i(1966),u=[0,.236,.382,.5,.618,.764,1,1.618,2.618,3.618,4.236],d={id:null,keyPoints:[],type:"line",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},p=function(t){function e(t,i,n){o(this,e);var r=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n));return r.precision=t.options.tooltip.valueDecimals,r}return r(e,t),l(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$levels=[];for(var t=0;t<u.length;t++)this.$levels.push({$levelLine:this.createLine(),$priceLabel:this.createLabel(),$coefLabel:this.createLabel()});this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){var e=void 0;switch(t){case 1:break;case 2:var i=this.$points[0].x<this.$points[1].x?0:1,n=1-i,o=this.$points[i],s=this.$points[n];if(o===s)return;o.convert(!0),s.convert(!0);for(var r=o.y-s.y,a=0;a<this.$levels.length;a++){var l=this.$levels[a],c=s.y+r*u[a],h=s.value+(o.value-s.value)*u[a];l.$levelLine.attr({d:["M",o.x,c,"L",s.x,c]}),l.$priceLabel.attr({text:h.toFixed(this.precision)}),l.$priceLabel.attr({x:s.x-this.$levels[a].$priceLabel.width,y:c+2}),l.$coefLabel.attr({text:u[a].toFixed(3),x:o.x,y:c+2})}e=this.initPath(),this.$element.attr({d:e}),this.$hoverElement.attr({d:e})}}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),a.each(this.$levels,function(e){return e.$levelLine.attr({stroke:t})}),a.each(this.$points,function(e){return e.setColor(t)})}},{key:"defaults",get:function(){return a.extend(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}},{key:"fxclientOptions",get:function(){return d}}]),e}(h);n.exports=p}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2072:function(t,e,i){(function(n,o){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l,c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(l=function(t,e,n){var o=i(0),l=i(5),u=i(1966),d=i(2021),p={id:null,keyPoints:[],type:"text",properties:{line:{lineColor:"#a3c4e3",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"},text:{textFill:"rgba(255, 255, 255, 1)",textBg:"transparent",textSize:"11px",backgroundOffsetWidth:7,backgroundOffsetHeight:5}},data:{text:""}},f=function(t){function e(t,i,n){return s(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,n))}return a(e,t),c(e,[{key:"_init",value:function(){var t=this;this.$container=this.createG(),this.$element=this.createLine(),this.$hoverElement=this.createLineHover(),this.$text=this.createText({text:this.prepareSvgText(this.options.data.text)}),this.$points=this.createPoints(),this.$text.on("mousedown",function(e){e.stopImmediatePropagation(),t.activate()}),this.$text.on("dblclick",function(e){e.stopImmediatePropagation(),t.activate(),new d(t)})}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){this.$textNoteInput&&this.$textNoteInput.updatePosition(t,e,i,n)}},{key:"_isFinished",value:function(t){return this.waitForText(t),!1}},{key:"prepareSvgText",value:function(t){return o.isString(t)?t.replace(/\n/g,"<br/>"):null}},{key:"waitForText",value:function(t){t?this.$textNoteInput||(this.$textNoteInput=new e.Input(t,this)):new d(this)}},{key:"save",value:function(t){if(o.isObject(t)||o.isString(t)){if(o.isObject(t))this.options.properties.text.textSize=t["font-size"]+"px",this.options.data.text=t["text-note"];else{if(!o.isString(t))return;this.options.data.text=t,this.$textNoteInput&&(this.$textNoteInput.remove(),delete this.$textNoteInput)}o.isString(this.options.data.text)&&this.options.data.text.trim()?(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finalize",this).call(this,!0),this.$text.attr({text:this.prepareSvgText(this.options.data.text)}).css({fontSize:parseInt(this.options.properties.text.textSize)+"px"}),this._render(this.$points.length)):(this.remove(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"finalize",this).call(this,!1))}else h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"save",this).call(this)}},{key:"_render",value:function(t){switch(t){case 1:var e=this.$points[0].x;this.$points[0].x+this.$text.getBBox().width>this.yAxis.width&&(e-=this.$text.getBBox().width);var i=this.$points[0].y;this.$text.attr({x:e,y:i});var n=["M",e,i,"h",this.$text.getBBox().width,"v",this.$text.getBBox().height,"h",-this.$text.getBBox().width,"Z"];this.$hoverElement.attr({d:n})}}},{key:"_destroy",value:function(){this.$textNoteInput&&this.$textNoteInput.remove(),this.$container.destroy()}},{key:"_setColor",value:function(t){this.$text.attr({fill:this.getFillColor(t)}),this.$text.attr({stroke:t}),o.each(this.$points,function(e){return e.setColor(t)})}},{key:"getFillColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getColor();return"#a3c4e3"===t?"rgba(239, 247, 254)":u.lightenDarkenColor(t,75)}},{key:"defaults",get:function(){return o.extend(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:1})}},{key:"fxclientOptions",get:function(){return p}},{key:"configurableOptions",get:function(){return[{name:"font-size",title:__("chart_drawings.settings.text_size"),type:"select",options:["10","11","12","13","14","15","16"],value:parseInt(this.options.properties.text.textSize)},{name:"text-note",title:__("chart_drawings.settings.text_note"),type:"textarea",value:this.options.data.text}]}}]),e}(u);f.Input=function(){function t(e,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{text:"",fontSize:"11px"};s(this,t),this.xAxis=i.xAxis,this.position=o.pick(e,"clientX","clientY","chartX","chartY"),this.onSaveCallback=i.save.bind(i),this.$container=l("<div>",{class:"text-note-area"}).css({fontSize:r.fontSize,top:this.position.clientY+"px",left:this.position.clientX+"px"}).appendTo(document.body),this.$textarea=l("<textarea>",{maxlength:"100","white-space":"pre"}).val(r.text).appendTo(this.$container),this.$textarea[0].focus(),this.updateSize(),this.$textarea.on("change drop keydown paste cut",this.onChange.bind(this)),setTimeout(function(){var t=[n.$textarea[0],n.$container[0],i.$points[0].$svg.element];n.outsideClickHandler=function(e){t.indexOf(e.target)<0&&n.applyText()},document.body.addEventListener("mousedown",n.outsideClickHandler,!0)},1)}return c(t,[{key:"updateSize",value:function(){this.$textarea.css("width","0px"),this.$textarea.css("height","0px");var t=Math.max(50,this.$textarea[0].scrollWidth);this.$textarea.css("width",t+"px");var e=Math.max(10,this.$textarea[0].scrollHeight);return this.$textarea.css("height",e+"px"),{width:t,height:e}}},{key:"updatePosition",value:function(t,e,i){this.$container.css({display:t?"block":"none",top:parseInt(this.$container.css("top"))+i+"px",left:parseInt(this.$container.css("left"))+e+"px"}),this.position.clientX+=e,this.position.clientY+=i,this.position.chartX+=e,this.position.chartY+=i,t&&(this.$textarea[0].focus(),this.render())}},{key:"applyText",value:function(){this.onSaveCallback(this.$textarea.val())}},{key:"remove",value:function(){document.body.removeEventListener("mousedown",this.outsideClickHandler,!0),this.$container.remove(),delete this.$container}},{key:"render",value:function(){if(this.$container){this.updateSize();var t=parseInt(this.$container.css("width"));this.$container.css("left",this.position.clientX-(this.position.chartX+t>this.xAxis.width?t:0)+"px")}}},{key:"onChange",value:function(t){var e=this;t&&(t.ctrlKey&&13===t.keyCode||27===t.keyCode)?this.applyText():setTimeout(function(){return e.render()},0)}}]),t}(),n.exports=f}.call(e,i,e,t))&&(t.exports=l)}).call(e,i(0),i(5))},2073:function(t,e){t.exports='<div class="drawing-settings-panel"><div class="drawing-settings-form"></div><div class="drawing-settings-footer"><div class="action-buttons"><button class="btn btn-primary fn-save"><%=__(\'actions.save\')%></button> <button class="btn fn-cancel"><%=__(\'actions.cancel\')%></button></div></div></div>'},2074:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},l=i(5),c=i(1966),h=i(0),u=i(3),d=i(2022),p=h.template('\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.start\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= start%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.end\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= end%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.high\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= high%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.low\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= low%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.difference\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= difference%></span>\n        <br/>\n        <span class="ml-key"><%= __(\'chart_drawings.measurer.candles\')%> : </span><span class="ml-val" style="font-weight: bold; text-anchor: end"><%= candles%></span>\n'),f={TIMESTAMP:0,CANDLE_CLOSE:4,POINT_CLOSE:1},g={id:null,keyPoints:[],type:"measurer",properties:{line:{lineColor:"#2e86ab",lineWidth:1,lineDash:[]},activeLine:{lineColor:"#ffc800",lineWidth:1,lineDash:[]},labels:{showPrice:!1,pricePlacement:"right"},defaultKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#2e86ab",lineColor:"#2e86ab",opacity:1},activeKeyPoint:{shape:"square",side:6,lineWidth:0,fillStyle:"#ffc800",lineColor:"#ffc800",opacity:1},addingKeyPoint:{shape:"none"}},data:{}},v=function(t){function e(t,i,s){n(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s));return r.precision=t.options.tooltip.valueDecimals,r}return s(e,t),r(e,[{key:"_init",value:function(){this.$container=this.createG(),this.$filledArea=this.createFilledArea(),this.$filledArea.attr({"fill-opacity":"0.1","stroke-width":1,stroke:this.getColor(),dashstyle:d.DASH}),this.$label=this.createLabel({shape:"callout",className:"measurer-label"}).attr({align:"left",fill:this.chartDrawing.chart.options.chart.backgroundColor,stroke:"#919292","stroke-width":1,padding:4,r:0}).css({color:this.chartDrawing.chart.options.xAxis[0].labels.style.color}),this.$element=this.createLine(),this.$gridElement=this.createLine().attr({dashstyle:d.DOT}),this.$hoverElement=this.createLineHover(),this.$points=this.createPoints()}},{key:"_update",value:function(t,e){}},{key:"_move",value:function(t,e,i,n){}},{key:"_render",value:function(t){switch(t){case 1:break;case 2:var i=this.$points[0].x<this.$points[1].x?0:1,n=1-i,o=this.$points[i],s=this.$points[n];if(o===s)return;o.convert(!0),s.convert(!0);var r=o.value-s.value,a=100*r/o.value,c=this.getCandlesCount(o,s),d=this.getHighAndLow(o,s),f=d.high,g=d.low;this.$label.attr({text:p({start:u(o.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+o.value.toFixed(this.precision),end:u(s.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+s.value.toFixed(this.precision),high:u(f.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+f.value.toFixed(this.precision),low:u(g.timestamp).utc().format("DD/MM/YYYY HH:mm")+" : "+g.value.toFixed(this.precision),difference:r.toFixed(this.precision)+" ("+a.toFixed(2)+"%)",candles:c})});var v=this.$label.text.element.getBBox().width;h.each(l(this.$label.element).find(".ml-val"),function(t){t.getAttribute("x")||(t.setAttribute("x",v),t.removeAttribute("dx"))}),this.$label.attr(e.getLabelPosition(this.$label,this.yAxis,o,s)),this.$element.attr({d:this.initPath()}),this.$filledArea.attr({d:["M",o.x,o.y,"L",s.x,o.y,"L",s.x,s.y,"L",o.x,s.y,"Z"]}),this.$gridElement.attr({d:["M",0,o.y,"L",o.x,o.y,"L",o.x,0,"M",s.x,0,"L",s.x,o.y,"L",this.yAxis.width,o.y,"M",this.yAxis.width,s.y,"L",s.x,s.y,"L",s.x,this.yAxis.height,"M",o.x,this.yAxis.height,"L",o.x,s.y,"L",0,s.y,"M",(o.x+s.x)/2,o.y,"L",(o.x+s.x)/2,s.y,"M",o.x,(o.y+s.y)/2,"L",s.x,(o.y+s.y)/2]}),this.$hoverElement.attr({d:["M",o.x,o.y,"L",s.x,o.y,"L",s.x,s.y,"L",o.x,s.y,"L",o.x,o.y,"L",s.x,o.y,"M",o.x,o.y,"L",s.x,s.y]})}}},{key:"getCandlesCount",value:function(t,e){var i=h.union.apply(this,h.map(this.xAxis.series,function(t){return t.xData}));return h.sortedIndex(i,e.timestamp)-h.sortedIndex(i,t.timestamp)}},{key:"_destroy",value:function(){this.$container.destroy()}},{key:"initPath",value:function(){return["M",this.$points[0].x,this.$points[0].y,"L",this.$points[1].x,this.$points[1].y]}},{key:"_setColor",value:function(t){this.$element.attr({stroke:t}),this.$filledArea.attr({fill:t,stroke:t}),this.$gridElement.attr({stroke:t}),h.each(this.$points,function(e){return e.setColor(t)})}},{key:"applySettings",value:function(t){this.$label&&this.$label.attr({fill:t.colors.common.background}).css({color:t.colors.common.foreground})}},{key:"getHighAndLow",value:function(t,e){var i={value:0,timestamp:null},n={value:1e10,timestamp:null};return h.each(this.xAxis.chart.series[0].options.data,function(o){var s=o[f.TIMESTAMP];if(s>=t.timestamp&&s<=e.timestamp){var r=o[f.CANDLE_CLOSE]||o[f.POINT_CLOSE];r>i.value&&(i.value=r,i.timestamp=s),r<n.value&&(n.value=r,n.timestamp=s)}}),{high:i,low:n}}},{key:"fxclientOptions",get:function(){return g}},{key:"defaults",get:function(){return h.extend(a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defaults",this),{points:2})}}],[{key:"getLabelPosition",value:function(t,e,i,n){var o=t.height,s=t.width,r=e.height,a=e.width,l={min:{x:Math.min(i.x,n.x),y:Math.min(i.y,n.y)},max:{x:Math.max(i.x,n.x),y:Math.max(i.y,n.y)},middle:{x:(i.x+n.x)/2,y:(i.y+n.y)/2}},c={top:l.min.y-7-o,bottom:l.max.y+7+o,left:l.min.x-7-s,right:l.max.x+7+s};switch(!0){case r>c.bottom:return{x:l.middle.x-s/2,y:l.max.y+7,anchorX:l.middle.x,anchorY:l.max.y};case c.top>0:return{x:l.middle.x-s/2,y:l.min.y-o-7,anchorX:l.middle.x,anchorY:l.min.y};case c.left>0:return{x:l.min.x-s-7,y:l.middle.y-o/2,anchorX:l.min.x,anchorY:l.middle.y};case a>c.right:return{x:l.max.x+7,y:l.middle.y-o/2,anchorX:l.max.x,anchorY:l.middle.y};default:return{x:-s,y:-o,anchorX:-7,anchorY:-7}}}}]),e}(c);t.exports=v},2075:function(t,e,i){(function(n,o){var s;void 0!==(s=function(t,e,n){var o=i(0),s=i(5),r=(i(2),i(2045)),a=i(282),l=i(2021);n.exports=r.extend({className:"floating-drawing-settings",template:o.template(i(2076)),events:function(){return o.extend({},o.result(r.prototype,"events"),{"click .fn-drawing-remove":"removeDrawing","click .fn-drawing-settings":"showDrawingSettings"})},onMouseDown:function(t){r.prototype.onMouseDown.apply(this,arguments),t.stopPropagation()},onMouseUp:function(t){r.prototype.onMouseUp.apply(this,arguments)},onMouseMove:function(t){r.prototype.onMouseMove.apply(this,arguments),this.isDragReady&&t.stopPropagation()},initialize:function(t){this.chartDrawing=t.chartDrawing,r.prototype.initialize.apply(this,arguments),s(this.parent).append(this.el)},removeDrawing:function(){this.chartDrawing.removeActiveDrawing()},showDrawingSettings:function(){return new l(this.chartDrawing.getActiveDrawing())},hide:function(){this.$el.css({display:"none"})},show:function(){this.render(),this.$el.css({display:"block"})},render:function(){this.options.settingsAvailable=!1,this.options.colorAvailable=!1;var t=this.options.chartDrawing.getActiveDrawing();if(t&&!t.notSaved&&(this.options.settingsAvailable=t.configurableOptions&&t.configurableOptions.length>0,this.options.colorAvailable=t.getColor&&t.getColor()),r.prototype.render.call(this),this.options.colorAvailable){var e=new a({el:this.$el.find(".drawing-color")[0],value:t.getColor(),container:this.$el});this.listenTo(e,"change",function(e,i){return t.setColor(i)})}},resetPosition:function(){this.$el.css({top:"",bottom:"",left:"",right:""})}})}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0),i(5))},2076:function(t,e){t.exports='<div class="floating-drawing-settings-container"><div class="separator dots-separator"></div> <% if (settingsAvailable) {%> <div class="icon icon-settings drawing-settings fn-drawing-settings"></div> <%}%> <% if (colorAvailable) {%> <div class="drawing-color"></div> <%}%> <div class="icon icon-recycle-blue drawing-remove fn-drawing-remove"></div></div>'},2077:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var l=i(1970),c={color:"#38424b",dashstyle:l.DASH_STYLES.SOLID,showRateLabel:!0},h=function(t){function e(t,i){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return s(e,t),a(e,[{key:"defaults",get:function(){return c}}]),e}(l);r.exports=h}.call(e,i,e,t))&&(t.exports=r)},2078:function(t,e,i){t.exports=i.p+"images/64f113f33482.png"},2079:function(t,e,i){t.exports=i.p+"images/e55d8022bf98.png"},2080:function(t,e,i){t.exports=i.p+"images/673da6b1b7fa.png"},2081:function(t,e,i){t.exports=i.p+"images/abf4f0300532.png"},2082:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var l=i(1970),c={color:"#de67a7",dashstyle:l.DASH_STYLES.SOLID,showRateLabel:!0},h=function(t){function e(t,i){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return s(e,t),a(e,[{key:"defaults",get:function(){return c}}]),e}(l);r.exports=h}.call(e,i,e,t))&&(t.exports=r)},2083:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(1970),u=i(2084),d=i(2085),p=i(1969),f={color:"#2e86ab",dashstyle:h.DASH_STYLES.SOLID,handleEvents:!0,infoLabelKey:"chart.line.open",infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showProfitLossLabel:!0,showRateLabel:!1,showTpslButton:!0},g=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.updateTplsButtonVisibility(),s.onInstrumentStatusChange(),s.updateRate(s.options.position.getCostBasis()),s.updatePl(s.options.position.getPLOpen()||0),s.listenTo(s.options.instrument,"change:closable change:editable",s.onInstrumentStatusChange.bind(s)),s.listenTo(s.options.position,"change:plOpen",function(t,e){return s.updatePl(e)}),s.listenTo(s.options.position,"change:takeProfit",s.onTakeProfitChange.bind(s)),s.listenTo(s.options.position,"change:stopLoss",s.onStopLossChange.bind(s)),s.listenTo(s.options.position,"remove",s.destroy.bind(s)),s}return s(e,t),l(e,[{key:"defaults",get:function(){return f}}]),l(e,[{key:"exportTo",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"exportTo",this).call(this,t),this.tpRateLine&&this.tpRateLine.exportTo(t),this.slRateLine&&this.slRateLine.exportTo(t)}},{key:"updateTplsButtonVisibility",value:function(){this.options.position.getTakeProfit()||this.options.position.getStopLoss()?this.$tpslButton.show(!0):this.tpRateLine||this.slRateLine||(this.$tpslButton.hide(),this.$tpslButton.enable(),this.tpslEnabled=!1)}},{key:"destroy",value:function(){this.destroyTPRateLine(),this.destroySLRateLine(),this.editPositionModel&&(this.editPositionModel.destroy(),this.editPositionModel=null),a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){c.trigger("ui:close-position",this.options.position)}},{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isClosable()?this.$closeButton.enable():this.$closeButton.disable()}},{key:"onTpslButtonClick",value:function(){this.tpslEnabled?(this.editPositionModel.destroy(),this.editPositionModel=null,this.destroyTPRateLine(),this.destroySLRateLine(),this.$tpslButton.enable()):(this.editPositionModel=p.createEditPositionModel(this.options.position,this.options.instrument),this.options.position.getTakeProfit()&&this.createTPRateLine(),this.options.position.getStopLoss()&&this.createSLRateLine(),this.$tpslButton.press()),this.tpslEnabled=!this.tpslEnabled}},{key:"onTakeProfitChange",value:function(){this.tpslEnabled&&(this.options.position.getTakeProfit()?this.tpRateLine?this.tpRateLine.updateRate(this.options.position.getTakeProfit().fixedPrice):this.createTPRateLine():this.destroyTPRateLine()),this.updateTplsButtonVisibility()}},{key:"onStopLossChange",value:function(){this.tpslEnabled&&(this.options.position.getStopLoss()?this.slRateLine?this.slRateLine.updateRate(this.options.position.getStopLoss().fixedPrice):this.createSLRateLine():this.destroySLRateLine()),this.updateTplsButtonVisibility()}},{key:"createSLRateLine",value:function(){this.slRateLine=new d(this.chart,{editPositionModel:this.editPositionModel,position:this.options.position,instrument:this.options.instrument})}},{key:"createTPRateLine",value:function(){this.tpRateLine=new u(this.chart,{editPositionModel:this.editPositionModel,position:this.options.position,instrument:this.options.instrument})}},{key:"destroySLRateLine",value:function(){this.slRateLine&&(this.slRateLine.destroy(),this.slRateLine=null)}},{key:"destroyTPRateLine",value:function(){this.tpRateLine&&(this.tpRateLine.destroy(),this.tpRateLine=null)}},{key:"applySettings",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"applySettings",this).call(this,t),this.slRateLine&&this.slRateLine.applySettings(t),this.tpRateLine&&this.tpRateLine.applySettings(t)}}]),e}(h);r.exports=g}.call(e,i,e,t))&&(t.exports=r)},2084:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(2023),u=i(1969),d=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.editPositionModel=s.options.editPositionModel,s.updateRate(s.options.position.getTakeProfit().fixedPrice),s.updatePl(s.editPositionModel.getProfit()),u.initEditing(s,s.editPositionModel,!0,{onChangeProfitForTakeProfit:function(){s.updatePl(s.editPositionModel.getProfit())},onChangeRate:s.updateDragAndDropRange.bind(s)}),s}return s(e,t),a(e,[{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){u.removePositionTakeProfit(this.editPositionModel)}},{key:"onDrop",value:function(){return u.updatePositionTakeProfit(this.editPositionModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editPositionModel;return e.isBuy()?t.min=e.getValidationValueForProfit():t.max=e.getValidationValueForProfit(),t}},{key:"onRateUpdated",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editPositionModel.setTakeProfit(this.rate)}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),u.stopEditing(this,this.editPositionModel,!0)}}]),e}(h);r.exports=d}.call(e,i,e,t))&&(t.exports=r)},2085:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(7),u=i(2024),d=i(1969),p=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.editPositionModel=s.options.editPositionModel,s.updateRate(s.options.position.getStopLoss().fixedPrice),s.updatePl(-s.editPositionModel.getLoss()),d.initEditing(s,s.editPositionModel,!0,{onChangeLossForStopLoss:function(){s.updatePl(-s.editPositionModel.getLoss())},onChangeRate:s.updateDragAndDropRange.bind(s)}),s}return s(e,t),a(e,[{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-position",this.options.position,!0)}},{key:"onCloseButtonClick",value:function(){d.removePositionStopLoss(this.editPositionModel)}},{key:"onDrop",value:function(){return d.updatePositionStopLoss(this.editPositionModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editPositionModel;return e.isBuy()?(t.max=e.getValidationValueForLoss(),h.isGuaranteedStopLossEnabled()&&(t.min=e.getGSLLimit())):(t.min=e.getValidationValueForLoss(),h.isGuaranteedStopLossEnabled()&&(t.max=e.getGSLLimit())),t}},{key:"onRateUpdated",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editPositionModel.setStopLoss(this.rate)}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),d.stopEditing(this,this.editPositionModel,!0)}}]),e}(u);r.exports=p}.call(e,i,e,t))&&(t.exports=r)},2086:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(1970),u=i(2087),d=i(2088),p=i(1969),f={color:"#7a43b0",dashstyle:h.DASH_STYLES.SOLID,draggable:!0,handleEvents:!0,infoLabelShowRate:!0,showCloseButton:!0,showEditButton:!0,showInfoLabel:!0,showRateLabel:!1,showTpslButton:!0},g=function(t){function e(t,i){n(this,e),i.infoLabelKey="chart.line.order."+i.order.getType().toLowerCase();var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.updateTplsButtonVisibility(),s.onInstrumentStatusChange(),s.editOrderModel=p.createEditOrderModel(s.options.order,s.options.instrument),s.updateRate(s.options.order.getPrice()),p.initEditing(s,s.editOrderModel,!1,{onChangeProfitForTakeProfit:function(){s.updatePl(s.editOrderModel.getProfit())},onChangeRate:s.updateDragAndDropRange.bind(s)}),s.listenTo(s.options.instrument,"change:closable change:editable",s.onInstrumentStatusChange.bind(s)),s.listenTo(s.options.order,"change:stopLimitPrice change:modifiedTime",s.onPriceChange.bind(s)),s.listenTo(s.options.order,"change:takeProfit",s.onTakeProfitChange.bind(s)),s.listenTo(s.options.order,"change:stopLoss",s.onStopLossChange.bind(s)),s.listenTo(s.options.order,"change:quantity",s.onQuantityChange.bind(s)),s.listenTo(s.options.order,"remove",s.destroy.bind(s)),s}return s(e,t),l(e,[{key:"defaults",get:function(){return f}}]),l(e,[{key:"destroy",value:function(){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.destroyTPRateLine(),this.destroySLRateLine(),this.editOrderModel&&(p.stopEditing(this,this.editOrderModel,!0),this.editOrderModel.destroy(),this.editOrderModel=null)}},{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){c.trigger("ui:cancel-order",this.options.order)}},{key:"onTpslButtonClick",value:function(){this.tpslEnabled?(this.destroyTPRateLine(),this.destroySLRateLine(),this.$tpslButton.enable()):(this.options.order.isTakeProfit()&&this.createTPRateLine(),this.options.order.isStopLoss()&&this.createSLRateLine(),this.$tpslButton.press()),this.tpslEnabled=!this.tpslEnabled}},{key:"onRateUpdated",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setCurrentPrice(this.rate),this.tpRateLine&&this.tpRateLine.updateRate(this.tpRateLine.rate+t),this.slRateLine&&this.slRateLine.updateRate(this.slRateLine.rate+t)}},{key:"onDrop",value:function(t){return this.editOrderModel.getTakeProfit()&&!this.tpRateLine&&this.editOrderModel.setTakeProfit(this.editOrderModel.getTakeProfit()+t),this.editOrderModel.getStopLoss()&&!this.slRateLine&&this.editOrderModel.setStopLoss(this.editOrderModel.getStopLoss()+t),p.updateOrder(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return"STOP"===this.options.order.getType()?e.isBuy()?t.min=e.getValidationValueForProfit():(t.max=e.getValidationValueForProfit(),t.min=e.getInstrumentModel().getPrecisionAsFloat()):e.isBuy()?(t.max=e.getValidationValueForLoss(),t.min=e.getInstrumentModel().getPrecisionAsFloat()):t.min=e.getValidationValueForLoss(),t}},{key:"exportTo",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"exportTo",this).call(this,t),this.tpRateLine&&this.tpRateLine.exportTo(t),this.slRateLine&&this.slRateLine.exportTo(t)}},{key:"updateTplsButtonVisibility",value:function(){this.options.order.isTakeProfit()||this.options.order.isStopLoss()?this.$tpslButton.show(!0):this.tpRateLine||this.slRateLine||(this.$tpslButton.hide(),this.$tpslButton.enable(),this.tpslEnabled=!1)}},{key:"onPriceChange",value:function(){this.updateRate(this.options.order.getPrice())}},{key:"onInstrumentStatusChange",value:function(){this.options.instrument.status.isEditable()?this.enableDragging():this.disableDragging(),this.options.instrument.status.isEditable()?this.$editButton.enable():this.$editButton.disable(),this.options.instrument.status.isClosable()?this.$closeButton.enable():this.$closeButton.disable()}},{key:"onQuantityChange",value:function(){this.editOrderModel.setAmount(this.options.order.get("quantity"))}},{key:"onTakeProfitChange",value:function(){this.tpslEnabled&&(this.options.order.isTakeProfit()?this.tpRateLine?this.tpRateLine.updateRate(this.options.order.getTakeProfit()):this.createTPRateLine():this.destroyTPRateLine()),this.updateTplsButtonVisibility()}},{key:"onStopLossChange",value:function(){this.tpslEnabled&&(this.options.order.isStopLoss()?this.slRateLine?this.slRateLine.updateRate(this.options.order.getStopLoss()):this.createSLRateLine():this.destroySLRateLine()),this.updateTplsButtonVisibility()}},{key:"createSLRateLine",value:function(){this.slRateLine=new d(this.chart,{editOrderModel:this.editOrderModel,order:this.options.order,instrument:this.options.instrument})}},{key:"createTPRateLine",value:function(){this.tpRateLine=new u(this.chart,{editOrderModel:this.editOrderModel,order:this.options.order,instrument:this.options.instrument})}},{key:"destroySLRateLine",value:function(){this.slRateLine&&(this.slRateLine.destroy(),this.slRateLine=null)}},{key:"destroyTPRateLine",value:function(){this.tpRateLine&&(this.tpRateLine.destroy(),this.tpRateLine=null)}},{key:"applySettings",value:function(t){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"applySettings",this).call(this,t),this.slRateLine&&this.slRateLine.applySettings(t),this.tpRateLine&&this.tpRateLine.applySettings(t)}}]),e}(h);r.exports=g}.call(e,i,e,t))&&(t.exports=r)},2087:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(2023),u=i(1969),d=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.editOrderModel=i.editOrderModel,s.updateRate(s.options.order.getTakeProfit()),s.updatePl(s.editOrderModel.getProfit()),u.initEditing(s,s.editOrderModel,!0,{onChangeProfitForTakeProfit:function(){s.updatePl(s.editOrderModel.getProfit())}}),s.listenTo(s.options.order,"change:modifiedTime",function(){s.options.order.isTakeProfit()&&s.updateRate(s.options.order.getTakeProfit())}),s}return s(e,t),a(e,[{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){u.removeOrderTakeProfit(this.editOrderModel)}},{key:"onDrop",value:function(){return u.updateOrderTakeProfit(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return e.isBuy()?t.min=e.getPrice()+e.minOrderDistance(!0):t.max=e.getPrice()-e.minOrderDistance(!0),t}},{key:"onRateUpdated",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setTakeProfit(this.rate)}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),u.stopEditing(this,this.editOrderModel,!0)}}]),e}(h);r.exports=d}.call(e,i,e,t))&&(t.exports=r)},2088:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function t(e,i,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,i);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(n)};void 0!==(r=function(t,e,r){var c=(i(0),i(2)),h=i(2024),u=i(7),d=i(1969),p=function(t){function e(t,i){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return s.editOrderModel=i.editOrderModel,s.updateRate(s.options.order.getStopLoss()),s.updatePl(-s.editOrderModel.getLoss()),d.initEditing(s,s.editOrderModel,!0,{onChangeLossForStopLoss:function(){s.updatePl(-s.editOrderModel.getLoss())}}),s.listenTo(s.options.order,"change:modifiedTime",function(){s.options.order.isStopLoss()&&s.updateRate(s.options.order.getStopLoss())}),s}return s(e,t),a(e,[{key:"onEditButtonCLick",value:function(){c.trigger("ui:edit-order",this.options.order)}},{key:"onCloseButtonClick",value:function(){d.removeOrderStopLoss(this.editOrderModel)}},{key:"onDrop",value:function(){return d.updateOrderStopLoss(this.editOrderModel)}},{key:"getDragAndDropRange",value:function(){var t={},e=this.editOrderModel;return e.isBuy()?(t.max=e.getPrice()-e.minOrderDistance(!0),u.isGuaranteedStopLossEnabled()&&(t.min=e.calcClosePrice())):(t.min=e.getPrice()+e.minOrderDistance(!0),u.isGuaranteedStopLossEnabled()&&(t.max=e.calcClosePrice())),t}},{key:"onRateUpdated",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onRateUpdated",this).call(this),this.editOrderModel.setStopLoss(this.rate)}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),d.stopEditing(this,this.editOrderModel,!0)}}]),e}(h);r.exports=p}.call(e,i,e,t))&&(t.exports=r)},2089:function(t,e,i){var n;void 0!==(n=function(t,e,n){n.exports=function(t){t||(t=i(409));var e=t.addEvent,n=t.removeEvent,o=t.createElement,s=t.css,r=t.defined,a=t.doc,l=t.each,c=t.extend,h=t.isMS,u=t.symbolSizes,d=t.merge;t.SVGRenderer.prototype.buttonIcon=function(t,i,n,o,s,r,a,l,u,p,f,g){var v=this.labelIcon(t,i,n,o,s,r,g,null,null,null,null,"button"),y=0;v.attr(d({padding:8,r:2},l));var m=void 0,b=void 0,w=void 0,x=void 0,_=void 0,k=void 0,S=void 0,L=void 0;return l=d({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},l),m=l.style,delete l.style,_=l.icon,delete l.icon,u=d(l,{fill:"#e6e6e6"},u),b=u.style,delete u.style,k=u.icon,delete u.icon,p=d(l,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},p),w=p.style,delete p.style,S=p.icon,delete p.icon,f=d(l,{fill:"#e0e0e0",style:{color:"#cccccc",cursor:"not-allowed"}},f),x=f.style,delete f.style,L=f.icon,delete f.icon,e(v.element,h?"mouseover":"mouseenter",function(){3!==y&&v.setState(1)}),e(v.element,h?"mouseout":"mouseleave",function(){3!==y&&v.setState(y)}),v.setState=function(t){1!==t&&(v.state=y=t),v.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),v.attr([l,u,p,f][t||0]).css([m,b,w,x][t||0]),v.bImage.attr({href:[_,k,S,L][t||0]||o})},v.enable=function(){v.setState(0)},v.press=function(){v.setState(2)},v.disable=function(){v.setState(3)},v.updateNormalState=function(t){l=d(l,t),0===y&&v.attr(t)},v.attr(l).css(c({cursor:"default"},m)),v.on("click",function(t){3!==y&&a.call(v,t)})},t.SVGRenderer.prototype.labelIcon=function(e,i,h,p,f,g,v,y,m,b,w,x){var _=this,k=_.g("button"!==x&&"label"),S=k.text=_.text("",0,0,b).attr({zIndex:1}),L=void 0,P=k.bImage=_.image(p).attr({zIndex:1}),C=void 0,$=0,O=3,T=0,E=void 0,D=void 0,R=void 0,M=void 0,A=void 0,I={},z=void 0,B=void 0,j=/^url\((.*?)\)$/.test(v),V=j,H=void 0,F=void 0,N=void 0,Y=void 0,U=void 0;x&&k.addClass("highcharts-"+x),V=j,H=function(){return(z||0)%2/2},F=function(){var t=S.element.style,e=void 0,i={},n=(void 0===E||void 0===D||A)&&r(S.textStr)&&S.getBBox(),o=P.getBBox();C={width:(E||n.width||0)+(f||o.width||0)+(n.width&&(f||o.width)?O:0),height:Math.max(D||n.height||0,D||g||o.height||0),x:o.x||n.x,y:o.y||n.y},k.width=C.width+2*O+T,k.height=C.height+2*O,B=(.75*_.fontMetrics(t&&t.fontSize,S).b+k.height)/2,V&&(L||(k.bRect=L=_.symbols[v]||j?_.symbol(v):_.rect(),L.addClass(("button"===x?"":"highcharts-label-box")+(x?" highcharts-"+x+"-box":"")),L.add(k),e=H(),i.x=e,i.y=(w?-B:0)+e),i.width=Math.round(k.width),i.height=Math.round(k.height),L.attr(c(i,I)),I={})},Y=function(){var t=P.getBBox(),e=O+T+(t.width?t.width+O:0),i=void 0;i=w?0:B,r(E)&&C&&("center"===A||"right"===A)&&(e+={center:.5,right:1}[A]*(E-C.width)),e===S.x&&i===S.y||(S.attr("x",e),void 0!==i&&S.attr("y",i)),S.x=e,S.y=i},U=function(t,e){L?L.attr(t,e):I[t]=e},N=function(t,e){if(t&&e){var i=C.height-e;F(i/2),Y(),k.attr({visibility:"visible"}),k.attr({y:k.y+i/2})}var n=O+T,o=void 0;o=O,r(E)&&C&&("center"===A||"right"===A)&&(n+={center:.5,right:1}[A]*(E-C.width)),n===P.x&&n===P.y||(P.attr("x",n),void 0!==o&&P.attr("y",o)),P.x=n,P.y=o},k.onAdd=function(){S.add(k),P.add(k),f&&g&&P.attr({width:f,height:g}),k.attr({text:e||0===e?e:"",x:i,y:h}),L&&r(y)&&k.attr({anchorX:y,anchorY:m}),f&&g||(k.attr({visibility:"hidden"}),u[p]?N(u[p].width,u[p].height):o("img",{src:p,onload:function(){0===this.width&&(s(this,{position:"absolute",top:"-999em"}),a.body.appendChild(this)),u[p]={width:this.width,height:this.height},this.parentNode&&this.parentNode.removeChild(this),N(this.width,this.height)}}))},k.widthSetter=function(e){E=t.isNumber(e)?e:null},k.heightSetter=function(t){D=t},k["text-alignSetter"]=function(t){A=t},k.paddingSetter=function(t){r(t)&&t!==O&&(O=k.padding=t,Y())},k.paddingLeftSetter=function(t){r(t)&&t!==T&&(T=t,Y())},k.alignSetter=function(t){(t={left:0,center:.5,right:1}[t])!==$&&($=t,C&&k.attr({x:R}))},k.textSetter=function(t){void 0!==t&&S.textSetter(t),F(),Y(),N()},k["stroke-widthSetter"]=function(t,e){t&&(V=!0),z=this["stroke-width"]=t,U(e,t)},k.strokeSetter=k.fillSetter=k.rSetter=function(t,e){"fill"===e&&t&&(V=!0),U(e,t)},k.anchorXSetter=function(t,e){y=k.anchorX=t,U(e,Math.round(t)-H()-R)},k.anchorYSetter=function(t,e){m=k.anchorY=t,U(e,t-M)},k.xSetter=function(t){k.x=t,$&&(t-=$*((E||C.width)+2*O)),R=Math.round(t),k.attr("translateX",R)},k.ySetter=function(t){M=k.y=Math.round(t),k.attr("translateY",M)};var X=k.css;return c(k,{css:function(t){if(t){var e={};t=d(t),l(k.textProps,function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])}),S.css(e)}return X.call(k,t)},getBBox:function(){return{width:C.width+2*O,height:C.height+2*O,x:C.x-O,y:C.y-O}},shadow:function(t){return t&&(F(),L&&L.shadow(t)),k},destroy:function(){n(k.element,"mouseenter"),n(k.element,"mouseleave"),S&&(S=S.destroy()),L&&(L=L.destroy()),P&&(P=P.destroy()),t.SVGElement.prototype.destroy.call(k),k=_=F=Y=U=N=null}})}}}.call(e,i,e,t))&&(t.exports=n)},2090:function(t,e,i){function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o;void 0!==(o=function(t,e,o){var s=["up","none","down"],r=function(t,e){return t>e?s[2]:t<e?s[0]:s[1]},a=function(t){for(var e={general:t},i={},n=[],o=0,a=s.length;o<a;o++)e[s[o]]=[],i[s[o]]=[];for(var l,c,h,u,d,p,f=1,g=t.xMap.length;f<g;f++)l=t[3*f+1],c=t[3*f+2],h=t[3*f-2],u=t[3*f-1],d=r(c,u),p!==d&&(e[d].push("M",h,u),i[d].push(t.xMap[f-1])),e[d].push("L",l,c),i[d].push(t.xMap[f]),n.push(d),p=d;return e.up.xMap=i.up,e.none.xMap=i.none,e.down.xMap=i.down,{paths:e,directions:n}};o.exports=function(t){t||(t=i(409));var e=t.each;t.seriesType("up-down-line","line",{upColor:"#1ecd93",color:"#3d6bb1",downColor:"#ff433d"},{drawGraph:function(){var t,i=this,o=this.options,r=(t={},n(t,s[0],o.upColor),n(t,s[1],o.color),n(t,s[2],o.downColor),t),l=(this.gappedPath||this.getGraphPath).call(this),c=[["graph","highcharts-graph",o.lineColor||this.color,o.dashStyle,"general"]];e(s,function(t){return c.push(["updown-graph-"+t,"highcharts-graph highcharts-updown-graph-"+t,r[t]||i.color,o.dashStyle,t])});var h=a(l);e(i.points,function(t,e){t.color=r[h.directions[e]]||i.color}),e(c,function(t,e){var n=t[0],s=i[n],r=h.paths[t[4]],a=void 0;s?(s.endX=r.xMap,s.animate({d:r})):r.length&&(i[n]=i.chart.renderer.path(r).addClass(t[1]).attr({zIndex:1}).add(i.group),a={stroke:t[2],"stroke-width":o.lineWidth,fill:i.fillGraph&&i.color||"none"},t[3]?a.dashstyle=t[3]:"square"!==o.linecap&&(a["stroke-linecap"]=a["stroke-linejoin"]="round"),s=i[n].attr(a).shadow(0===e&&o.shadow)),s&&(s.startX=r.xMap,s.isArea=r.isArea)}),this.graph&&this.graph.hide()},setState:function(i){t.Series.prototype.setState.call(this,i);var n=this,o=this.options.states,r=this.options.lineWidth;n.state=i,o[i]&&!1===o[i].enabled||(i&&(r=o[i].lineWidth||r+(o[i].lineWidthPlus||0)),n.graph&&!n.graph.dashstyle&&e(s,function(t){return n["updown-graph-"+t]&&n["updown-graph-"+t].attr({"stroke-width":r})}))}})}}.call(e,i,e,t))&&(t.exports=o)},2091:function(t,e,i){var n;void 0!==(n=function(t,e,n){n.exports=function(t){t||(t=i(409)),t.seriesType("heikin-ashi","candlestick",{})}}.call(e,i,e,t))&&(t.exports=n)},2092:function(t,e,i){var n;void 0!==(n=function(t,e,n){n.exports=function(t){t||(t=i(409)),t.seriesType("comparison","line",{})}}.call(e,i,e,t))&&(t.exports=n)},2093:function(t,e,i){var n;void 0!==(n=function(t,e,n){var o=i(13);n.exports=o.extend({setChange:function(t){this.set("change",t)},setColor:function(t){this.set("color",t)},setName:function(t){this.set("name",t)},setSubscription:function(t){this.set("subscription",t)},getChange:function(){return this.get("change")},formatChange:function(){return this.get("change")+"%"},getColor:function(){return this.get("color")},getName:function(){return this.get("name")},getSymbol:function(){return this.get("symbol")},getSubscription:function(){return this.get("subscription")}})}.call(e,i,e,t))&&(t.exports=n)},2094:function(t,e,i){var n;void 0!==(n=function(t,e,n){var o=i(45),s=i(15),r=s.mobile()?3:4;n.exports=o.extend({full:!1,contains:function(t){return!!this.findWhere({symbol:t})},isFull:function(){return this.full},add:function(t,e){this.isFull()||(o.prototype.add.call(this,t,e),this.length>=r&&(this.trigger("full",!0),this.full=!0))},remove:function(t,e){o.prototype.remove.call(this,t,e),this.isFull()&&(this.trigger("full",!1),this.full=!1)}})}.call(e,i,e,t))&&(t.exports=n)},2095:function(t,e,i){var n;void 0!==(n=function(t,e,n){var o=i(805),s=i(810),r=i(276),a=i(417);n.exports=r.extend({show:function(t){var e=this.$el.parent();e.css("display","flex"),t?e.addClass("first-search"):e.hasClass("first-search")&&e.removeClass("first-search"),e.find("input")[0].focus()},hide:function(){this.$el.parent().css("display","none")},initialize:function(){r.prototype.initialize.apply(this,arguments);var t=this.$el.find(".search-block-input input")[0];t.setAttribute("size",t.getAttribute("placeholder").length)},openResults:function(){var t=this;this.grid=o({className:"instruments-table",collection:this.collection,empty:s,shouldHideColumns:!0,source:"search",customRowsComponent:i(811),customRowComponent:i(812),columns:[{key:"name",type:a,style:{width:"100%"}}],onRowClick:function(e,i){t.options.onRowClick&&t.options.onRowClick(i.get("symbol")),t.closeResults(),t.hide()}},this.$el.find(".results")[0]),this.$el.find(".results").css("display","block")}})}.call(e,i,e,t))&&(t.exports=n)},2096:function(t,e){t.exports='<div class="chart-no-data"><div class="chart-no-data-image"></div><div class="chart-no-data-message"><%-__(\'chart.no_data\')%></div></div>'},2097:function(t,e,i){(function(n){var o;void 0!==(o=function(t,e,o){var s=i(1);o.exports=s.createClass({displayName:"exports",getDefaultProps:function(){return{mainInstrument:null,comparisonInstruments:null}},getInitialState:function(){return{mainInstrument:this.props.mainInstrument,comparisonInstruments:this.props.comparisonInstruments}},componentDidMount:function(){this.state.mainInstrument.on("change:color change:change",this.update,this),this.state.comparisonInstruments.on("update change:color change:change",this.update,this)},componentWillUnmount:function(){this.state.mainInstrument.off("change:color change:change",this.update,this),this.state.comparisonInstruments.off("update change:color change:change",this.update,this)},update:function(){this.setState({mainInstrument:this.state.mainInstrument,comparisonInstruments:this.state.comparisonInstruments})},removeInstrument:function(t){this.state.comparisonInstruments.remove(t),this.update()},setMainInstrument:function(t){this.state.mainInstrument.off("change:color change:change",this.update,this),t.on("change:color change:change",this.update,this),this.setState({mainInstrument:t})},renderInstrument:function(t,e){var i=this;return s.createElement("div",{className:"ic",key:t.getName()},s.createElement("div",{className:"ic-color",style:{backgroundColor:t.getColor()}}),s.createElement("div",{className:"ic-name"},t.getName()),s.createElement("div",{className:"ic-change"},n.isNumber(t.getChange())?t.formatChange():""),!e&&s.createElement("div",{className:"ic-btn-cancel",title:__("chart.instruments_comparison.remove"),onClick:function(){i.removeInstrument(t)}},s.createElement("i",null)))},render:function(){var t=this;return s.createElement("div",null,this.renderInstrument(this.state.mainInstrument,!0),this.state.comparisonInstruments.map(function(e){return t.renderInstrument(e)}))}})}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(0))},2119:function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),l=i.n(a),c=i(11),h=i.n(c),u=i(2785),d=i.n(u),p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),f=function(t){function e(){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),p(e,[{key:"componentDidMount",value:function(){this.$chart=new d.a({parent:this.refs.component})}},{key:"componentWillUnmount",value:function(){this.$chart&&this.$chart.destroy()}},{key:"render",value:function(){var t=this.props,e=t.height,i=t.className,o=h()(n({"chart-box":!0},i,!!i)),s={};return e&&(s={height:e+"px",minHeight:e+"px",maxHeight:e+"px"}),l.a.createElement("div",{className:o,style:s,ref:"component"})}}]),e}(l.a.Component);e.default=f},2390:function(t,e,i){(function(e){var n=i(15),o=i(7),s=["cl-1","cl-2","cl-3","cl-1-1","cl-1-2","cl-2-1","cl-2-2","cl-1-3","cl-3-1","cl-1-1-1"],r=["cl-1","cl-2","cl-1-1","cl-1-2","cl-2-1","cl-2-2","cl-1-1-1"],a=[],l=n.desktop()?s:n.tablet()?r:a;t.exports={DEFAULT:"cl-2-2",ALL:l,getEmptyMultiChartsPlaceIndex:function(){var t=o.getUserCommonData().getMultiChartsSettings();if(!t||!t.charts||!e.isArray(t.charts))return 0;var i=this.isLayoutAvailable(t)?t.layout:this.DEFAULT,n=this.getSizeByName(i),s=e.findIndex(t.charts,function(t){return null===t});return s<0&&(s=t.charts.length),s<n?s:-1},getSizeByName:function(t){return e.reduce(t.split("-"),function(t,e){return/^\d+$/.test(e)?t+ +e:t},0)},isLayoutAvailable:function(t){return t&&t.layout&&this.ALL.indexOf(t.layout)>=0}}}).call(e,i(0))},2627:function(t,e,i){(function(n,o){var s;void 0!==(s=function(t,e,n){function o(t,e){var i=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector;if(i)return i.call(t,e)}function s(t,e){for(;t;){if(o(t,e))return t;t=t.parentElement}return null}var r=i(12),a=i(5),l=i(0),c=i(15),h=i(135),u=i(79),d=i(185),p=i(9),f=i(7),g=i(2390),v=i(852).default,y=i(297),m=i(2052),b=i(791),w=i(2),x=void 0,_=l.template(i(2628));n.exports=r.extend({className:"chart-toolbar separated",events:function(){return l.extend({},l.result(r.prototype,"events"),{"click .disabled, [disabled]":function(t){return t.stopImmediatePropagation()},"click .fn-change-cursor":"changeCursor","click .fn-change-rate-line":"changeRateLine","click .fn-toolbar-zoom-in":"zoomIn","click .fn-toolbar-zoom-out":"zoomOut","click .fn-toolbar-settings":"showChartSettings","click .fn-toolbar-indicators":"showIndicatorsSettings","click .fn-toolbar-screenshot":"makeScreenshot","click .fn-toolbar-minimize":"minimize","click .fn-toolbar-fullscreen":"fullscreen","click .fn-toolbar-restore-size":"restoreSize","click .fn-toolbar-drawings":"toggleDrawing","click .fn-start-drawing":"startDrawing","click .fn-clear-drawings":"clearDrawings","click .fn-toolbar-add-to-multicharts":"addToMulticharts"})},initialize:function(){x=i(413),r.prototype.initialize.apply(this,arguments),this.hide(),this.render()},enableComparisonMode:function(){this.comparisonMode=!0,this.$el.addClass("comparison"),this.options.chartPanel.enableComparisonMode(this.$rangesSelect.value())},disableComparisonMode:function(){this.comparisonMode=!1,this.$el.removeClass("comparison"),this.options.chartPanel.disableComparisonMode(this.$typesSelect.value(),this.$periodsSelect.value())},show:function(t){var e=this;if(this.isEmbedded())this.$el.css({display:"flex"});else{this.$el.css({display:"flex"});var i=this.options.relatedTo[0].getBoundingClientRect(),n=this.el.getBoundingClientRect(),o="rtl"===a("html").attr("dir");this.$el.css({position:"fixed",visibility:"visible",top:i.top+i.height/2-n.height/2+"px",left:(o?i.left:i.right-n.width)+"px","z-index":6e3}),t||setTimeout(function(){a(window).on("resize.chartToolbar"+e.cid,e.hide.bind(e)),a("body").on("click.chartToolbar"+e.cid,e.onBodyClick.bind(e))},0)}},onBodyClick:function(t){s(t.target,".chart-toolbar")!==this.el&&this.hide()},isEmbedded:function(){return this.options.embedded},hide:function(){this.isEmbedded()||(a("body").off("click.chartToolbar"+this.cid),a(window).off("resize.chartToolbar"+this.cid),this.$el.css({position:"fixed",top:"-1000px",left:"-1000px",display:"none"}))},renderSearch:function(){var t=this,e=i(276);this.$comparisonSearch=new e({el:this.$el.find(".chart-ic-search"),placeholder:__("chart.instruments_comparison.add"),columns:[{key:"name",type:i(417),style:{width:"100%"}}],onRowClick:function(e,i){t.addComparisonInstrument(i.getSymbol())}})},createSelect:function(t,e,i,n){var o=new d({el:this.$el.find(t),name:e,value:n,options:i,template:u.selectBox,disable:!1,translationKey:"",disableChangeByKeyboard:!0,transformOptionsValue:function(t){return t},transformOptionText:function(t){return t},title:__("wizard.form.label.DEFAULT_EMPTY")});return o.value(n),o},renderRanges:function(){var t=this;this.$rangesSelect=this.createSelect(".ranges","ranges",l.keys(x.getRanges()),this.options.range.toLowerCase()),this.listenTo(this.$rangesSelect,"change",function(e,i){t.options.chartPanel.onChangeRange(i),t.hide()})},renderPeriods:function(){var t=this;this.$periodsSelect=this.createSelect(".periods","periods",l.keys(x.getPeriods()),this.options.period.toLowerCase()),this.listenTo(this.$periodsSelect,"change",function(e,i){t.options.chartPanel.onChangePeriod(i),t.hide()})},renderTypes:function(){var t=this,e=b.defaultTypes;p.isChartInstrumentsComparisonEnabled()&&(e=e.slice(0),e.push(b.comparisonType)),this.$typesSelect=new d({el:this.$el.find(".types"),name:"types",options:e,template:u.selectBox,disable:!1,disableChangeByKeyboard:!0,translationKey:"",transformOptionsValue:function(t){return t},transformOptionText:function(t){return'<i title="'+__("chart.toolbar.tooltip.type."+t)+'"></i><span>'+__("chart.toolbar.tooltip.type."+t)+"</span>"},title:__("wizard.form.label.DEFAULT_EMPTY")}),this.$typesSelect.value(this.options.type),this.$typesSelect.$el.find(".dk-selected").data("value",this.options.type),this.$typesSelect.$el.find(".styled-select").data("value",this.options.type),this.listenTo(this.$typesSelect,"change",function(e,i){t.$typesSelect.$el.find(".dk-selected").data("value",i),t.$typesSelect.$el.find(".styled-select").data("value",i),t.changeType(i)})},render:function(){this.parent&&a(this.parent).append(this.el),this.isEmbedded()?this.$el.addClass("chart-toolbar-embedded"):this.$el.addClass("chart-toolbar-expanded"),this.$el.html(_({drawings:m.types,cursors:l.pluck(l.filter(b.defaultCursors,"selectable"),"type"),rateLines:b.defaultRateLines,isDesktop:c.desktop(),isNotMobile:!c.mobile(),isEmbedded:this.isEmbedded(),multiChartsEnabled:p.checkMultiChartsEnabled()})),this.renderSearch(),this.renderPeriods(),this.renderRanges(),this.renderTypes(),this.setActiveCursor(this.options.cursor.toLowerCase()),this.setActiveRateLine(this.options.rateLine.toLowerCase()),this.options.comparisonMode&&(this.comparisonMode=!0,this.$el.addClass("comparison")),this.$el.find(".fn-toolbar-add-to-multicharts")&&(this.renderAddToMultichartsButton(),this.listenTo(f.getUserCommonData(),"multicharts:updated",this.renderAddToMultichartsButton.bind(this)))},addComparisonInstrument:function(t){this.options.chartPanel.addComparisonInstrument(t)},zoomIn:function(){this.options.chartPanel.onZoomIn(),this.hide()},zoomOut:function(){this.options.chartPanel.onZoomOut(),this.hide()},showChartSettings:function(){this.options.chartPanel.onShowChartSettings(),this.hide()},showIndicatorsSettings:function(){this.options.chartPanel.onShowIndicatorsSettings(),this.hide()},startDrawing:function(t){var e=this,i=t.currentTarget.dataset.type;this.setActiveDrawing(i),this.options.chartPanel.startDrawing(i),this.hide(),this.stopDrawingKeyboardEvent||(this.stopDrawingKeyboardEvent=h({escape:function(){return e.stopDrawing()}},this))},stopDrawing:function(){this.stopDrawingKeyboardEvent&&(this.stopDrawingKeyboardEvent.off(),delete this.stopDrawingKeyboardEvent),this.setActiveDrawing(),this.options.chartPanel.stopDrawing(),this.hide()},toggleDrawing:function(t){s(t.target,".fn-start-drawing")||(a(t.currentTarget).hasClass("active")?this.stopDrawing():(t.currentTarget.dataset.type||(t.currentTarget.dataset.type=m.defaultType),this.startDrawing(t)))},clearDrawings:function(){this.stopDrawing(),this.options.chartPanel.clearDrawings()},changeType:function(t){t===b.comparisonType?this.enableComparisonMode():this.comparisonMode?this.disableComparisonMode():this.options.chartPanel.onChangeType(t),this.hide()},changeCursor:function(t){var e=t.currentTarget.dataset.cursor;this.setActiveCursor(e),this.options.chartPanel.onChangeCursor(e),this.hide()},changeRateLine:function(t){var e=t.currentTarget.dataset.rateLine;this.setActiveRateLine(e),this.options.chartPanel.onChangeRateLine(e),this.hide()},makeScreenshot:function(){this.options.chartPanel.makeScreenshot(),this.hide()},minimize:function(){this.options.chartPanel.toggleMinimize(),this.hide(),w.trigger("ui:chart:collapse")},restoreSize:function(){this.setActiveSize(!1),this.options.chartPanel.restoreSize(),this.hide(),w.trigger("ui:chart:expand")},fullscreen:function(){this.setActiveSize(!0),this.options.chartPanel.toggleFullscreen(),this.hide()},setActiveCursor:function(t){this.$el.find(".fn-change-cursor.active").removeClass("active"),t&&this.$el.find('.fn-change-cursor[data-cursor="'+t+'"]').addClass("active")},setActiveRateLine:function(t){this.$el.find(".fn-change-rate-line.active").removeClass("active"),this.$el.find('.fn-change-rate-line[data-rate-line="'+t+'"]').addClass("active")},setActiveType:function(t){this.$el.find(".fn-change-type.active").removeClass("active"),this.$el.find('.fn-change-type[data-type="'+t+'"]').addClass("active")},setActiveDrawing:function(t){this.$el.find(".fn-toolbar-drawings").removeClass("active"),this.$el.find(".fn-start-drawing.active").removeClass("active"),t&&(this.$el.find(".fn-toolbar-drawings").addClass("active"),this.$el.find('.fn-start-drawing[data-type="'+t+'"]').addClass("active"))},setActiveSize:function(t){t?(this.$el.find(".fn-toolbar-fullscreen").css("display","none"),this.$el.find(".fn-toolbar-restore-size").css("display","flex")):(this.$el.find(".fn-toolbar-fullscreen").css("display","flex"),this.$el.find(".fn-toolbar-restore-size").css("display","none"))},destroy:function(){r.prototype.destroy.call(this)},updateComparisonSearch:function(t){t?this.disableComparisonSearch():this.enableComparisonSearch()},disableComparisonSearch:function(){this.$comparisonSearch.disable(),this.$comparisonSearch.setPlaceholder(__("chart.instruments_comparison.max_reached"))},enableComparisonSearch:function(){this.$comparisonSearch.enable(),this.$comparisonSearch.setPlaceholder(__("chart.instruments_comparison.add"))},renderAddToMultichartsButton:function(){v.updateUI();var t=this.$el.find(".fn-toolbar-add-to-multicharts");v.isStatusNew()&&t.find("i").addClass("add-to-multicharts-new"),g.getEmptyMultiChartsPlaceIndex()>=0?(t.removeClass("disabled"),t.attr("title",__("chart.toolbar.tooltip.add_to_multicharts"))):(t.addClass("disabled"),t.attr("title",__("chart.toolbar.tooltip.add_to_multicharts.disabled")))},addToMulticharts:function(){var t=this,e=g.getEmptyMultiChartsPlaceIndex(),i=this.options.chartPanel.getInstrumentSymbol();if(e>=0&&i){var n=f.getUserCommonData().getMultiChartsSettings();g.isLayoutAvailable(n)||f.getUserCommonData().saveMultiChartsSettings({layout:g.DEFAULT}),x.saveMultiChartsSettings(e,"symbol",i).then(function(){t.$el.find(".fn-toolbar-add-to-multicharts").find("i").removeClass("add-to-multicharts-new"),v.add(e),y.show({title:__("tab.multi_charts"),body:__("chart.toolbar.tooltip.add_to_multicharts.message",t.options.chartPanel.instrument.getDisplayName())})})}}})}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0),i(5))},2628:function(t,e){t.exports='<% if (isEmbedded) {%> <div class="chart-buy-sell"><div class="chart-sell"><table><tr></tr></table></div><div class="chart-buy"><table><tr></tr></table></div></div> <% }%> <div class="chart-ic-search"></div><div class="periods"></div><div class="ranges"></div><div class="types"></div><div class="controls"> <% if (isNotMobile && isEmbedded && multiChartsEnabled) {%> <div class="btn fn-toolbar-add-to-multicharts chart-toolbar-add-to-multicharts" title="<%=__(\'chart.toolbar.tooltip.add_to_multicharts\')%>"><i class="add-to-multicharts icon"></i></div> <% }%> <% if (isDesktop) {%> <div class="btn fn-toolbar-zoom-in chart-toolbar-zoom-in" title="<%=__(\'chart.toolbar.tooltip.zoom_in\')%>"><i class="icon-chart-zoomin"></i></div><div class="btn fn-toolbar-zoom-out chart-toolbar-zoom-out" title="<%=__(\'chart.toolbar.tooltip.zoom_out\')%>"><i class="icon-chart-zoomout"></i></div> <% }%> <div class="btn fn-toolbar-settings chart-toolbar-settings" title="<%=__(\'chart.toolbar.tooltip.chart_settings\')%>"><i class="icon-chart-settings"></i></div><div class="btn fn-toolbar-indicators chart-toolbar-indicators" title="<%=__(\'chart.toolbar.tooltip.indicators\')%>"><i class="icon-indicators"></i></div> <% if (isDesktop && _.size(drawings) > 0) {%> <div class="btn fn-toolbar-drawings chart-toolbar-drawings" title="<%=__(\'chart.toolbar.tooltip.drawing_tools\')%>"><i class="icon-chart-edit"></i><div class="sub-menu left-side"> <% _.each(drawings, function (drawing,type) {%> <div class="drawing <%-type.replace(/_/g, \'-\')%> fn-start-drawing" data-type="<%-type%>"><div><%=__(drawing.label)%></div></div> <% }); %> <div class="drawing clear fn-clear-drawings"><div><%=__(\'chart_drawings.clear\')%></div></div></div></div> <% }%> <% if (isDesktop && _.size(cursors) > 0) {%> <div class="btn fn-toolbar-cursors chart-toolbar-cursors" title="<%=__(\'chart.toolbar.tooltip.cursors\')%>"><i class="icon-chart-cursor"></i><div class="sub-menu left-side"> <% _.each(cursors, function (cursor) {%> <div class="cursor <%-cursor%> fn-change-cursor" data-cursor="<%-cursor%>" title="<%=__(\'chart_cursors.\' + cursor)%>"><div><%=__(\'chart_cursors.\' + cursor)%></div></div> <% }); %> </div></div> <% }%> <% if (isDesktop && _.size(rateLines) > 1) {%> <div class="btn fn-toolbar-rate-line chart-toolbar-rate-line" title="<%=__(\'chart.toolbar.tooltip.rate-lines\')%>"><i class="lines icon"></i><div class="sub-menu left-side"> <% _.each(rateLines, function (rateLine) {%> <div class="rateLine fn-change-rate-line" data-rate-line="<%-rateLine%>"><div><%=__(\'chart_rate_lines.\' + rateLine)%></div></div> <% }); %> </div></div> <% }%> </div><div class="sizes"> <% if (isDesktop) {%> <div class="btn fn-toolbar-screenshot chart-toolbar-screenshot" title="<%=__(\'chart.toolbar.tooltip.screenshot\')%>"><i class="icon-chart-screenshot"></i></div> <% }%> <% if (isEmbedded) {%> <div class="btn fn-toolbar-minimize chart-toolbar-minimize minimize" title="<%=__(\'chart.toolbar.tooltip.minimize\')%>"><i class="icon-chart-minimize"></i></div> <% }%> <div class="btn fn-toolbar-restore-size chart-toolbar-restore-size restore-size" title="<%=__(\'chart.toolbar.tooltip.restore_size\')%>"><i class="restore-size icon"></i></div><div class="btn fn-toolbar-fullscreen chart-toolbar-fullscreen fullscreen" title="<%=__(\'chart.toolbar.tooltip.fullscreen\')%>"><i class="icon-full-chart"></i></div></div>'},2785:function(t,e,i){(function(n,o){var s;void 0!==(s=function(t,e,n){var o=i(2064),s=i(5),r=i(0),a=i(2),l=i(15),c=i(7),h=i(14),u=i(2786),d=i(791),p=i(137),f=i(2627),g=i(158),v=g.getUiSelectedInstrumentCategorySymbol,y=void 0;n.exports=o.extend({className:"chart-panel",events:function(){return r.extend({},r.result(o.prototype,"events"),{"click .fn-chart-minimize":"minimize","click .fn-chart-restore-size":"restore"})},initialize:function(t){var e=this;y=i(413),this.options=r.extend({},t,this.loadLocalChartSettings(),{chartId:"main"});var n=null;!0===c.getApplicationSettings().get("deeplink")&&(c.getApplicationSettings().set("deeplink",!1),n=c.getApplicationSettings().get("chart")),p.isDetected()&&p.get("chart")&&(n=p.get("chart")),n&&r.extend(this.options,{period:n}),o.prototype.initialize.call(this,this.options),this.listenTo(a,"ui:instruments:instrument-selected",this.instrumentRowSelected),this.listenTo(a,"ui:instruments:instrument-subrow-selected",this.instrumentSubrowSelected),this.render(),this.$chartBox=this.$el.parent(),this.$chartSplitterBox=s(".chart-splitter-box"),this.$chartContainer=this.$el.find(".chart-container"),this.$fullscreenNotification=this.$el.find(".chart-fullscreen-notification"),this.tradingCentral=new u({el:this.$el.find(".chart-trading-central")},this.chart),this.initToolbar(),this.chartToolbar.show(),this.$buyButton=this.$el.find(".chart-panel .chart-buy tr")[0],this.$sellButton=this.$el.find(".chart-panel .chart-sell tr")[0],this.options.symbol?(this.onInstrumentSelected(this.options.symbol),delete this.options.symbol):this.instrument&&this.resubscribeChart(),l.mobile()&&l.portrait()&&window.innerHeight<500&&this.minimize(),this.instrumentRowSelected(v(store.getState())),this.comparisonMode&&(this.initComparisonInstruments(),r.each(this.options.comparison,function(t){var i=h.getInstrumentBySymbol(t);i&&i.isVisible()&&e.addComparisonInstrument(i.getSymbol())}))},minimize:function(){this.toggleMinimize()},restore:function(){this.restoreSize()},getLoadingContainer:function(){return this.$el.parent()},showSearch:function(){this.size.fullscreen&&o.prototype.showSearch.call(this)},initToolbar:function(){this.chartToolbar||(this.chartToolbar=new f({embedded:!0,comparisonMode:this.comparisonMode,parent:this.$el.find(".chart-header"),chartPanel:this,type:this.type,cursor:this.cursor,period:this.period,range:this.range,rateLine:this.rateLine}))},render:function(){this.template=r.template(i(2788)),this.$el.addClass("single"),o.prototype.render.call(this)},instrumentRowSelected:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{openPositionsSelected:!0,ordersSelected:!0,selectedSubRowsIds:[]},n=h.getInstrumentBySymbol(t);n&&this.onInstrumentSelected(t,n,{showTrades:y.getChartSettings().switchers.showTrades,showAllOpenPositions:i.openPositionsSelected,showAllOrders:i.ordersSelected,visibleTradesIds:i.selectedSubRowsIds})},instrumentSubrowSelected:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{openPositionsSelected:!1,ordersSelected:!1,selectedSubRowsIds:[]},n=h.getInstrumentBySymbol(t);n&&this.onInstrumentSelected(t,n,{showTrades:y.getChartSettings().switchers.showTrades,showAllOpenPositions:i.openPositionsSelected,showAllOrders:i.ordersSelected,visibleTradesIds:i.selectedSubRowsIds})},onChangePeriod:function(t){o.prototype.onChangePeriod.apply(this,arguments),this.savePeriod(t)},onChangeRange:function(t){o.prototype.onChangeRange.apply(this,arguments),this.saveRange(t)},enableComparisonMode:function(){var t=this;o.prototype.enableComparisonMode.apply(this,arguments),this.saveType(d.comparisonType),this.saveRange(this.range),this.comparisonMode&&r.each(this.loadLocalChartSettings().comparison,function(e){var i=h.getInstrumentBySymbol(e);i&&i.isVisible()&&t.addComparisonInstrument(i.getSymbol())})},disableComparisonMode:function(t,e){o.prototype.disableComparisonMode.apply(this,arguments),this.saveType(t),this.savePeriod(e)},addComparisonInstrument:function(t){o.prototype.addComparisonInstrument.apply(this,arguments),this.comparisonInstruments.contains(t)&&this.saveComparison(t,!0)},removeComparisonInstrument:function(t){o.prototype.removeComparisonInstrument.apply(this,arguments),this.saveComparison(t,!1)},onChangeType:function(t){o.prototype.onChangeType.apply(this,arguments),this.saveType(t)},onChangeRateLine:function(t){o.prototype.onChangeRateLine.apply(this,arguments),this.saveRateLine(t)},onChangeCursor:function(t){o.prototype.onChangeCursor.apply(this,arguments),this.saveCursor(t)},saveLocalChartSettings:function(t,e){var i=this.loadLocalChartSettings();i[t]=e,localStorage.setItem("chart_settings",JSON.stringify(i))},loadLocalChartSettings:function(){var t=localStorage.getItem("chart_settings");return t?JSON.parse(t):{}},saveType:function(t){this.saveLocalChartSettings("type",t)},savePeriod:function(t){this.saveLocalChartSettings("period",t)},saveRange:function(t){this.saveLocalChartSettings("range",t)},saveRateLine:function(t){this.saveLocalChartSettings("rateLine",t)},saveCursor:function(t){this.saveLocalChartSettings("cursor",t)},saveComparison:function(t,e){var i=localStorage.getItem("chart_settings");i=i?JSON.parse(i):{};var n=i.comparison||[],o=n.indexOf(t);e?o<0&&n.push(t):o>=0&&n.splice(o,1),i.comparison=n,localStorage.setItem("chart_settings",JSON.stringify(i))}})}.call(e,i,e,t))&&(t.exports=s)}).call(e,i(0),i(5))},2786:function(t,e,i){(function(n){var o;void 0!==(o=function(t,e,n){var o=i(12),s=(i(5),i(0)),r=i(2),a=i(6),l=i(15),c=(i(3),i(22)),h=i(7),u=i(119),d=i(30),p=s.template(i(2787)),f=s.template("<div class='tc-instrument-unavailable'><%=__('trading.central.unavailable.description')%></div>");n.exports=o.extend({events:function(){return s.extend({},s.result(o.prototype,"events"),{"click .fn-resize":"resize"})},minimized:!1,initialize:function(t,e){this.$el.addClass("tc"),this.chart=e,o.prototype.initialize.apply(this,arguments),this.listenTo(r,"stream:type:TRADING_CENTRAL",this._onTCDataReceived)},render:function(){this.$el.html(p(this.data)),this.$el.find(".tc-resistance > span").css("color",this.data.lines[0].colors[0]),this.$el.find(".tc-support > span").css("color",this.data.lines[1].colors[0]),this.$el.find(".tc-pivot > span").css("color",this.data.lines[2].colors[0])},updateChartSize:function(){r.trigger("ui:chart:update-size",-this.height),this.height=this.minimized?0:parseInt(this.$el.css("height")),r.trigger("ui:chart:update-size",this.height)},handleSize:function(){this.minimized?(this.$el.find(".tc-wrapper").css("display","none"),this.$el.find(".tc-button-wrapper").css("display","block")):(this.$el.find(".tc-wrapper").css("display","flex"),this.$el.find(".tc-button-wrapper").css("display","none")),this.updateChartSize()},resize:function(){this.minimized=!this.minimized,this.handleSize(),this.chart.reflow(),this.chart._redrawChart()},_onTCDataReceived:function(t){if(this.symbol===t.symbol){this.loadingTimeout&&clearTimeout(this.loadingTimeout),this.data=s.extend({},h.getUserCommonData().getTradingCentralSettings(),t),this.data.formattedTitle=__("trading.central.preference.title")+" "+__("trading.central.term."+this.data.term.toLowerCase())+" "+(this.data.pivot===this.data.resistance1?__("trading.central.preference.decline"):this.data.pivot===this.data.support1?__("trading.central.preference.rise"):"");var e=u.user;this.data.formattedDate=e.applyOffset(""+t.date+t.hour,"YYYYMMDDHH:mm","DD/MM/YYYY HH:mm")+" ("+e.GMTPostfix()+")",this.render(),this.updateChartSize(),this.handleSize(),this.chart.reflow(),this.chart.updateTradingCentral(this.data)}},_onDataUnavailable:function(){this.loadingView&&this.loadingView.destroy(),this.$el.html(f()),this.chart.reflow()},isTradingCentralEnabled:function(){return l.desktop()&&h.getUserAccountServices().isTradingCentralAvailable()&&h.getUserCommonData().isTradingCentralEnabled()},subscribe:function(t){var e=t.instrument,n=t.period;this.isTradingCentralEnabled()&&(this.symbol=e.getSymbol(),this.loadingView&&this.loadingView.destroy(),this.loadingView=new d({parent:this.$el,position:"relative",translucent:"2"}),this.chart.reflow(),this.loadingTimeout&&clearTimeout(this.loadingTimeout),this.loadingTimeout=setTimeout(this._onDataUnavailable.bind(this),1e4),a.unsubscribeTradingCentral(c.getAtmosphereId()).then(function(){a.subscribeTradingCentral(c.getAtmosphereId(),e.getSymbol(),i(413).getPeriod(n).seconds<=86400?"INTRADAY":"ST")}))},unsubscribe:function(){var t=this;this.clear(),s.isUndefined(this.symbol)||a.unsubscribeTradingCentral(c.getAtmosphereId()).then(function(){return t.symbol=void 0})},clear:function(){this.$el.empty(),r.trigger("ui:chart:update-size",-this.height),this.height=0,this.chart.reflow()},destroy:function(){o.prototype.destroy.call(this)}})}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(0))},2787:function(t,e){t.exports='<div class="tc-wrapper"><div class="tc-info"><div class="tc-header"><%=formattedTitle%></div><div><%=title%></div> <% _.each(paragraphs, function(paragraph){ %> <div><%=paragraph%></div> <% }) %> <div>(<%=formattedDate%>)</div></div><div class="tc-legend-full"><div class="tc-header"><%=__(\'trading.central.study.legend\')%></div><div class="tc-resistance"><%= __(\'trading.central.lines.extended.resistance\')%></div><div class="tc-support"><%= __(\'trading.central.lines.extended.support\')%></div><div class="tc-pivot"><%= __(\'trading.central.lines.extended.pivot\')%></div><button class="btn btn-default tc-minimize fn-resize"> <%=__(\'trading.central.button.minimize\')%><i></i></button></div></div><div class="tc-legend-short"></div><div class="tc-button-wrapper" style="display: none"><button class="btn btn-default tc-expand fn-resize"> <%=__(\'trading.central.button.expand\')%><i></i></button></div>'},2788:function(t,e){t.exports='<div class="chart-panel-content"><div class="chart-header"><div class="chart-info-wrapper fn-show-search"><div class="chart-search-button"></div><div class="chart-info"><div class="chart-title"></div><div class="chart-subtitle"></div></div><div class="chart-basket"><div class="chart-basket-title"></div><div class="chart-basket-info"></div></div></div></div><div class="chart-instruments-comparison-panel"></div><div class="chart-container"></div><div class="minimize-mobile fn-chart-minimize mobile"><i class="icon-double-arrow-down"></i></div><div class="chart-fullscreen-notification"> <%-__(\'chart.fullscreen_notification\')%> </div><div class="chart-trading-central"></div><div class="chart-search"><div class="chart-search-close fn-hide-search"><i class="icon-close-blue"></i></div><div class="chart-search-block-wrapper"></div></div></div><div class="chart-panel-content-minimized"><i class="expand icon fn-chart-restore-size hidden-xs"></i><a class="fn-chart-restore-size hidden-xs"><%=__(\'chart.expand_chart\')%></a><div class="expand restore-size-mobile fn-chart-restore-size hidden-sm hidden-md hidden-lg"><div><i class="icon-double-arrow-up"></i></div></div></div>'}});