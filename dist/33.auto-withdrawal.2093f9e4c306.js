webpackJsonp([33],{1915:function(t,e,i){var n;void 0!==(n=function(t,e,n){var a=i(2716),o=i(2723);n.exports={AutoWithdrawalView:a,AutoWithdrawalModel:o}}.call(e,i,e,t))&&(t.exports=n)},2146:function(t,e,i){var n;void 0!==(n=function(t,e,i){i.exports={DEFAULT:"DEFAULT",EMPTY:"EMPTY",LOADING:"LOADING",ERROR:"ERROR",SUCCESS:"SUCCESS",CONFLICT:"CONFLICT",SAVING:"SAVING",PROCESSING:"PROCESSING",REQUESTING:"REQUESTING",UPLOADING:"UPLOADING",CONFIRM:"CONFIRM",CONFIRMED:"CONFIRMED",ENABLED:"ENABLED",DISABLED:"DISABLED",YES:"YES",NO:"NO",ACCEPTED:"ACCEPTED",REFUSED:"REFUSED",ERROR_ENTITY_TOO_LARGE:"ERROR_ENTITY_TOO_LARGE",VALIDATE:"VALIDATE",VALIDATION:"VALIDATION",LOADING_DIALOG_TYPE:"LOADING_DIALOG_TYPE",CONFIRM_DIALOG_TYPE:"CONFIRM_DIALOG_TYPE",CLEAR_DIALOG:"CLEAR_DIALOG",SHOW:"SHOW",HIDE:"HIDE",NEW:"NEW",APPROVED:"APPROVED",COMPLETED:"COMPLETED",REJECTED:"REJECTED",CANCELED:"CANCELED",FUNDS_REMOVED:"FUNDS_REMOVED",PENDING_FUNDS_REMOVAL:"PENDING_FUNDS_REMOVAL",PENDING_CANCELLATION:"PENDING_CANCELLATION",WIRE_TRANSFER:"WIRE_TRANSFER",CREDIT_CARD:"CREDIT_CARD",PERIOD_CUSTOM:"custom",PERIOD_1_YEAR:"1year",PERIOD_3_MONTHS:"3months",PERIOD_1_MONTH:"1month",PERIOD_2_WEEKS:"2weeks",PERIOD_1_WEEK:"1week",PERIOD_ALL:"all",PERIOD_TODAY:"today",STATUS_IN_PROGRESS:"in_progress",STATUS_PROCESSED:"processed",STATUS_COMPLETED:"completed",STATUS_CANCELLED:"cancelled",STATUS_REJECTED:"rejected",STATUS_CANCELLING:"cancelling",STATUS_ALL:"all",WITHDRAW_AMOUNT_PATTERN:/^(0|[1-9]\d*)(\.|\.\d{1,2})?$/i}}.call(e,i,e,t))&&(t.exports=n)},2253:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(13),s=i(6),r=i(9),d=i(22),l=i(2146),u=l.SUCCESS,c=l.ERROR,h=l.LOADING,f=(l.PROCESSING,l.UPLOADING),m=l.ERROR_ENTITY_TOO_LARGE;n.exports=o.extend({defaults:function(){return{tabs:[],currentTabId:"",defaultTabId:"",conversionResult:{},bonuses:0}},europeanCountriesList:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","GF","DE","GI","GR","GP","GG","HU","IS","IE","IT","JE","LV","LI","LU","MT","MQ","YT","MC","NL","NO","PL","PT","RO","PM","SM","SK","SI","ES","SE","CH","GB"],supportableCandidates:["WIRE_TRANSFER","NET_TELLER","MONEY_BOOKERS"],getCurrentTab:function(){return a.findWhere(this.get("tabs"),{id:this.getCurrentTabId()})},getCurrentTabId:function(){var t=this.get("currentTabId");return t||(t=this.get("defaultTabId")),t},getCurrentTabName:function(){return this.getCurrentTab().name},getCurrentTabData:function(){var t=this.getCurrentTab(),e=null,i=null;return t&&(e=t.viewClass||e,i=t.modelClass||i),{view:e,model:i}},getTabById:function(t){return a.findWhere(this.get("tabs"),{id:t})},enableAllTabs:function(){a.each(this.get("tabs"),function(t){return t.disable=!1})},disableTabById:function(t){var e=this.getTabById(t);e&&(e.disable=!0)},enableTabById:function(t){var e=this.getTabById(t);e&&(e.disable=!1)},setCurrentTabById:function(t){var e=this.getTabById(t);return e&&this.set({currentTabId:e.id,currentTabName:e.name}),e},normalizeFormData:function(t){return a.chain(t).pairs().reduce(function(t,e){return t[String(e[0]).replace("field_","")]=e[1],t},{}).value()},setter:function(t){var e=this;return function(i){return e.set(t,i)}},checkAvailabilityOfFundsWithdrawal:function(){if(this.get("statusOfInfo")!==u)throw"Withdrawal info should be loaded."},status:function(t){var e=this;return function(i,n){var o={};o[t]=i,e.set(a.extend({},n,o))}},isAutomaticWithdrawalEnabled:function(){return r.isAutomaticWithdrawalEnabled()},loadInfo:function(){var t=this,e=this.status("statusOfInfo");e(h),s.loadWithdrawalInfo().then(function(e){return t.filterInfo(e.data)}).then(function(t){return e(u,{info:t})}).catch(function(t){return e(c)})},filterInfo:function(t){return this.isCompliance()?t:a.filter(t,function(t){return t.pendingAmount>0})},loadMethods:function(){var t=this,e=(i(7),this.status("statusOfMethods"));e(h),s.loadAllWithdrawalMethods().then(function(i){return e(u,{methods:t.filterMethods(i.data)})}).catch(function(t){return e(c)})},filterMethods:function(t){return a.isArray?a.uniq(t,function(t){return t.uniqueEntityId}):[]},isMethodsEmpty:function(){return a.isEmpty(this.get("methods"))},isMethods:function(){return!this.isMethodsEmpty()},getMethodById:function(t){return a.findWhere(this.get("methods"),{uniqueEntityId:Number(t)})||{}},uploadDocument:function(t,e,i,n){var a=this.status("statusOfUpload"),o=this.status("uploadProgress");if(a(f),o(0),!(t&&e&&i&&n))return a(c);var r=new FormData;r.append("doc",n,n.name);var d={onUploadProgress:function(t){var e=Math.round(100*t.loaded/t.total);o(e)}};s.uploadWithdrawalMethodFile(t,e,i,r,d).then(function(t){return a(u,{document:t.data})}).catch(function(t){if(413===t.response.status)return a(m);a(c)})},loadCountries:function(){var t=this.status("statusOfCountries");t(h),s.loadCountries().then(function(e){return t(u,{countries:e.data})}).catch(function(e){return t(c)})},loadBonuses:function(t){var e=this.status("statusOfBonuses");e(h,{bonuses:0}),s.loadActiveBonusesAmountForTradingAccount(t).then(function(t){return e(u,{bonuses:t.data})}).catch(function(t){return e(c)})},hasBonuses:function(){return this.get("bonuses")>0},loadCandidates:function(){var t=this,e=this.status("statusOfCandidates");e(h),s.loadWithdrawalCandidates().then(function(i){return e(u,{candidates:t.filterCandidates(i.data)})}).catch(function(t){return e(c)})},filterCandidates:function(t){var e=this;return a.filter(t,function(t){return a.contains(e.supportableCandidates,t.name)})},isCandidatesEmpty:function(){return a.isEmpty(this.get("candidates"))},getCandidateById:function(t){return a.findWhere(this.get("candidates"),{id:Number(t)})},isInfoEmpty:function(){return a.isEmpty(this.get("info"))},isCompliance:function(){var t=i(56);return t.COMPLIANCE_OR_COMPLIANCE_SUSPENDED()||t.LIMITED_COMPLIED()},isEuropean:function(t){var e=this,n=i(7),o=n.getUserData().getCrmboCustomer().country.toUpperCase(),s=["USD","GBP","NOK","SEK"],r=a.chain(this.get("countries")).map(function(t){if(a.contains(e.europeanCountriesList,t.code))return t.code}).compact().value();return t=String(t).toUpperCase(),a.contains(s,t)&&a.contains(r,o)},isFundsWithdrawalAvailable:function(){return a.some(this.get("info"),function(t){return t.amount>0||t.pendingAmount>0})},getMinWithdrawalAmount:function(t,e,i){var n=this.getMethodById(t);if(!n)return.01;var o=a.findWhere(n.paymentMethodCurrencies,{currency:e}),s=o&&o.minimumWithdrawalAmount,r=s||.01;return n.lastMoneyWdAllowed&&r>i?.01:r},loadConversion:function(t,e){var i=this.status("statusOfConversion"),n={};n[t+e]=1,n[e+t]=1,this.set("conversionResult",n),i(h);var a=function(t,e,i){return n[t+e]=Number(i.data)||1,n},o=function(t,e){s.conversion(d.getAtmosphereId(),t,e).then(function(i){return a(u,a(t,e,i))}).catch(function(t){return i(c)})};o(t,e),o(e,t)}})}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2385:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(79),s=i(40),r=i(10),d=r.PLATFORM_PREFIX,l=r.CURRENCY_EUR,u=i(2146),c=u.CREDIT_CARD,h=function(t,e){return{disable:arguments.length>2&&void 0!==arguments[2]&&arguments[2],template:o.file,name:"field_doc",description:e,title:__("upload_documents.popup.other.select_file"),validation:{rules:{not_empty:function(t){return!!t.field_doc||__("errors.required",__("fields.file"))}}}}},f=function(t){var e=__("fields.email");return{disable:!1,template:o.inputBox,savedData:t.get("field_email"),title:e,name:"field_email",translationKey:"",validation:{rules:{not_empty:__("errors.required",e),email:__("errors.invalid",e)}}}},m=function(t){return{disable:!1,template:o.textArea,title:__("fields.comment"),savedData:t.get("field_comment"),name:"field_comment",translationKey:"",settings:{rows:4,cols:10}}},v=function(t,e,i,n,a){return{disable:!1,template:o.radio,label:e,name:i,items:n,tooltip:a}},p=function(t){var e=__("fields.beneficiary_name");return{disable:!1,template:o.inputBox,title:e,savedData:t.get("field_beneficiaryName"),name:"field_beneficiaryName",translationKey:"",validation:{rules:{not_empty:__("errors.required",e)}}}},_=function(t,e,i,n,a,s){return{disable:!1,template:n?o.inputAddon:o.inputBox,title:i,name:e,translationKey:"",type:a,addonText:"$",validation:s||{rules:{not_empty:__("errors.required",i)}}}},E=function(t,e,i,n){return{disable:!1,template:o.selectBox,title:i,name:e,savedData:t.get("selectedDefaultCountry"),options:a.isEmpty(t.get(n))?[]:a.filter(t.get(n),function(t){return!a.contains(["0"],t.phoneCode)}),transformOptionsValue:function(t){return t.code},transformOptionText:function(t){return __("country.name."+t.code)},translationKey:"",validation:{rules:{not_empty:__("errors.required",i)}}}},g=function(t,e){var i=__("auto.withdrawal.trading_account");return{disable:!1,template:o.selectBox,title:i,name:"field_platformAccountId",savedData:a.first(t.get(e)).platformAccountId,options:t.get(e),transformOptionsValue:function(t){return t.platformAccountId},transformOptionText:function(t){var e=(t.userName,t.platformAccountId),i=t.tradePlatformType,n=t.currency,a=s.tradePlatformIds2NameMap[i];return(a=a===d?__("brand.name"):a)+" Trader - "+e+" - "+String(n).toUpperCase()},translationKey:"",validation:{rules:{not_empty:__("errors.required",i)}}}},C=function(t,e){var i=void 0;return e.selected&&(i=t.get(e.selected)||i),{disable:!1,template:o.selectBox,title:e.title,name:e.name,savedData:i,options:t.get(e.attrName),transformOptionsValue:e.customValue?e.customValue:function(t){return t[e.valueKey||"id"]},transformOptionText:e.customText?e.customText:function(t){return t[e.textKey||"text"]},translationKey:"",validation:e.validation,minDate:e.minDate,maxDate:e.maxDate}},w=function(t,e){var i=void 0;return e.selected&&(i=t.get(e.selected)||i),{disable:!1,template:o.datepicker,title:e.title,name:e.name,savedData:i,transformOptionsValue:e.customValue?e.customValue:function(t){return t[e.valueKey||"id"]},transformOptionText:e.customText?e.customText:function(t){return t[e.textKey||"text"]},translationKey:"",validation:e.validation}},T=function(t,e,i){var n=__("auto.withdrawal.select_method"),a=void 0;return i&&(a=t.get(i)||a),{disable:!1,template:o.selectBox,title:n,name:"field_methodId",savedData:a,options:t.get(e),transformOptionsValue:function(t){return t.uniqueEntityId},transformOptionText:function(t){var e=(t.paymentMethodName,t.methodType),i=t.accountId,n=t.last4Digits,a=t.email,o=t.accountNumber,s=t.iBan,r=t.creditCardType,d={NET_TELLER:i,MONEY_BOOKERS:a,PAY_PAL:a,CREDIT_CARD:n,WIRE_TRANSFER:o||s};return e===c?__("payment_methods.format.CREDIT_CARD",r||__("payment_methods.name.CREDIT_CARD"),n):__("payment_methods.format."+e,d[e])},translationKey:"",validation:{rules:{not_empty:__("errors.required",n)}}}},x=function(t){return{form:[[g(t,"accountsToManage")]]}},O=function(t){return{form:[[{disable:!1,template:o.selectBox,title:__("auto.withdrawal.select_method"),name:"field_methodTypeId",options:t.get("candidates"),transformOptionsValue:function(t){return t.id},transformOptionText:function(t){return __("payment_methods.name."+t.name)},translationKey:""}]]}},b=function(t){return{form:[[g(t,"info")]]}},I=function(t){return{form:[[T(t,"methods","selectedPaymentId")]]}},y=function(t){return{form:[[_(0,"field_amount",__("fields.amount"),"$","text",{filters:["trim","number"],rules:{not_empty:__("auto.withdrawal.form.errors.amount.required"),min_gt:[0,__("auto.withdrawal.form.errors.amount.min")]}})]]}},A=function(t){return{form:[[h(t,__("auto.withdrawal.revoke.file.note"),!0)]]}},D=function(t){return{form:[[v(0,__("convert.amount"),"field_currency",[{text:t.get("tradeAccountCurrency"),value:t.get("tradeAccountCurrency")},{text:l,value:l,checked:!0}],__("convert.amount.tooltip"))]]}},N=function(t){return{form:[[C(t,{defaultAttrName:"",title:"",name:"field_period",attrName:"periods",customValue:function(t){return t.id},customText:function(t){return t.text},selected:"selectedPeriod",valueKey:"value",textKey:"text"})]]}},R=function(t){return{form:[[w(t,{defaultAttrName:"",name:"field_periodBegin",selected:"field_periodBegin",maxDate:+new Date})]]}},S=function(t){return{form:[[w(t,{defaultAttrName:"",name:"field_periodEnd",selected:"field_periodEnd",maxDate:+new Date})]]}},F=function(t){return{form:[[C(t,{defaultAttrName:"",title:"",name:"field_status",attrName:"statuses",customValue:function(t){return t.id},customText:function(t){return t.text},selected:"selectedStatus",valueKey:"value",textKey:"text"})]]}},L=function(t){return{form:[[f(t),p(t),m(t),h(t,__("auto.withdrawal.upload.desc",__("payment_methods.name.MONEY_BOOKERS")))]]}},M=function(t){return{form:[[_(0,"field_accountId",__("fields.neteller_id")),p(t),m(t),h(t,__("auto.withdrawal.upload.desc",__("payment_methods.name.NET_TELLER")))]]}},P=function(t){return{form:[[_(0,"field_bankName",__("fields.bank_name")),_(0,"field_bankAddress",__("fields.bank_address")),E(t,"field_bankCountry",__("fields.bank_country"),"countries"),_(0,"field_accountNumber",__("fields.account_number")),_(0,"field_iban","IBAN"),_(0,"field_swift","SWIFT"),p(t),m(t),h(t,__("auto.withdrawal.upload.desc.WIRE_TRANSFER"))]]}};n.exports={tradingAccountForm:x,MONEY_BOOKERS:L,NET_TELLER:M,WIRE_TRANSFER:P,accountsForm:b,methodsForm:I,amountForm:y,selectCandidateForm:O,documentForm:A,convertForm:D,periodForm:N,periodBeginForm:R,periodEndForm:S,statusesForm:F}}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2716:function(t,e,i){(function(n,a){var o;void 0!==(o=function(t,e,n){var a=i(0),o=i(2),s=i(5),r=i(80),d=a.template(i(2717)),l=i(2718),u=i(2720),c=i(30),h=(i(55),i(2146)),f=h.CONFIRM_DIALOG_TYPE,m=h.LOADING_DIALOG_TYPE,v=h.MESSAGE_DIALOG_TYPE,p=(h.SHOW,h.HIDE),_=h.CLEAR_DIALOG,E=h.SUCCESS,g=h.ERROR,C=r.extend({className:"funds-withdrawal",name:"funds-withdrawal",events:function(){return this.addEvents(r)({"click .fn-tab":"changeTab"})},initialize:function(t){r.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:currentTabId",this.updateTab),this.listenTo(o,"funds-withdrawal:withdrawal:dialog",this.modalDialog),this.listenTo(o,"funds-withdrawal:withdrawal:state",this.updateState),this.listenTo(o,"funds-withdrawal:close",this.close),this.listenTo(this.model,"change:statusOfInfo",this.loadCompleted),this.render()},render:function(){return r.prototype.render.call(this),this.setContent(d({options:this.options,model:this.model.toJSON(),isFundsWithdrawalAvailable:this.model.isFundsWithdrawalAvailable()})),this},updateTab:function(){var t=this.model,e=t.getCurrentTabData(),i=e.view,n=e.model,a=t.getCurrentTabId();this.addChildView(".tab-content",i,{model:new n({selectedPaymentId:t.get("selectedPaymentId"),isCompliance:t.get("isCompliance"),pendingDeposits:t.get("pendingDeposits")})}),this.$(".header-container-xs .caption").html(__(t.getCurrentTabName())),this.$(".tab").removeClass("active"),this.$(".tab[data-tab-id="+a+"]").addClass("active")},changeTab:function(t){this.model.setCurrentTabById(s(t.currentTarget).attr("data-tab-id"))},updateState:function(t){this.model.set(t)},loadCompleted:function(){var t=this,e=this.model,i=e.get("statusOfInfo");if(i==g)return this.loadError();i==E&&(this.render(),e.isFundsWithdrawalAvailable()?this.updateTab():this.addChildView(".funds-withdrawal-content",l,{text:__("auto.withdrawal.no_funds"),buttonText:__("actions.deposit"),onClose:function(){return t.close()}}))},loadError:function(){this.modalDialog({type:v,title:__("auto.withdrawal.error"),text:__("auto.withdrawal.error.text")})},clickOnDepositFunds:function(){this.close(),o.trigger("ui:deposit")},modalDialog:function(t){var e=this,n=".modal-dialog-container",s=t.type,r=this.$(n),d=function(t){return r.css("display",t)},l=function(){return e.removeChildView(n)};switch(s){case _:d("none"),this.removeChildView(n);break;case v:d("block"),this.addChildView(n,u,{parent:r,title:t.title,text:t.text,template:a.template(i(2722)),final:function(){d("none"),l()}});break;case m:if(t.action==p){d("none"),l();break}if(this.prevType==s)break;d("block"),this.addChildView(n,c,{translucent:"no"});break;case f:o.trigger("ui:confirm",{parent:this.$(n),title:t.title,text:t.text,textYes:__("yes"),textNo:__("no"),yes:function(){return t.yes()},no:function(){return t.no()}})}this.prevType=s}});n.exports=C}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(0),i(5))},2717:function(t,e){t.exports='<div class="popup-header popup-header-bg-style-grey popup-header-style-default hidden-xs"><div class="popup-caption flex flex-valign-center"><span><span class="color-platform-text-color"><%= __(\'withdraw.title\') %></span></span></div><div class="popup-actions fn-close-popup btn"><i class="icon-close-blue"></i></div></div><div class="visible-xs header-container-xs"><div class="left flex fn-close-popup flex-valign-center btn"><div class="icon arrow"></div><b><%-__(\'actions.back\') %></b></div><div class="caption flex flex-valign-center flex-align-center"> <%-model.currentTabName || model.currentTabNameMobile%> </div><div class="right flex flex-valign-center btn"></div></div><div class="funds-withdrawal-content"><div class="modal-dialog-container"></div> <% if (isFundsWithdrawalAvailable) { %> <div class="tabs flex flex-row flex-align-start hidden-xs"> <% _.each(model.tabs, function(v) { %> <div class="tab fn-tab flex flex-stretch flex-valign-center active <%- model.currentTabId == v.id ? \'active\' : \'\' %>" data-tab-id="<%- v.id %>"><%- v.name %></div> <% }) %> </div><div class="tab-content"></div> <% } %> </div>'},2718:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(12),o=i(0),s=i(2),r=i(9),d=o.template(i(2719));n.exports=a.extend({className:"withdrawal-not-available",events:function(){return this.addEvents(a)({"click .btn":"buttonClick"})},render:function(){return a.prototype.render.call(this),this.$el.html(d({options:this.options,settings:r})),this},buttonClick:function(){s.trigger("ui:deposit"),this.options.onClose(),this.destroy()}})}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2719:function(t,e){t.exports='<div class="funds-withdrawal-body"><strong><%=options.text%></strong></div><div class="funds-withdrawal-actions"><div class="footer flex flex-row flex-valign-center"> <% if (settings.isLiveChatEnabled()) { %> <div class="flex-stretch"> <%=__(\'help.need_help\')%> <a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div> <% } %> <div><button class="btn btn-primary"><%-options.buttonText%></button></div></div></div>'},2720:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(12),s=a.template(i(2721)),r=(i(3),i(31),i(7),i(5),o.extend({className:"custom-confirm flex flex-column flex-align-center flex-valign-center",events:function(){return this.addEvents(o)({"click .fn-yes":"yes","click .fn-no":"no"})},initialize:function(){o.prototype.initialize.apply(this,arguments)},render:function(){o.prototype.render.call(this);var t=this.options.template||s;return this.$el.html(t(this.options)),this},yes:function(t){t.preventDefault(),this.destroy(),this.handle("yes"),this.handle("final")},no:function(t){t.preventDefault(),this.destroy(),this.handle("no"),this.handle("final")},handle:function(t){var e=this.options[t];a.isFunction(e)&&e()}}));n.exports=r}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2721:function(t,e){t.exports='<div class="modal-dialog-panel flex flex-column flex-align-center flex-valign-center custom-confirm"><div class="title"><%=title%></div><div class="text"><%=text%></div><div class="flex actions"><button class="btn btn-primary fn-yes"><%-__(\'yes\')%></button> <button class="btn btn-secondary fn-no"><%-__(\'no\')%></button></div></div>'},2722:function(t,e){t.exports='<div class="modal-dialog-panel flex flex-column flex-align-center flex-valign-center custom-confirm"><div class="title"><%=title%></div><div class="text"><%=text%></div><div class="flex actions"><button class="btn btn-primary fn-yes"><%-__(\'ok\')%></button></div></div>'},2723:function(t,e,i){var n;void 0!==(n=function(t,e,n){var a=(i(0),i(13),i(2724)),o=i(2726),s=i(2727),r=i(2731),d=i(2732),l=i(2735),u=i(2253);n.exports=u.extend({defaults:function(){var t=__group("auto.withdrawal.tab."),e=i(56);return{tabs:[{id:"withdrawal",name:t("withdrawal"),viewClass:a,modelClass:o},{id:"methods",name:t("manage"),viewClass:d,modelClass:l},{id:"statuses",name:t("statuses"),viewClass:s,modelClass:r}],currentTabId:"withdrawal",defaultTabId:"withdrawal",selectedPaymentId:0,isCompliance:e.COMPLIANCE_OR_COMPLIANCE_SUSPENDED()||e.LIMITED_COMPLIED(),pendingDeposits:e.PENDING_DEPOSIT()}},initialize:function(){this.loadInfo()}})}.call(e,i,e,t))&&(t.exports=n)},2724:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(30),s=i(836),r=i(2385),d=i(2),l=i(7),u=i(9),c=a.template(i(2725)),h=i(2146),f=h.EMPTY,m=h.LOADING,v=h.ERROR,p=h.SUCCESS,_=h.MESSAGE_DIALOG_TYPE,E=h.NO,g=h.YES,C=h.VALIDATE,w=h.PROCESSING,T=h.LOADING_DIALOG_TYPE,x=(h.CONFIRM_DIALOG_TYPE,h.CLEAR_DIALOG),O=h.WIRE_TRANSFER,b=h.WITHDRAW_AMOUNT_PATTERN,I=function(t){return d.trigger("funds-withdrawal:withdrawal:dialog",t)},y=function(t,e,i){return d.trigger("ui:message-box",{translucent:"3",additionalClassName:"fluid-button",caption:t,text:e,onClose:i})},A=s.extend({events:function(){return this.addEvents(s)({"click .footer .btn":"doWithdraw","click .fn-add-method":"addMethod"})},className:"withdrawal",initialize:function(){s.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:statusOfInfo",this.loadCompleted),this.listenTo(this.model,"change:statusOfMethods",this.loadCompleted),this.listenTo(this.model,"change:statusOfCountries",this.loadCompleted),this.listenTo(this.model,"change:statusOfWithdraw",this.onStatusOfWithdrawChanged),this.listenTo(this.model,"change:readyToExecute",this.onReadyToExecuteChanged),this.listenTo(this,"form:accountsForm:change:field_platformAccountId",this.onAccountChanged),this.listenTo(this,"form:methodsForm:change:field_methodId",this.onMethodChanged),this.listenTo(this,"form:amountForm:change:field_amount",this.onAmountChanged),this.listenTo(this,"form:convertForm:change:field_currency",this.onCurrencyChanged),this.formConfigs=r},render:function(){s.prototype.render.call(this);var t=__group("auto.withdrawal.");return this.$el.html(c({model:this.model.toJSON(),textInfo:t("info"),textNote:__("auto.withdrawal.note",__("legal_documents.popup.terms_and_conditions")),settings:u})),this.onReadyToExecuteChanged(),this.addChildView(".funds-withdrawal-body",o,{parent:this.$el,translucent:"2"}),this},onAccountChanged:function(){this.model.loadBonuses(this.getAccountsField().value()),this.amount=null,this.update()},onMethodChanged:function(){this.amount=null,this.update()},onAmountChanged:function(){var t=this.getAmountField().value();b.test(t)?this.lastValidValue=t:(this.lastValidValue&&""!==t||(this.lastValidValue=""),""!==t&&this.getAmountField().value(this.lastValidValue)),this.amount=Number(t),this.baseConvertCurrency=this.getConvertField().value()},getConvertField:function(){return this.getFormField("convertForm","field_currency")},getAccountsField:function(){return this.getFormField("accountsForm","field_platformAccountId")},getAmountField:function(){return this.getFormField("amountForm","field_amount")},getSelectedAccountInfo:function(){return this.model.getAccountByPlatformAccountId(this.getAccountsField().value())},onReadyToExecuteChanged:function(){var t=this.$(".footer .btn");this.model.get("readyToExecute")===g?t.removeAttr("disabled"):t.attr("disabled",!0)},loadError:function(){this.removeChildView(".funds-withdrawal-body"),I({type:_,title:__("auto.withdrawal.error"),text:__("auto.withdrawal.error.text")})},doWithdraw:function(){if(!this.model.isFundsWithdrawalAvailable())return d.trigger("funds-withdrawal:close"),void d.trigger("ui:deposit");this.model.set("statusOfWithdraw",C)},onStatusOfInfoChanged:function(){switch(this.model.get("statusOfInfo")){case f:case m:break;case v:this.loadError()}},onStatusOfWithdrawChanged:function(){var t=this.model,e=t.get("statusOfWithdraw"),i=__group("auto.withdrawal.submit."),n=t.get("pendingDeposits"),o=this.$(".footer .btn"),s=function(t){d.trigger("ui:confirm",{title:__("auto.withdrawal.bonus.confirm.title"),text:__("auto.withdrawal.bonus.confirm.text"),yes:t,no:a.noop})};switch(e){case C:t.set("statusOfWithdraw",f);var r=this.getForm("accountsForm").validate(),l=this.getForm("amountForm").validate(),u=this.getAccountsField().value(),c=t.getAccountByPlatformAccountId(u).currency,h=this.getFormField("amountForm","field_amount").value(),m=this.getFormField("methodsForm","field_methodId").value(),_=t.getMethodById(m),E=this.getSelectedAccountInfo(),g=t.isEuropean(E.currency),b=t.hasBonuses();if(g&&_.methodType===O&&(c=this.getFormField("convertForm","field_currency").value()),n){if(r||l)return;var A=t.getTheOldestMethodId();return b?void s(function(){return t.withdraw(u,A,c,h)}):void t.withdraw(u,A,c,h)}var D=this.getForm("methodsForm").validate();if(r||D||l)return;return b?void s(function(){return t.withdraw(u,m,c,h)}):void t.withdraw(u,m,c,h);case w:return I({type:T}),void o.attr("disabled",!0);case p:return this.amount=null,this.destroyForm("accountsForm"),this.destroyForm("methodsForm"),this.destroyForm("amountForm"),this.destroyForm("convertForm"),t.reload(),I({type:x}),y(i("success"),i("success.text")),d.trigger("funds:withdrawal:success"),void o.attr("disabled",!1);case v:return void this.onResultOfWithdrawalError(i)}},onResultOfWithdrawalError:function(t){I({type:x});var e=this.model.get("resultOfWithdrawal");"margin_call_risk"===e.error||"withdrawal.error.available_amount"===e.error?y(__("auto.withdrawal.submit.error.available_amount.title"),l.hasOpenPositions()?__("auto.withdrawal.submit.error.available_amount.open_positions.text"):__("auto.withdrawal.submit.error.available_amount.no_open_positions.text")):"restrict_profit_refunds"===e.error?y(__("auto.withdrawal.submit.error"),__("auto.withdrawal.submit.restrict_profit_refunds")):y(t("error"),t("error.text"))},addMethod:function(t){t.preventDefault(),d.trigger("funds-withdrawal:withdrawal:state",{currentTabId:"methods"})},loadCompleted:function(){var t=this.model,e=t.get("statusOfMethods"),i=t.get("statusOfInfo"),n=t.get("statusOfCountries"),o=this.$(".accounts-form"),s=this.$(".methods-form"),r=this.$(".amount-form"),d=this.$(".convert-form");if(a.some([e,i,n],function(t){return t===v}))return this.loadError();if(a.every([e,i,n],function(t){return t===p})){if(this.removeChildView(".funds-withdrawal-body"),!t.isFundsWithdrawalAvailable())return o.html(__("auto.withdrawal.no_funds")),this.$(".btn-primary").html(__("actions.deposit")),void t.set("readyToExecute",g);this.createForm("accountsForm",o),this.createForm("methodsForm",s),this.createForm("amountForm",r);var l=this.getFormField("accountsForm","field_platformAccountId"),u=l.value(),c=t.getAccountByPlatformAccountId(u),h=String(c.currency).toUpperCase();t.set("tradeAccountCurrency",h),this.createForm("convertForm",d),this.update(),t.loadBonuses(u)}},update:function(){var t=this.model,e=this.$(".accounts-form"),i=this.$(".methods-form"),n=this.$(".amount-form"),o=this.$(".convert-form"),s=this.getFormField("methodsForm","field_methodId"),r=this.getAmountField(),d=function(t){return t.css("display","block")},l=function(t){return t.css("display","none")},u=t.isCompliance(),c=this.getSelectedAccountInfo(),h=t.isEuropean(c.currency),f=String(c.currency).toUpperCase(),m=c.pendingAmount,v=s.value(),p=t.getMethodById(v),_=r.$el.find(".field-addonText"),C=c.amount-t.get("bonuses"),w=t.getMinWithdrawalAmount(v,f,C);t.set("tradeAccountCurrency",f),this.baseConvertCurrency=f,this.destroyForm("convertForm"),this.createForm("convertForm",o);var T=this.getFormField("convertForm","field_currency");if(d(e),d(i),d(n),l(o),r.$el.removeClass("field-error"),r.value(""),r.$el.find(".content").html(""),r._rules=a.extend(r._rules,{min:[w,__("auto.withdrawal.form.errors.amount.min")]}),_.html(__currency(f)),!u)return l(i),r.disable(),r.value(m),r.$el.find(".content").html(__("auto.withdrawal.submit.pending_deposit")),void t.set("readyToExecute",g);var x=s.$el.find(".field-type-select label");if(x.find("a").remove(),x.append('<a href="#" class="fn-add-method" style="float: right"> + '+__("auto.withdrawal.add_method")+"</a>"),a.isEmpty(v)?(r.disable(),t.set("readyToExecute",E)):(r.enable(),t.set("readyToExecute",g)),m&&(r.disable(),r.value(m),l(i),r.$el.find(".content").html(__("auto.withdrawal.submit.pending_deposit")),l(o),t.set("readyToExecute",g)),h&&!m&&p.methodType===O){var b=T.value(),I=f;this.baseConvertCurrency=b,_.html(__currency(b)),this.prevCurrencyConversion!==b+I&&this.model.loadConversion(b,I),this.prevCurrencyConversion=b+I,d(o),T.trigger("change",T,b)}},onCurrencyChanged:function(t,e){var i=this.getConvertField(),n=this.getSelectedAccountInfo(),o=i.value();String(n.currency).toUpperCase();this.getAmountField().$el.find(".field-addonText").html(__currency(i.value()));var s=this.model.get("conversionResult"),r="";if(this.baseConvertCurrency!==o&&this.amount){var d=s[this.baseConvertCurrency+o];r=Number(this.amount)*d,r=Number(Number(r).toFixed(2))}else r=this.amount||"";this.getAmountField().value(a.isNumber(r)?r:"")}});n.exports=A}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2725:function(t,e){t.exports='<div class="funds-withdrawal-body flex flex-column"><div class="note"><%=textInfo%></div><div class="forms-container flex flex-column flex-stretch"><div class="flex flex-column flex-stretch min-height-content"><div class="accounts-form"></div><div class="methods-form"></div><div class="amount-form"></div><div class="convert-form"></div></div><div class="note"> <% if (settings.isLiveChatEnabled()) { %> <div class="col help large visible-xs"> <%=__(\'help.need_help\')%> <a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a><br><br></div> <% } %> <div class="col help"> <%=textNote%> </div></div></div><div class="funds-withdrawal-actions flex flex-align-start flex-valign-center"><div class="footer grid-middle_xs-1"><div class="col"><button class="btn btn-primary"><%- __(\'auto.withdrawal.actions.withdraw\') %></button></div> <% if (settings.isLiveChatEnabled()) { %> <div class="col help hidden-xs"><div class="flex flex-align-end"> <%=__(\'help.need_help\')%> <a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div></div> <% } %> </div></div></div>'},2726:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(2253),o=i(6),s=i(0),r=i(2146),d=r.EMPTY,l=r.SUCCESS,u=r.ERROR,c=r.PROCESSING,h=(r.YES,r.NO);n.exports=a.extend({defaults:function(){return{readyToExecute:h,statusOfInfo:d,statusOfMethods:d,statusOfWithdraw:d,statusOfConversion:d,bonuses:0}},initialize:function(){this.load()},reload:function(){this.load()},load:function(){this.loadInfo(),this.loadMethods(),this.loadCountries()},withdraw:function(t,e,i,n){var a=this.status("statusOfWithdraw");if(!t||!i||!n)return a(u);this.get("statusOfWithdraw")!==c&&(a(c),o.submitWithdrawal(t,e,i,n).then(function(t){return a(l)}).catch(function(t){return a(u,{resultOfWithdrawal:t.response.data})}))},getAccountByPlatformAccountId:function(t){return s.findWhere(this.get("info"),{platformAccountId:t})||{}},isMethodsEmpty:function(){return s.isEmpty(this.get("methods"))},getTheOldestMethodId:function(){var t=s.chain(this.get("methods")).sort(function(t){return t.uniqueEntityId}).first().value();return t&&t.uniqueEntityId}})}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2727:function(t,e,i){(function(n,a){var o;void 0!==(o=function(t,e,n){var a=i(0),o=i(836),s=a.template(i(2728)),r=a.template(i(2729)),d=a.template(i(2730)),l=i(30),u=i(3),c=i(31),h=i(7),f=i(5),m=(i(55),i(2)),v=i(2385),p=i(40),_=i(9),E=i(2146),g=E.EMPTY,C=E.LOADING,w=E.ERROR,T=E.SUCCESS,x=E.NEW,O=E.APPROVED,b=E.COMPLETED,I=E.REJECTED,y=E.CANCELED,A=E.FUNDS_REMOVED,D=E.PENDING_FUNDS_REMOVAL,N=E.PENDING_CANCELLATION,R=E.CONFIRM,S=(E.CONFIRMED,E.CANCELLING),F=E.CONFIRM_DIALOG_TYPE,L=(E.LOADING_DIALOG_TYPE,E.PERIOD_CUSTOM),M=E.PERIOD_1_YEAR,P=E.PERIOD_3_MONTHS,G=E.PERIOD_1_MONTH,U=E.PERIOD_2_WEEKS,k=E.PERIOD_1_WEEK,V=E.PERIOD_ALL,W=E.PERIOD_TODAY,B=E.STATUS_IN_PROGRESS,Y=E.STATUS_PROCESSED,$=E.STATUS_COMPLETED,q=E.STATUS_CANCELLED,K=E.STATUS_REJECTED,z=E.STATUS_CANCELLING,H=(E.STATUS_ALL,function(t,e){return m.trigger("ui:message-box",{translucent:"3",additionalClassName:"fluid-button",caption:t,text:e})}),J=o.extend({className:"statuses",events:function(){return this.addEvents(o)({"click .fn-cancel-request":"cancelRequest"})},initialize:function(){o.prototype.initialize.apply(this,arguments);var t=this.model;this.listenTo(t,"change:status",this.render),this.listenTo(t,"change:statusOfCancelRequest",this.onStatusOfCancellingRequest),this.listenTo(t,"change:statusOfPeriod",this.onStatusOfPeriodChanged),this.listenTo(this,"form:periodForm:change:field_period",this.onPeriodChanged),this.listenTo(this,"form:periodBeginForm:change:field_periodBegin",this.onPeriodBeginChanged),this.listenTo(this,"form:periodEndForm:change:field_periodEnd",this.onPeriodEndChanged),this.listenTo(this,"form:statusesForm:change:field_status",this.onFilterByStatusChanged),this.formConfigs=v},render:function(){o.prototype.render.call(this);try{this.$el.html(s({SUCCESS:T,items:this.model.get("items"),model:this.model.toJSON(),settings:_}))}catch(t){}return this.onStatusChanged(),this},renderItems:function(){var t=__group("auto.withdrawal.statuses.column.");this.$(".table-container").html(r({items:this.getItems(),SUCCESS:T,APPROVED:O,COMPLETED:b,REJECTED:I,CANCELED:y,NEW:x,FUNDS_REMOVED:A,PENDING_FUNDS_REMOVAL:D,PENDING_CANCELLATION:N,symbol:h.getUserCurrencySymbol(),moment:u,statusTemplate:d,selectedFilter:this.model.get("selectedStatus"),selectedPeriod:this.model.get("selectedPeriod"),textDate:t("date"),textAccount:t("account"),textMethod:t("method"),textAmount:t("amount"),textStatus:t("status"),textFormatMethod:function(t){var e="payment_methods.name."+t,i=__(e);return e===i?t:i},formatDate:function(t){var e=t.creationDate,i=e.year,n=e.monthValue,a=e.dayOfMonth;return u({year:i,month:n-1,day:a}).format("DD/MM/YYYY")},formatAccount:function(t){var e=t.account,i=e.userName,n=(e.platformAccountId,e.tradePlatformType),a=t.requestedCurrency,o=p.tradePlatformIds2NameMap[n];return(o="COSMOS"===o?__("brand.name"):o)+" Trader - "+i+" - "+String(a).toUpperCase()},formatAmount:function(t){return c(t.amount).formatForeignCurrency(__currency(t.requestedCurrency),"$0,0.[00]")}}))},onPeriodChanged:function(){var t=this.$(".period-begin-form"),e=this.$(".period-end-form"),i=this.getFormField("periodForm","field_period").value();this.model.set("selectedPeriod",i),this.hide(t),this.hide(e),"custom"===i&&(this.show(t),this.show(e)),this.renderItems()},getItems:function(){var t=this.model.get("items");if(a.isEmpty(t))return[];var e=a.chain(t),i=this.getFormField("periodForm","field_period").value(),n="YYYYMMDD",o=Number(u().format(n)),s=Number(u().year(-1).format(n)),r=Number(u().month(-3).format(n)),d=Number(u().month(-1).format(n)),l=Number(u().weekday(-14).format(n)),c=Number(u().weekday(-7).format(n)),h=function(t){var e=t.creationDate,i=e.year,a=e.monthValue,o=e.dayOfMonth;return Number(u({year:i,month:a-1,day:o}).format(n))},f=this.model.get("selectedStatus");switch(i){case L:var m=this.getFormField("periodBeginForm","field_periodBegin").getFirstSelectedDate(),v=this.getFormField("periodEndForm","field_periodEnd").getFirstSelectedDate(),p=m&&Number(u(m).format(n)),_=v&&Number(u(v).format(n));e=e.filter(function(t){var e=h(t);return p&&_?e>=p&&e<=_:p&&!_?e>=p:!(p||!_)&&e<=_});break;case M:e=e.filter(function(t){return h(t)>=s});break;case P:e=e.filter(function(t){return h(t)>=r});break;case G:e=e.filter(function(t){return h(t)>=d});break;case U:e=e.filter(function(t){return h(t)>=l});break;case k:e=e.filter(function(t){return h(t)>=c});break;case V:break;case W:e=e.filter(function(t){return h(t)===o})}switch(f){case B:e=e.filter(function(t){return a.contains([x,A,D],t.status)});break;case Y:e=e.filter(function(t){return O===t.status});break;case $:e=e.filter(function(t){return b===t.status});break;case q:e=e.filter(function(t){return y===t.status});break;case K:e=e.filter(function(t){return I===t.status});break;case z:e=e.filter(function(t){return N===t.status})}return e.value()},onStatusChanged:function(){var t=this.model,e=t.get("status"),i=".funds-withdrawal-body",n=__group("auto.withdrawal."),a=this.$(".period-form"),o=this.$(".period-begin-form"),s=this.$(".period-end-form"),r=this.$(".statuses-form");switch(e){case g:case C:case S:return void this.addChildView(i,l,{parent:this.$el,translucent:"2"});case w:return H(n("error"),n("error.text")),void this.removeChildView(i);case T:try{this.createForm("periodForm",a),this.createForm("periodBeginForm",o),this.createForm("periodEndForm",s),this.createForm("statusesForm",r),this.hide(o),this.hide(s),this.renderItems()}catch(t){}return}},onStatusOfCancellingRequest:function(t,e){var i=".panel-container",n=t.get("cancelRequestId"),a=__group("auto.withdrawal.cancelled."),o=__group("auto.withdrawal.cancel.");switch(e){case R:return m.trigger("funds-withdrawal:withdrawal:dialog",{type:F,title:o("title"),text:o("text"),yes:function(){return t.acceptToCancelRequest()},no:function(){return t.refuseToCancelRequest()}});case S:return this.addChildView(i,l,{parent:this.$(i),translucent:"1"});case w:return this.removeChildView(i),H(o("rejected.title"),o("rejected.text"));case T:return this.removeChildView(i),t.set("statusOfCancelRequest",g),H(a("title"),a("text.line1")+"<br>"+a("text.line2")),t.updateItemStatusById(n,y),m.trigger("funds:withdrawal:cancel"),this.$("#request-"+n).html(d({id:n,status:y,APPROVED:O,COMPLETED:b,REJECTED:I,CANCELED:y,NEW:x,FUNDS_REMOVED:A,PENDING_FUNDS_REMOVAL:D,PENDING_CANCELLATION:N}));default:return this.removeChildView(i)}},cancelRequest:function(t){t.preventDefault();var e=f(t.currentTarget).attr("data-id");this.model.confirmToCancelRequest(e)},show:function(t){return t.css("display","inline-block")},hide:function(t){return t.css("display","none")},onPeriodBeginChanged:function(t,e){this.getFormField("periodEndForm","field_periodEnd").setMinDate(e[0]),this.renderItems()},onPeriodEndChanged:function(t,e){this.getFormField("periodBeginForm","field_periodBegin").setMaxDate(e[0]),this.renderItems()},onFilterByStatusChanged:function(t,e){this.model.set("selectedStatus",e),this.renderItems()}});n.exports=J}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(0),i(5))},2728:function(t,e){t.exports='<div class="funds-withdrawal-body flex flex-column flex-stretch"><div class="panel-container"></div> <% if (model.status == SUCCESS) { %> <% if (_.isEmpty(items)) { %> <div class="empty"> <%=__(\'auto.withdrawal.statuses.no_requests\') %> </div> <% } else { %> <div class="filter-container flex flex-row flex-valign-center"><div class="flex flex-column flex-wrap"><div class="flex flex-row flex-wrap"><div class="flex flex-valign-center title"><%=__(\'history.period\')%></div><div class="period-form"></div><div class="statuses-form"></div></div><div class="flex flex-row flex-wrap"><div class="flex flex-valign-center title hidden-xs"></div><div class="period-begin-form"></div><div class="period-end-form"></div></div></div></div><div class="table-container flex flex-stretch"></div><p class="note hidden-xs"><%=__(\'auto.withdrawal.note\',  __(\'legal_documents.popup.terms_and_conditions\'))%></p> <% }} %> </div><div class="funds-withdrawal-actions flex flex-align-end flex-valign-center"><div class="footer"><div class="help flex flex-column"> <% if (settings.isLiveChatEnabled()) { %> <div class="flex flex-align-end hidden-xs"> <%=__(\'help.need_help\')%>&nbsp; <a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div><div class="visible-xs"> <%=__(\'help.need_help\')%>&nbsp; <a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div> <% } %> <p class="small visible-xs"><br> <%=__(\'auto.withdrawal.note\',  __(\'legal_documents.popup.terms_and_conditions\'))%> </p></div></div></div>'},2729:function(t,e){t.exports='<% if (_.isEmpty(items)) { %> <div class="empty"> <%=__(\'auto.withdrawal.statuses.empty\')%> </div> <% } else { %> <div class="table"><div class="head flex flex-row hidden-xs"><div class="date"><%-textDate%></div><div class="account"><%-textAccount%></div><div class="method"><%-textMethod%></div><div class="amount"><%-textAmount%></div><div class="status"><%-textStatus%></div></div><div class="body"><div> <% _.each(items, function(v) { %> <div class="row"><div class="date"><u><%-textDate%>:&nbsp;</u><%-formatDate(v)%></div><div class="account"><u><%-textAccount%>:&nbsp;</u><%-formatAccount(v)%></div><div class="method"><u><%-textMethod%>:&nbsp;</u><%-textFormatMethod(v.methodType)%></div><div class="amount" title="<%-formatAmount(v)%>"><u><%-textAmount%>:&nbsp;</u><%-formatAmount(v)%> </div><div class="status" data-title="Status" id="request-<%-v.itemId%>"> <%=statusTemplate({\n                        id: v.itemId,\n                        status: v.status,\n                        APPROVED: APPROVED,\n                        COMPLETED: COMPLETED,\n                        REJECTED: REJECTED,\n                        CANCELED: CANCELED,\n                        NEW: NEW,\n                        FUNDS_REMOVED: FUNDS_REMOVED,\n                        PENDING_FUNDS_REMOVAL: PENDING_FUNDS_REMOVAL,\n                        PENDING_CANCELLATION: PENDING_CANCELLATION\n                    })%> </div></div> <% }) %> </div></div></div> <% } %>'},2730:function(t,e){t.exports="<% var text = __group('auto.withdrawal.statuses.') %> <% if (status == NEW || status == FUNDS_REMOVED || status == PENDING_FUNDS_REMOVAL) { %> <b><%-text('in_progress')%></b><a href=\"\" class=\"fn-cancel-request\" data-id=\"<%-id%>\"><%-__('auto.withdrawal.cancel_request')%></a> <% } else if (status == APPROVED) { %> <div><i class=\"completed\"></i> <b><%-text('processed')%></b></div> <% } else if (status == COMPLETED) { %> <div><i class=\"completed\"></i> <b><%-text('completed')%></b></div> <% } else if (status == CANCELED) { %> <div><i class=\"cancelled\"></i> <b><%-text('cancelled')%></b></div> <% } else if (status == REJECTED) { %> <div><i class=\"rejected\"></i> <b><%-text('rejected')%></b></div> <% } else if (status == PENDING_CANCELLATION) { %> <div><i class=\"pending\"></i> <b><%-text('cancelling')%></b></div> <% } %>"},2731:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(2253),o=i(6),s=i(0),r=i(2146),d=r.EMPTY,l=r.LOADING,u=r.ERROR,c=r.SUCCESS,h=r.CANCELLING,f=r.NEW,m=r.APPROVED,v=r.COMPLETED,p=r.REJECTED,_=r.CANCELED,E=r.FUNDS_REMOVED,g=r.PENDING_FUNDS_REMOVAL,C=r.PENDING_CANCELLATION,w=r.CONFIRM;n.exports=a.extend({defaults:function(){return{items:[],status:d,statusOfCancelRequest:d,periods:[{id:"custom",text:__("history.period.custom")},{id:"all",text:__("history.period.all")},{id:"today",text:__("history.period.day")},{id:"1week",text:__("history.period.week")},{id:"2weeks",text:__("history.period.fortnight")},{id:"1month",text:__("history.period.month")},{id:"3months",text:__("history.period.season")},{id:"1year",text:__("history.period.year")}],selectedPeriod:"today",periodDate:null,statuses:[{id:"all",text:__("filter.statuses.all")},{id:"in_progress",text:__("auto.withdrawal.statuses.in_progress")},{id:"processed",text:__("auto.withdrawal.statuses.processed")},{id:"completed",text:__("auto.withdrawal.statuses.completed")},{id:"cancelled",text:__("auto.withdrawal.statuses.cancelled")},{id:"rejected",text:__("auto.withdrawal.statuses.rejected")},{id:"cancelling",text:__("auto.withdrawal.statuses.cancelling")}],selectedStatus:"all"}},availableStatuses:[f,m,v,p,_,E,g,C],initialize:function(){a.prototype.initialize.apply(this,arguments),this.loadWithdrawalHistory()},loadWithdrawalHistory:function(){var t=this,e=this.status("status");e(l),o.loadWithdrawalHistory().then(function(i){return e(c,{items:t.sort(t.filter(i.data))})}).catch(function(t){return e(u)})},filter:function(t){var e=this;return s.chain(t).filter(function(t){return s.contains(e.availableStatuses,t.status)}).value()},sort:function(t){return s.sortBy(t,function(t){var e=t.creationDate,i=e.year,n=e.monthValue,a=e.dayOfMonth,o=e.hour,s=e.minute,r=e.second;return-1*+new Date(i,n,a,o,s,r)})},confirmToCancelRequest:function(t){this.set({statusOfCancelRequest:w,cancelRequestId:t})},acceptToCancelRequest:function(){this.cancelWithdrawalRequest()},refuseToCancelRequest:function(){this.set({statusOfCancelRequest:d,cancelRequestId:null})},cancelWithdrawalRequest:function(){var t=this.status("statusOfCancelRequest"),e=this.get("cancelRequestId");t(h),o.cancelWithdrawalRequest(e).then(function(e){return t(c)}).catch(function(e){return t(u)})},updateItemStatusById:function(t,e){var i=this.get("items");if(!s.isEmpty(i)){var n=s.findWhere(i,{itemId:t});n&&(n.status=e)}}})}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2732:function(t,e,i){(function(n,a){var o;void 0!==(o=function(t,e,n){var a=i(0),o=i(5),s=i(12),r=a.template(i(2733)),d=a.template(i(2734)),l=i(2),u=i(9),c=i(2146),h=c.YES,f=c.NO,m=c.EMPTY,v=c.LOADING,p=c.SUCCESS,_=c.ERROR,E=function(t,e){return l.trigger("ui:message-box",{translucent:"3",additionalClassName:"fluid-button",caption:t,text:e})},g=s.extend({events:function(){return this.addEvents(s)({"click .fn-tab":"changeTab","click .btn":"clickButton"})},className:"methods",initialize:function(){s.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:currentTabId",this.update),this.listenTo(this.model,"change:statusOfMethods",this.loadCompleted),this.listenTo(this.model,"change:statusOfCandidates",this.loadCompleted),this.listenTo(l,"funds-withdrawal:methods:reload",this.methodsReload)},methodsReload:function(){this.model.load()},loadCompleted:function(){var t=this.model,e=t.get("statusOfMethods"),i=t.get("statusOfCandidates"),n=m;switch(i===_||e===_?n=_:i===p&&e===p&&(n=p),n){case m:case v:return;case _:return void E(__("auto.withdrawal.error.title"),__("auto.withdrawal.error.text"));case p:return t.enableAllTabs(),t.setCurrentTabById("add"),this.renderMenu(),void this.update()}},renderMenu:function(){this.$(".menu").html(d({items:this.model.get("tabs"),currentTabId:this.model.getCurrentTabId()}))},update:function(){this.removeListenersInTabModel(this.tabModel);var t=this.model.getCurrentTabData(),e=t.view,i=t.model,n=this.tabModel=new i({isMethodsEmpty:this.model.isMethodsEmpty()});this.addChildView(".panel-content",e,{model:n}),this.addListenersInTabModel(n),this.updateExecutableButtonState(n),this.updateButtonText()},render:function(){return s.prototype.render.call(this),this.$el.html(r({model:this.model.toJSON(),settings:u})),this},addListenersInTabModel:function(t){t&&t.on("change:readyToExecute",this.updateExecutableButtonState,this)},removeListenersInTabModel:function(t){t&&t.off("change:readyToExecute",this.updateExecutableButtonState,this)},updateExecutableButtonState:function(t){var e=t.get("readyToExecute"),i=this.$(".footer .btn");switch(e){case h:i.removeAttr("disabled");break;case f:i.attr("disabled",!0)}i.css("display","block")},changeTab:function(t){t.preventDefault();var e=o(t.currentTarget).attr("data-tab-id");this.model.setCurrentTabById(e),this.updateButtonText(),this.renderMenu()},clickButton:function(){this.tabModel.doRequest()},updateButtonText:function(){this.$(".funds-withdrawal-actions .btn").html(__(this.model.getCurrentTab().submitButtonText))}});n.exports=g}.call(e,i,e,t))&&(t.exports=o)}).call(e,i(0),i(5))},2733:function(t,e){t.exports='<div class="funds-withdrawal-body flex-stretch"><div class="menu"></div><div class="separator hidden-xs"></div><div class="panel-content"></div></div><div class="funds-withdrawal-actions flex flex-align-start flex-valign-center"><div class="footer grid-middle_sm-1"> <% if (settings.isLiveChatEnabled()) { %> <div class="col help visible-xs"> <%=__(\'help.need_help\')%>&nbsp;<a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div> <% } %> <div class="col"><button class="btn btn-primary"><%- __(\'auto.withdrawal.actions.withdraw\') %></button></div> <% if (settings.isLiveChatEnabled()) { %> <div class="col help hidden-xs"><div class="flex flex-align-end"> <%=__(\'help.need_help\')%>&nbsp;<a href="#" class="fn-help-live-chat-link"><%=__(\'help.right_here\')%></a></div></div> <% } %> </div></div>'},2734:function(t,e){t.exports="<ul><li class=\"hidden-xs\"><b><%=__('funds.withdrawal.methods.action') %></b></li> <% _.each(items, function(v, i) { %> <li><a href=\"#\" class=\"fn-tab <%- currentTabId == v.id ? 'active' : ''%> <%- v.disable == true ? 'no-active' : '' %>\" data-tab-id=\"<%-v.id%>\"><%-v.name%></a></li> <% }) %> </ul>"},2735:function(t,e,i){var n;void 0!==(n=function(t,e,n){var a=i(2736),o=i(2738),s=i(2739),r=i(2741),d=i(2253),l=i(2146),u=l.EMPTY;n.exports=d.extend({defaults:function(){return{statusOfMethods:u,tabs:[{id:"revoke",name:__("auto.withdrawal.revoke_methods"),viewClass:a,modelClass:o,submitButtonText:__("auto.withdrawal.revoke_method.button")},{id:"add",name:__("auto.withdrawal.add_method"),viewClass:s,modelClass:r,submitButtonText:__("auto.withdrawal.add_method.button")}],currentTabId:""}},initialize:function(){this.load()},load:function(){this.loadMethods(),this.loadCandidates()}})}.call(e,i,e,t))&&(t.exports=n)},2736:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(836),s=a.template(i(2737)),r=i(30),d=i(2),l=i(2385),u=i(2146),c=u.EMPTY,h=u.CONFIRM,f=(u.ACCEPTED,u.REFUSED,u.PROCESSING),m=u.LOADING,v=u.UPLOADING,p=u.SUCCESS,_=u.ERROR,E=u.CONFIRM_DIALOG_TYPE,g=u.LOADING_DIALOG_TYPE,C=u.MESSAGE_DIALOG_TYPE,w=(u.SHOW,u.HIDE),T=u.YES,x=(u.NO,u.ERROR_ENTITY_TOO_LARGE),O=u.VALIDATE,b=function(t){return d.trigger("funds-withdrawal:withdrawal:dialog",t)},I=function(t,e){return d.trigger("ui:message-box",{translucent:"3",additionalClassName:"fluid-button",caption:t,text:e})},y=o.extend({className:"revoke-method",initialize:function(){o.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:statusOfMethods",this.onStatusOfMethodsChanged),this.listenTo(this.model,"change:statusOfRevoke",this.onStatusOfRevokeChanged),this.listenTo(this.model,"change:statusOfUpload",this.onStatusOfUploadChanged),this.listenTo(this.model,"change:uploadProgress",this.onUploadProgress),this.listenTo(this,"form:methodsForm:change:field_methodId",this.onMethodChanged),this.formConfigs=l},render:function(){return o.prototype.render.call(this),this.$el.html(s({model:this.model.toJSON()})),this.onStatusOfMethodsChanged(),this},onStatusOfMethodsChanged:function(){var t=this.model,e=t.get("statusOfMethods"),i=__group("auto.withdrawal.revoke."),n=this.$(".methods-form"),a=this.$(".document-form");switch(e){case c:case m:return this.addChildView(".panel-container",r,{parent:this.$el,translucent:"no"});case _:return this.removeChildView(".panel-container"),void I(i("error"),"Cant load methods for this account");case p:return this.removeChildView(".panel-container"),t.isMethodsEmpty()?n.html(i("empty")):(this.createForm("methodsForm",n),void this.createForm("documentForm",a))}},onStatusOfRevokeChanged:function(t,e){var i=__group("auto.withdrawal.revoke.");switch(e){case _:return void b({type:C,title:i("error"),text:i("error.text")});case O:t.set("statusOfRevoke",c);var n=this.getForm("methodsForm").validate(),a=this.getForm("documentForm").validate();if(n||a)return;return void t.confirmToRevoke();case p:var o=this.getFormField("documentForm","field_doc").getFile();return void t.uploadDocument(t.get("methodId"),t.get("methodTypeId"),39,o);case f:return void b({type:g});case h:var s=this.getFormField("methodsForm","field_methodId").value();return void b({type:E,title:i("confirm.title"),text:i("confirm.text"),yes:function(){return t.accept(s)},no:function(){return t.refuse()}})}},onStatusOfUploadChanged:function(t,e){var i=__group("auto.withdrawal.revoke.");switch(e){case p:return this.destroyForm("methodsForm"),this.destroyForm("documentForm"),this.createForm("methodsForm",this.$(".methods-form")),this.createForm("documentForm",this.$(".document-form")),b({type:C,title:i("success"),text:i("success.text")}),void(this.model.isMethods()||d.trigger("funds-withdrawal:methods:reload"));case v:return void b({type:g});case x:return void b({type:C,title:i("error"),text:__("upload_documents.help.por.point3")});case _:return void b({type:C,title:i("error"),text:i("error.text")});default:return b({type:g,action:w})}},onMethodChanged:function(){var t=this.getFormField("documentForm","field_doc");this.model.set("readyToExecute",T),t.flush(),t.enable()}});n.exports=y}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2737:function(t,e){t.exports='<div class="revoke-method-content"><div class="panel-container"></div><div class="accounts-form"></div><div class="methods-form"></div><div class="document-form"></div></div>'},2738:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(2253),o=i(0),s=i(6),r=i(2146),d=(r.YES,r.NO),l=r.CONFIRM,u=r.ACCEPTED,c=r.PROCESSING,h=r.REFUSED,f=r.EMPTY,m=(r.LOADING,r.ERROR),v=r.SUCCESS,p=r.VALIDATE;n.exports=a.extend({defaults:function(){return{methods:[],readyToExecute:d,statusOfRevoke:f}},initialize:function(){a.prototype.initialize.apply(this,arguments),this.loadMethods()},confirmToRevoke:function(){this.set({statusOfRevoke:l},{trigger:!0})},validateToRevoke:function(){this.set({statusOfRevoke:p},{trigger:!0})},accept:function(t){this.set({statusOfRevoke:u,methodId:t,methodTypeId:this.getMethodById(t).methodTypeId}),this.revokeWithdrawalMethod(t)},refuse:function(){this.set({statusOfRevoke:h})},doRequest:function(){this.validateToRevoke()},getFirst:function(){return o.first(this.get("methods"))},revokeWithdrawalMethod:function(t){var e=this,i=this.status("statusOfRevoke");i(c),s.revokeWithdrawalMethod(t).then(function(i){return e.set({readyToExecute:d,methods:o.reject(e.get("methods"),function(e){return e.uniqueEntityId==t})}),Promise.resolve(i)}).then(function(t){return i(v,{resultOfRevoke:t.data})}).catch(function(t){return i(m)})}})}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2739:function(t,e,i){(function(n){var a;void 0!==(a=function(t,e,n){var a=i(0),o=i(2),s=i(836),r=a.template(i(2740)),d=i(30),l=i(2385),u=i(2146),c=u.EMPTY,h=u.LOADING,f=u.SUCCESS,m=u.ERROR,v=u.CONFLICT,p=u.YES,_=(u.NO,u.VALIDATION),E=u.UPLOADING,g=u.PROCESSING,C=u.LOADING_DIALOG_TYPE,w=u.MESSAGE_DIALOG_TYPE,T=u.ERROR_ENTITY_TOO_LARGE,x=(u.HIDE,u.CLEAR_DIALOG),O=function(t){return o.trigger("funds-withdrawal:withdrawal:dialog",t)},b=function(t,e,i){return o.trigger("ui:message-box",{translucent:"3",additionalClassName:"fluid-button",caption:t,text:e,onClose:i})},I=s.extend({className:"add-method",initialize:function(){var t=this;s.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:statusOfCandidates",this.loadCompleted),this.listenTo(this.model,"change:statusOfMethods",this.loadCompleted),this.listenTo(this.model,"change:statusOfUpload",this.onStatusOfUploadChanged),this.listenTo(this,"form:selectCandidateForm:change:field_methodTypeId",this.onSelectCandidateChanged),this.listenTo(this.model,"change:statusOfAddition",this.onStatusOfAdditionChanged),this.listenTo(this,"form:field-update",function(e,i){return t.model.set(e,i)}),this.formConfigs=l},render:function(){return s.prototype.render.call(this),this.$el.html(r({model:this.model.toJSON()})),this.loadCompleted(),this},loadCompleted:function(){var t=this.model,e=t.get("statusOfCandidates"),i=t.get("statusOfMethods"),n=this.$(".fn-candidate-form"),a=__("generic.error.message"),o=".add-method-content",s=c;switch(i==f&&e==f&&(s=f),i!=m&&e!=m||(s=m),s){case c:case h:return void this.addChildView(o,d,{parent:this.$(o),translucent:"1"});case m:return this.removeChildView(o),b(__("auto.withdrawal.error.title"),a),void n.html(a);case f:return this.removeChildView(o),t.isCandidatesEmpty()?n.html("The platform does not allow you to add methods."):void this.createForm("selectCandidateForm",n)}},onSelectCandidateChanged:function(t,e){var i=this.$(".fn-method-form"),n=this.model.getCandidateById(e);n&&(this.createForm(n.name,i),this.model.set({readyToExecute:p,selectedCandidate:n.name}))},onStatusOfAdditionChanged:function(t,e){var i=t.get("selectedCandidate"),n=i,a=__group("auto.withdrawal.method."),o=this.getForm(n),s=this.getFormField("selectCandidateForm","field_methodTypeId").value();switch(e){case _:var r=o.validate(),d=t.normalizeFormData(o.getData());return t.set("statusOfAddition",c),delete d.doc,void(r||t.addWithdrawalMethod(s,d));case g:return void O({type:C});case f:var l=t.get("resultOfAddition"),u=o.getField("field_doc").getFile();return void t.uploadDocument(l,s,38,u);case m:return void O({type:w,title:a("error"),text:a("error.text")});case v:return void O({type:w,title:a("conflict"),text:a("conflict.text")})}},onStatusOfUploadChanged:function(t,e){var i=__group("auto.withdrawal.method."),n=__group("auto.withdrawal.add_method.");switch(e){case m:return void O({type:w,title:i("error"),text:i("error.text")});case f:return O({type:x}),void b(n("success"),n("success.text"),function(){o.trigger("funds-withdrawal:withdrawal:state",{currentTabId:"withdrawal",selectedPaymentId:t.get("resultOfAddition")})});case E:return;case T:return void O({type:w,title:i("error"),text:__("upload_documents.help.por.point3")})}}});n.exports=I}.call(e,i,e,t))&&(t.exports=a)}).call(e,i(0))},2740:function(t,e){t.exports='<div class="add-method-content"><div class="fn-candidate-form"></div><div class="fn-method-form"></div></div>'},2741:function(t,e,i){var n;void 0!==(n=function(t,e,n){var a=i(2253),o=i(6),s=i(7),r=i(2146),d=(r.YES,r.NO),l=(r.DEFAULT,r.EMPTY),u=r.CONFLICT,c=(r.LOADING,r.ERROR),h=r.SUCCESS,f=r.PROCESSING,m=r.VALIDATION;r.UPLOADING;n.exports=a.extend({defaults:function(){var t=String(s.getUserCountry()).toUpperCase();return{readyToExecute:d,statusOfAddition:l,statusOfCandidates:l,statusOfCountries:l,selectedDefaultCountry:t}},initialize:function(){a.prototype.initialize.apply(this,arguments),this.loadMethods(),this.loadCandidates(),this.loadCountries()},addWithdrawalMethod:function(t,e){var n=(i(7),this.status("statusOfAddition"));n(f),o.addWithdrawalMethod(t,e).then(function(t){return n(h,{resultOfAddition:t.data})}).catch(function(t){var e=409===t.response.status?u:c;n(e)})},doRequest:function(){this.set("statusOfAddition",m)}})}.call(e,i,e,t))&&(t.exports=n)}});